{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/Menu/TextInput.vue?3f27","webpack:///./src/components/Menu/MarkerItem.vue?d5b2","webpack:///./src/components/ControlBar/ControlsSwitch.vue?2956","webpack:///./src/components/ControlBar/SvgButton.vue?66d4","webpack:///./src/components/ControlBar/MenuButton.vue?ffe6","webpack:///./src/components/ControlBar/NumberInput.vue?95c0","webpack:///./src/components/ControlBar/DayNightSwitch.vue?a192","webpack:///./src/components/Menu/MapButton.vue?bd23","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?1816","webpack:///./src/components/ControlBar/Compass.vue?bfcb","webpack:///./src/components/Menu/SideMenu.vue?96af","webpack:///./src/App.vue?3c47","webpack:///./src/components/ControlBar/ControlBar.vue?8d40","webpack:///./src/components/ControlBar/PositionInput.vue?bcc5","webpack:///./src/components/ControlBar/NumberInput.vue?c32b","webpack:///src/components/ControlBar/NumberInput.vue","webpack:///./src/components/ControlBar/NumberInput.vue?ace8","webpack:///./src/components/ControlBar/NumberInput.vue?70aa","webpack:///src/components/ControlBar/PositionInput.vue","webpack:///./src/components/ControlBar/PositionInput.vue?d949","webpack:///./src/components/ControlBar/PositionInput.vue?b166","webpack:///./src/components/ControlBar/Compass.vue?293f","webpack:///./BlueMapWeb/src/util/Utils.js","webpack:///src/components/ControlBar/Compass.vue","webpack:///src/components/ControlBar/DayNightSwitch.vue","webpack:///./src/components/ControlBar/SvgButton.vue?e137","webpack:///src/components/ControlBar/SvgButton.vue","webpack:///./src/components/ControlBar/SvgButton.vue?ee5f","webpack:///./src/components/ControlBar/SvgButton.vue?6cb1","webpack:///./src/components/ControlBar/Compass.vue?d659","webpack:///./src/components/ControlBar/Compass.vue?7ca6","webpack:///./src/components/ControlBar/DayNightSwitch.vue?2ded","webpack:///./src/components/ControlBar/DayNightSwitch.vue?2fe5","webpack:///./src/components/ControlBar/DayNightSwitch.vue?2ff5","webpack:///./src/components/ControlBar/ControlsSwitch.vue?3a31","webpack:///src/components/ControlBar/ControlsSwitch.vue","webpack:///./src/components/ControlBar/ControlsSwitch.vue?742d","webpack:///./src/components/ControlBar/ControlsSwitch.vue?7231","webpack:///./src/components/ControlBar/MenuButton.vue?deae","webpack:///src/components/ControlBar/MenuButton.vue","webpack:///./src/components/ControlBar/MenuButton.vue?62de","webpack:///./src/components/ControlBar/MenuButton.vue?e96d","webpack:///src/components/ControlBar/ControlBar.vue","webpack:///./src/components/ControlBar/ControlBar.vue?dcc7","webpack:///./src/components/ControlBar/ControlBar.vue?42e9","webpack:///./src/components/Menu/MainMenu.vue?3017","webpack:///./src/components/Menu/SideMenu.vue?7f90","webpack:///src/components/Menu/SideMenu.vue","webpack:///./src/components/Menu/SideMenu.vue?4a50","webpack:///./src/components/Menu/SideMenu.vue?76b2","webpack:///./src/components/Menu/SimpleButton.vue?d277","webpack:///src/components/Menu/SimpleButton.vue","webpack:///./src/components/Menu/SimpleButton.vue?29af","webpack:///./src/components/Menu/SimpleButton.vue?8fd0","webpack:///./src/components/Menu/SettingsMenu.vue?cc7e","webpack:///./src/components/Menu/Group.vue?4985","webpack:///src/components/Menu/Group.vue","webpack:///./src/components/Menu/Group.vue?1201","webpack:///./src/components/Menu/Group.vue?c2ed","webpack:///./src/components/Menu/Slider.vue?a9b9","webpack:///src/components/Menu/Slider.vue","webpack:///./src/components/Menu/Slider.vue?c766","webpack:///./src/components/Menu/Slider.vue?25e1","webpack:///./src/components/Menu/SwitchButton.vue?4c9a","webpack:///./src/components/Menu/SwitchHandle.vue?d4c2","webpack:///src/components/Menu/SwitchHandle.vue","webpack:///./src/components/Menu/SwitchHandle.vue?b5b6","webpack:///./src/components/Menu/SwitchHandle.vue?9829","webpack:///src/components/Menu/SwitchButton.vue","webpack:///./src/components/Menu/SwitchButton.vue?9d74","webpack:///./src/components/Menu/SwitchButton.vue?ecd0","webpack:///./src/i18n/fallback.js","webpack:///./src/i18n/index.js","webpack:///src/components/Menu/SettingsMenu.vue","webpack:///./src/components/Menu/SettingsMenu.vue?56ae","webpack:///./src/components/Menu/SettingsMenu.vue","webpack:///./src/js/MainMenu.js","webpack:///./src/components/Menu/MarkerSetMenu.vue?a850","webpack:///./src/components/Menu/MarkerItem.vue?f04e","webpack:///src/components/Menu/MarkerItem.vue","webpack:///./src/components/Menu/MarkerItem.vue?5063","webpack:///./src/components/Menu/MarkerItem.vue?48c1","webpack:///./src/components/Menu/TextInput.vue?23d2","webpack:///src/components/Menu/TextInput.vue","webpack:///./src/components/Menu/TextInput.vue?9d93","webpack:///./src/components/Menu/TextInput.vue?3875","webpack:///./src/components/Menu/MarkerSet.vue?a88b","webpack:///src/components/Menu/MarkerSet.vue","webpack:///./src/components/Menu/MarkerSet.vue?948d","webpack:///./src/components/Menu/MarkerSet.vue?a132","webpack:///src/components/Menu/MarkerSetMenu.vue","webpack:///./src/components/Menu/MarkerSetMenu.vue?1e88","webpack:///./src/components/Menu/MarkerSetMenu.vue","webpack:///./src/components/Menu/MapButton.vue?8766","webpack:///src/components/Menu/MapButton.vue","webpack:///./src/components/Menu/MapButton.vue?9784","webpack:///./src/components/Menu/MapButton.vue?71ba","webpack:///src/components/Menu/MainMenu.vue","webpack:///./src/components/Menu/MainMenu.vue?64d4","webpack:///./src/components/Menu/MainMenu.vue?5ec9","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?e8d1","webpack:///src/components/Controls/FreeFlightMobileControls.vue","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?86c6","webpack:///./src/components/Controls/FreeFlightMobileControls.vue?748e","webpack:///src/App.vue","webpack:///./src/App.vue?60d0","webpack:///./src/App.vue?315a","webpack:///./BlueMapWeb/src/map/Tile.js","webpack:///./BlueMapWeb/src/map/TileMap.js","webpack:///./BlueMapWeb/src/map/TileManager.js","webpack:///./BlueMapWeb/src/map/TileLoader.js","webpack:///./BlueMapWeb/src/map/LowresTileLoader.js","webpack:///./BlueMapWeb/src/map/Map.js","webpack:///./BlueMapWeb/src/skybox/SkyFragmentShader.js","webpack:///./BlueMapWeb/src/skybox/SkyVertexShader.js","webpack:///./BlueMapWeb/src/skybox/SkyboxScene.js","webpack:///./BlueMapWeb/src/controls/ControlsManager.js","webpack:///./BlueMapWeb/src/util/Stats.js","webpack:///./BlueMapWeb/src/map/hires/HiresVertexShader.js","webpack:///./BlueMapWeb/src/map/hires/HiresFragmentShader.js","webpack:///./BlueMapWeb/src/map/lowres/LowresVertexShader.js","webpack:///./BlueMapWeb/src/map/lowres/LowresFragmentShader.js","webpack:///./BlueMapWeb/src/util/CombinedCamera.js","webpack:///./BlueMapWeb/src/util/CSS2DRenderer.js","webpack:///./BlueMapWeb/src/util/lines/LineMaterial.js","webpack:///./BlueMapWeb/src/markers/MarkerFillVertexShader.js","webpack:///./BlueMapWeb/src/markers/MarkerFillFragmentShader.js","webpack:///./BlueMapWeb/src/util/lines/LineSegmentsGeometry.js","webpack:///./BlueMapWeb/src/util/lines/LineGeometry.js","webpack:///./BlueMapWeb/src/util/lines/LineSegments2.js","webpack:///./BlueMapWeb/src/util/lines/Line2.js","webpack:///./BlueMapWeb/src/markers/Marker.js","webpack:///./BlueMapWeb/src/markers/ObjectMarker.js","webpack:///./BlueMapWeb/src/markers/ShapeMarker.js","webpack:///./BlueMapWeb/src/markers/ExtrudeMarker.js","webpack:///./BlueMapWeb/src/markers/LineMarker.js","webpack:///./BlueMapWeb/src/markers/HtmlMarker.js","webpack:///./BlueMapWeb/src/markers/PoiMarker.js","webpack:///./BlueMapWeb/src/markers/MarkerSet.js","webpack:///./BlueMapWeb/src/MapViewer.js","webpack:///./BlueMapWeb/src/markers/PlayerMarker.js","webpack:///./BlueMapWeb/src/markers/PlayerMarkerSet.js","webpack:///./BlueMapWeb/src/markers/MarkerManager.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseMoveControls.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseZoomControls.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseRotateControls.js","webpack:///./BlueMapWeb/src/controls/map/mouse/MouseAngleControls.js","webpack:///./BlueMapWeb/src/controls/map/MapHeightControls.js","webpack:///./BlueMapWeb/src/controls/KeyCombination.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyMoveControls.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyAngleControls.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyRotateControls.js","webpack:///./BlueMapWeb/src/controls/map/keyboard/KeyZoomControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchMoveControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchRotateControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchAngleControls.js","webpack:///./BlueMapWeb/src/controls/map/touch/TouchZoomControls.js","webpack:///./BlueMapWeb/src/controls/map/MapControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/keyboard/KeyMoveControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/mouse/MouseRotateControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/mouse/MouseAngleControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/keyboard/KeyHeightControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/touch/TouchPanControls.js","webpack:///./BlueMapWeb/src/controls/freeflight/FreeFlightControls.js","webpack:///./BlueMapWeb/src/BlueMap.js","webpack:///./src/js/PopupMarker.js","webpack:///./src/js/Utils.js","webpack:///./src/js/BlueMapApp.js","webpack:///./src/main.js","webpack:///./src/App.vue?db16","webpack:///./src/components/Menu/SwitchButton.vue?2357","webpack:///./src/components/ControlBar/ControlBar.vue?fec1","webpack:///./src/components/ControlBar/PositionInput.vue?eabc","webpack:///./src/components/Menu/SimpleButton.vue?1a7a","webpack:///./src/components/Menu/MarkerSet.vue?38b5","webpack:///./src/components/Menu/Slider.vue?2ac8","webpack:///./src/components/Menu/MainMenu.vue?bc01","webpack:///./src/components/Menu/SwitchHandle.vue?c8f1","webpack:///./src/components/Menu/Group.vue?9bb8"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","class","appState","theme","attrs","controls","state","_e","menu","staticRenderFns","staticClass","isOpen","$t","on","$event","reOpenPage","maps","openPage","markers","markerSets","markerSet","playerMarkerSet","fake","openPlayerList","$bluemap","resetCamera","position","x","parseFloat","target","y","z","_v","_s","label","domProps","_f","$emit","stopPropagation","props","filters","format","component","components","NumberInput","action","style","VEC2_ZERO","Vector2","stringToImage","Vector3","string","image","document","createElementNS","src","pathFromCoords","path","splitNumberToPath","substring","num","toString","charAt","hashTile","generateCacheHash","Math","round","random","dispatchEvent","element","event","detail","CustomEvent","alert","message","level","printToConsole","console","log","warn","error","debug","htmlToElement","html","template","createElement","innerHTML","trim","content","firstChild","animate","animationFrame","durationMs","postAnimation","animation","animationStart","lastFrame","cancelled","frame","time","progress","MathUtils","clamp","deltaTime","requestAnimationFrame","cancel","EasingFunctions","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","elementOffset","rect","getBoundingClientRect","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","top","left","deepEquals","object1","object2","is","type","Array","isArray","len","softMin","min","stiffness","delta","softMax","max","softClamp","vecArrToObj","val","useZ","pixel","width","height","pixelContext","getContext","willReadFrequently","getPixel","img","drawImage","floor","getImageData","active","_t","SvgButton","computed","transform","methods","evt","isDay","mapViewer","isPerspectiveView","setPerspectiveView","isFlatView","setFlatView","isFreeFlight","setFreeFlight","close","back","MenuButton","ControlsSwitch","DayNightSwitch","PositionInput","Compass","id","currentPage","title","pageStack","closePage","closeAll","goFullscreen","takeScreenshot","updateMap","_l","map","version","settings","buttonEnterAnimation","open","rendered","default","submenu","uniforms","sunlightStrength","ambientLight","stage","superSampling","saveUserSettings","loadedHiresViewDistance","hiresSliderMin","hiresSliderMax","renderDistanceFormatter","updateLoadedMapArea","loadedLowresViewDistance","lowresSliderMin","lowresSliderMax","pauseTileLoading","mouseSensitivity","updateControlsSettings","invertMouse","setTheme","screenshot","clipboard","$i18n","languages","lang","locale","setLanguage","switchDebug","resetSettings","formatter","step","countDecimals","SwitchHandle","pageTitle","tooltip","button","marker","searchPlaceholder","followPlayerTitle","lighting","dayNightSwitch","sunlight","resolution","high","normal","low","freeFlightControls","invertMouseY","renderDistance","hiresLayer","lowersLayer","loadHiresWhileMoving","off","dark","light","contrast","resetAllSettings","players","compass","perspective","flatView","freeFlight","language","blockTooltip","block","chunk","region","file","sun","info","VueI18n","messages","import","setLocaleMessage","querySelector","setAttribute","loadLanguageSettings","Vue","use","i18n","fallbackLocale","silentFallbackWarn","fallback","SwitchButton","Slider","SimpleButton","Group","qualityStages","themes","MainMenu","NULL_PAGE","openMore","filteredMarkerSets","thisMarkerSet","filter","search","visible","click","playerUuid","steve","markerLabel","followingPlayer","v","follow","cm","matchingMap","toggle","$tc","MarkerSet","TextInput","MarkerItem","filteredMarkers","selected","selectedMapId","switchMap","color","skyColor","g","b","mapId","MapButton","MarkerSetMenu","SettingsMenu","SideMenu","disabled","enabled","forward","forwardPointer","changedTouches","identifier","preventDefault","up","upPointer","onTouchStop","onFrame","enable","mounted","beforeDestroy","FreeFlightMobileControls","ControlBar","Tile","onLoad","onUnload","model","unloaded","loading","tileLoader","Promise","reject","unload","load","then","disposeModel","finally","userData","tileType","geometry","dispose","material","textureImage","TileMap","canvas","tileMapContext","alpha","texture","Texture","generateMipmaps","magFilter","LinearFilter","minFilter","wrapS","ClampToEdgeWrapping","wrapT","flipY","needsUpdate","fillStyle","fillRect","TileManager","onTileLoad","onTileUnload","events","loadNextTile","loadTimeout","clearTimeout","currentlyLoading","setTimeout","loadCloseTiles","tile","tileMap","setTile","centerTile","tileMapHalfSize","LOADED","scene","add","EMPTY","remove","sceneParent","Scene","viewDistanceX","viewDistanceZ","tiles","Map","tileMapSize","unloadTiles","removeAllTiles","set","removeFarTiles","setAll","forEach","hash","delete","clear","tryLoadTile","abs","tileHash","undefined","handleLoadedTile","handleUnloadedTile","catch","TileLoader","tilePath","tileSettings","loadBlocker","resolve","tileCacheHash","tileX","tileZ","cancelCheck","tileUrl","fileLoader","json","geometryJson","tileGeometry","status","bufferGeometryLoader","parse","Mesh","tileSize","translate","scale","updateMatrixWorld","FileLoader","setResponseType","BufferGeometryLoader","LowresTileLoader","lod","vertexShader","fragmentShader","textureLoader","anisotropy","NearestFilter","NearestMipMapLinearFilter","flatShading","pow","lodFactor","ShaderMaterial","textureSize","lodScale","transparent","depthWrite","depthTest","vertexColors","VertexColors","side","FrontSide","wireframe","TextureLoader","PlaneBufferGeometry","ceil","deleteAttribute","rotateX","PI","dataUrl","layer","sorting","settingsUrl","texturesUrl","startPos","Color","hires","lowres","lodCount","raycaster","Raycaster","hiresMaterial","lowresMaterial","loadedTextures","hiresTileManager","lowresTileManager","hiresVertexShader","hiresFragmentShader","lowresVertexShader","lowresFragmentShader","settingsPromise","loadSettings","textureFilePromise","loadTexturesFile","createLowresMaterial","all","values","textures","Error","createHiresMaterial","autoUpdate","loadSettingsFile","worldSettings","setRGB","hiresViewDistance","lowresViewDistance","isLoaded","hiresX","hiresZ","hiresViewX","hiresViewZ","loadAroundTile","lowresX","lowresZ","lowresViewX","lowresViewZ","loader","materials","textureSettings","opaque","halfTransparent","addEventListener","near","far","layers","enableAll","hiresTileHash","intersects","intersectObjects","point","ignore","scaledTileSize","lowresTileHash","heightUnsigned","SKY_FRAGMENT_SHADER","SKY_VERTEX_SHADER","SkyboxScene","SphereGeometry","BackSide","skybox","ControlsManager","camera","rotation","angle","tilt","lastPosition","clone","lastRotation","lastAngle","lastDistance","distance","lastOrtho","ortho","lastTilt","lastMapUpdatePosition","lastMapUpdateDistance","averageDeltaTime","_controls","updateCamera","update","valueChanged","isValueChanged","resetValueChanged","rotatableAngle","rotatableDistance","lerp","rotationVector","sin","cos","angleRotationAxis","cross","applyAxisAngle","multiplyScalar","copy","sub","lookAt","rotateZ","controlsManager","triggerDistance","loadMapArea","screenPosition","handleMapInteraction","equals","stop","start","_mapViewer","_camera","Stats","container","addPanel","panel","appendChild","dom","showPanel","children","display","hide","cssText","beginTime","performance","Date","now","prevTime","frames","prevFrameTime","fpsPanel","Panel","msPanel","lastFrameMsPanel","memPanel","self","memory","REVISION","begin","end","usedJSHeapSize","jsHeapSizeLimit","domElement","setMode","fg","bg","Infinity","PR","devicePixelRatio","WIDTH","HEIGHT","TEXT_X","TEXT_Y","GRAPH_X","GRAPH_Y","GRAPH_WIDTH","GRAPH_HEIGHT","context","font","textBaseline","fillText","globalAlpha","maxValue","HIRES_VERTEX_SHADER","ShaderChunk","logdepthbuf_pars_vertex","logdepthbuf_vertex","HIRES_FRAGMENT_SHADER","logdepthbuf_pars_fragment","logdepthbuf_fragment","LOWRES_VERTEX_SHADER","LOWRES_FRAGMENT_SHADER","CombinedCamera","fov","aspect","zoom","updateProjectionMatrix","ortographicProjection","Matrix4","perspectiveProjection","tan","DEG2RAD","view","fullWidth","fullHeight","offsetX","offsetY","skew","filmOffset","getFilmWidth","normalizedOrtho","orthoTop","orthoHeight","orthoWidth","orthoLeft","makePerspective","makeOrthographic","projectionMatrix","elements","projectionMatrixInverse","invert","isPerspectiveCamera","PerspectiveCamera","CSS2DObject","Object3D","parent","parentNode","replaceChild","anchor","traverse","Element","removeChild","lastClick","handleClick","doubleTap","onClick","constructor","CSS2DRenderer","_width","_height","_widthHalf","_heightHalf","_this","vector","viewMatrix","viewProjectionMatrix","cache","objects","WeakMap","overflow","getSize","setSize","renderObject","parentVisible","onBeforeRender","setFromMatrixPosition","matrixWorld","applyMatrix4","WebkitTransform","MozTransform","oTransform","opacity","objectData","distanceToCameraSquared","getDistanceToSquared","onAfterRender","a","distanceToSquared","filterAndFlatten","zOrder","sorted","sort","distanceA","distanceB","zMax","zIndex","render","matrixWorldInverse","multiplyMatrices","UniformsLib","line","linewidth","dashScale","dashSize","gapSize","ShaderLib","UniformsUtils","merge","common","fog","LineMaterial","parameters","clipping","dashed","defineProperties","diffuse","setValues","isLineMaterial","MARKER_FILL_VERTEX_SHADER","MARKER_FILL_FRAGMENT_SHADER","LineSegmentsGeometry","InstancedBufferGeometry","positions","uvs","index","setIndex","Float32BufferAttribute","assign","isLineSegmentsGeometry","matrix","attributes","instanceStart","instanceEnd","boundingBox","computeBoundingBox","boundingSphere","computeBoundingSphere","setPositions","array","lineSegments","Float32Array","instanceBuffer","InstancedInterleavedBuffer","InterleavedBufferAttribute","setColors","colors","instanceColorBuffer","fromWireframeGeometry","fromEdgesGeometry","fromMesh","mesh","WireframeGeometry","fromLineSegments","isGeometry","vertices","isBufferGeometry","box","Box3","setFromBufferAttribute","union","Sphere","center","getCenter","maxRadiusSq","il","count","fromBufferAttribute","radius","sqrt","isNaN","toJSON","applyMatrix","LineGeometry","isLineGeometry","points","fromLine","LineSegments2","isLineSegments2","computeLineDistances","lineDistances","distanceTo","instanceDistanceBuffer","raycast","Vector4","ssOrigin","ssOrigin3","mvMatrix","Line3","closestPoint","threshold","params","Line2","ray","lineWidth","at","w","isBehindCameraNear","isPastCameraFar","param","closestPointToPointParameter","zPos","isInClipSpace","isInside","pointOnLine","distanceSqToSegment","origin","face","faceIndex","uv","uv2","isLine2","Marker","markerId","markerData","fadeDistanceMin","fadeDistanceMax","calculateDistanceToCameraPlane","minDelta","maxDelta","_posRelativeToCamera","subVectors","getWorldDirection","_cameraDirection","dot","ObjectMarker","link","newTab","pos","intersection","popup","LabelPopup","setX","setY","setZ","autoClose","targetOpacity","inAnimation","removeHandler","composedPath","includes","removeEventListener","startOpacity","completed","ShapeMarker","zero","shape","Shape","fill","ShapeMarkerFill","border","ShapeMarkerBorder","renderOrder","_markerData","relativeY","updateGeometry","setShape","createShapeFromData","setShapeY","shapeY","bc","lineColor","borderColor","fc","fillColor","minDist","minDistance","maxDist","maxDistance","Number","MAX_VALUE","shapeData","createGeometry","DoubleSide","markerColor","markerOpacity","test","ShapeBufferGeometry","createLinePoints","innerWidth","innerHeight","renderer","points3d","getPoints","ExtrudeMarker","ExtrudeMarkerFill","ExtrudeMarkerBorder","minY","maxY","shapeMinY","shapeMaxY","ExtrudeBufferGeometry","depth","steps","bevelEnabled","prevPoint","LineMarker","LineMarkerLine","isVector3","setLine","createPointsFromData","lc","HtmlMarker","elementObject","calculateDistanceOpacity","getElementsByTagName","anch","PoiMarker","iconElement","item","labelElement","_lastIcon","highlight","eventHandler","classList","contains","iconAnchor","icon","toggleable","defaultHide","defaultHidden","updateMarkerSetsFromData","updateMarkersFromData","updatedMarkerSets","Set","keys","markerSetId","has","markerSetData","updateMarkerSetFromData","err","setId","updateFromData","updatedMarkers","updateMarkerFromData","isMarkerSet","isMarker","indexOf","child","MapViewer","rootElement","clientWidth","clientHeight","setPixelRatio","css2dRenderer","renderLoop","stats","loadedCenter","hiresTileMap","size","WebGLRenderer","antialias","sortObjects","preserveDrawingBuffer","logarithmicDepthBuffer","autoClear","skyboxScene","skyboxCamera","initializeRootElement","handleContainerResize","outerDiv","pointerEvents","rootOffset","normalizedScreenPos","setFromCamera","intersectScenes","hit","lowresHits","hiresHit","covered","parentRoot","intersections","clearDepth","sX","sZ","cameraFar","highestLod","scenePos","isMap","initTexture","centerX","centerZ","newTileCacheHash","_controlsManager","_map","PlayerMarker","playerHeadElement","playerNameElement","once","deltaPos","ease","foreign","PlayerMarkerSet","updatedPlayerMarkers","playerData","playerMarker","updatePlayerMarkerFromData","uuid","getPlayerMarkerId","isPlayerMarker","MarkerFileType","NORMAL","PLAYER","PLAYER_MARKER_SET_ID","MarkerManager","root","fileUrl","fileType","disposed","_updateInterval","ms","success","e","loadMarkerFile","markerFileData","updateFromDataNormal","updateFromDataPlayer","getPlayerMarkerSet","updateFromPlayerData","getPlayerMarker","setAutoUpdateInterval","MouseMoveControls","speed","buttons","altKey","moving","deltaPosition","tempVec2_1","pixelToSpeedMultiplierX","pixelToSpeedMultiplierY","manager","updatePixelToSpeedMultiplier","onMouseDown","onMouseMove","onMouseUp","smoothing","directionDelta","rotateAround","lengthSq","MouseZoomControls","deltaY","deltaMode","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","deltaZoom","onMouseWheel","passive","MouseRotateControls","ctrlKey","deltaRotation","lastX","MouseAngleControls","deltaAngle","lastY","MapHeightControls","cameraHeightStiffness","targetHeightStiffness","maxAngle","targetHeight","cameraHeight","minCameraHeight","distanceTagretHeight","updateHeights","getSuggestedHeight","targetSmoothing","targetTerrainHeight","terrainHeightAt","targetDelta","cameraSmoothing","cameraTerrainHeight","cameraDelta","maxAngleHeight","KeyCombination","code","modifiers","ctrl","CTRL","SHIFT","alt","ALT","shiftKey","combinations","combination","testDown","testUp","KeyMoveControls","oneDown","KEYS","UP","DOWN","down","LEFT","RIGHT","right","oneUp","onKeyDown","onKeyUp","rotatedDelta","temp_v2","KeyAngleControls","KeyRotateControls","KeyZoomControls","IN","in","OUT","out","TouchMoveControls","hammer","pointerType","onTouchDown","onTouchMove","onTouchUp","TouchRotateControls","TouchAngleControls","TouchZoomControls","lastZoom","HALF_PI","MapControls","lastTap","lastTapCenter","Manager","initializeHammer","mouseMove","mouseRotate","mouseAngle","mouseZoom","keyMove","keyRotate","keyAngle","keyZoom","touchMove","touchRotate","touchAngle","touchZoom","mapHeight","onContextMenu","onTap","stopFollowingPlayerMarker","_beforeMoveTemp","maxAngleForZoom","getMaxPerspectiveAngleForDistance","rotating","reset","touchTap","Tap","pointers","taps","Pan","direction","DIRECTION_ALL","touchTilt","DIRECTION_VERTICAL","Rotate","Pinch","recognizeWith","speedLeft","speedRight","speedCapture","pointerLockElement","movementX","pixelToSpeedMultiplier","movementY","KeyHeightControls","TouchPanControls","FreeFlightControls","clickStart","body","requestFullscreen","requestPointerLock","moveSpeed","keyHeight","touchPan","started","animationTargetHeight","onWheel","eventStack","PopupMarker","isHires","int","chunkCoords","divideScalar","regionCoords","regionFile","blocklight","hrPath","lrPath","cubeGeo","BoxGeometry","cubeMaterial","MeshBasicMaterial","cube","onMapInteraction","finished","setLocalStorage","localStorage","setItem","JSON","stringify","getLocalStorage","getItem","precision","f","BlueMapApp","followPlayerMarkerWorld","updateLoop","hashUpdateTimeout","updatePageAddress","lastCameraMove","timeSinceLastMove","timeToWait","sleep","history","replaceState","location","startLocation","split","getWorldPosition","startDistance","targetDistance","startX","targetX","startZ","targetZ","viewAnimation","ep","download","href","toDataURL","toBlob","blob","navigator","write","ClipboardItem","mapControls","playerMarkerManager","markerFileManager","savedUserSettings","mapsMap","mainMenu","enableFreeFlight","initGeneralEvents","popupMarkerSet","popupMarker","oldMaps","getSettings","minZoomDistance","maxZoomDistance","loadMaps","loadPageAddress","cameraMoved","mapInteraction","loadUserSettings","player","findPlayerMap","followPlayerMarker","loadPlayerData","initPlayerMarkerManager","initMarkerFileManager","BlueMapMap","map1","map2","fileData","mouseInvert","fullscreen","transition","startY","targetY","startAngle","targetAngle","startOrtho","startTilt","startRotation","clearTileCache","saveUserSetting","reload","resolutionDefault","hiresSliderDefault","lowresSliderDefault","useCookies","loadUserSetting","setScreenshotClipboard","setDebug","defaultValue","String","includesCI","toLowerCase","bluemap","getElementById","config","productionTip","vue","h","App","$mount","$nextTick"],"mappings":"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","file":"js/app.923ee73b.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextInput.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerItem.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlsSwitch.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SvgButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumberInput.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DayNightSwitch.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FreeFlightMobileControls.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Compass.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{'theme-light': _vm.appState.theme === 'light', 'theme-dark': _vm.appState.theme === 'dark', 'theme-contrast': _vm.appState.theme === 'contrast'},attrs:{\"id\":\"app\"}},[(_vm.appState.controls.state === 'free')?_c('FreeFlightMobileControls'):_vm._e(),_c('ControlBar'),_c('MainMenu',{attrs:{\"menu\":_vm.appState.menu}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"control-bar\"},[_c('MenuButton',{attrs:{\"close\":_vm.appState.menu.isOpen,\"back\":false,\"title\":_vm.$t('menu.tooltip')},on:{\"action\":function($event){return _vm.appState.menu.reOpenPage()}}}),_c('div',{staticClass:\"space thin-hide\"}),(_vm.appState.maps.length > 0)?_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('maps.tooltip')},on:{\"action\":function($event){_vm.appState.menu.openPage('maps', _vm.$t('maps.title'))}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('polygon',{attrs:{\"points\":\"26.708,22.841 19.049,25.186 11.311,20.718 3.292,22.841 7.725,5.96 13.475,4.814 19.314,7.409 25.018,6.037 \"}})])]):_vm._e(),(_vm.markers.markerSets.length > 0 || _vm.markers.markers.length > 0)?_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('markers.tooltip')},on:{\"action\":function($event){_vm.appState.menu.openPage('markers', _vm.$t('markers.title'), {markerSet: _vm.markers})}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M15,3.563c-4.459,0-8.073,3.615-8.073,8.073c0,6.483,8.196,14.802,8.196,14.802s7.951-8.013,7.951-14.802\\n\\t\\t\\tC23.073,7.177,19.459,3.563,15,3.563z M15,15.734c-2.263,0-4.098-1.835-4.098-4.099c0-2.263,1.835-4.098,4.098-4.098\\n\\t\\t\\tc2.263,0,4.098,1.835,4.098,4.098C19.098,13.899,17.263,15.734,15,15.734z\"}})])]):_vm._e(),(!_vm.playerMarkerSet.fake)?_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('players.tooltip')},on:{\"action\":_vm.openPlayerList}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('g',[_c('path',{attrs:{\"d\":\"M8.95,14.477c0.409-0.77,1.298-1.307,2.164-1.309h0.026c-0.053-0.234-0.087-0.488-0.087-0.755\\n\\t\\t\\tc0-1.381,0.715-2.595,1.791-3.301c-0.01,0-0.021-0.006-0.03-0.006h-1.427c-0.39,0-0.514-0.251-0.276-0.563\\n\\t\\t\\tc0,0,0.497-0.645,0.497-1.452c0-1.48-1.2-2.681-2.679-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\\n\\t\\t\\tc0.24,0.311,0.114,0.565-0.275,0.565L5.042,9.118C4.649,9.119,4.182,9.405,3.998,9.75l-2.601,4.927\\n\\t\\t\\tc-0.184,0.347-0.062,0.802,0.265,1.015l1.297,0.83c0.332,0.213,0.794,0.135,1.034-0.18l0.598-0.775\\n\\t\\t\\tc0.238-0.31,0.471-0.245,0.516,0.141l0.454,3.854c0.035,0.311,0.272,0.566,0.564,0.66c0.018-0.279,0.087-0.561,0.225-0.82\\n\\t\\t\\tL8.95,14.477z\"}}),_c('path',{attrs:{\"d\":\"M28.604,14.677l-2.597-4.94c-0.185-0.346-0.65-0.631-1.042-0.631h-1.428c-0.39,0-0.514-0.251-0.274-0.563\\n\\t\\t\\tc0,0,0.496-0.645,0.496-1.452c0-1.48-1.2-2.681-2.68-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\\n\\t\\t\\tc0.239,0.311,0.114,0.565-0.275,0.565l-1.428,0.009c-0.005,0-0.009,0.002-0.015,0.002c1.067,0.708,1.774,1.917,1.774,3.292\\n\\t\\t\\tc0,0.263-0.031,0.513-0.084,0.744h0.02c0.868,0,1.758,0.537,2.166,1.305l2.598,4.944c0.137,0.262,0.205,0.539,0.222,0.818\\n\\t\\t\\tc0.296-0.092,0.538-0.35,0.574-0.664l0.451-3.842c0.044-0.389,0.28-0.452,0.519-0.143l0.588,0.768\\n\\t\\t\\tc0.239,0.313,0.702,0.391,1.033,0.182l1.297-0.833C28.667,15.479,28.787,15.026,28.604,14.677z\"}})]),_c('path',{attrs:{\"d\":\"M19.932,15.058c-0.184-0.346-0.651-0.63-1.043-0.63h-1.427c-0.39,0-0.515-0.252-0.275-0.564c0,0,0.496-0.645,0.496-1.451\\n\\t\\tc0-1.479-1.199-2.68-2.679-2.68c-1.482,0-2.679,1.201-2.679,2.68c0,0.806,0.496,1.451,0.496,1.451\\n\\t\\tc0.24,0.312,0.114,0.566-0.275,0.566l-1.427,0.009c-0.393,0.001-0.861,0.287-1.045,0.632l-2.602,4.925\\n\\t\\tc-0.185,0.348-0.062,0.803,0.266,1.016l1.297,0.832c0.332,0.213,0.794,0.133,1.034-0.18l0.598-0.775\\n\\t\\tc0.239-0.311,0.472-0.246,0.517,0.141l0.454,3.854c0.043,0.389,0.403,0.705,0.794,0.705h5.148c0.392,0,0.749-0.316,0.794-0.705\\n\\t\\tl0.45-3.844c0.045-0.389,0.282-0.451,0.52-0.143l0.587,0.768c0.239,0.313,0.703,0.393,1.033,0.182l1.297-0.832\\n\\t\\tc0.331-0.213,0.451-0.666,0.269-1.016L19.932,15.058z\"}})])]):_vm._e(),_c('div',{staticClass:\"space thin-hide greedy\"}),_c('DayNightSwitch',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('lighting.dayNightSwitch.tooltip')}}),_c('div',{staticClass:\"space thin-hide\"}),_c('ControlsSwitch',{staticClass:\"thin-hide\"}),_c('div',{staticClass:\"space thin-hide\"}),_c('SvgButton',{staticClass:\"thin-hide\",attrs:{\"title\":_vm.$t('resetCamera.tooltip')},on:{\"action\":function($event){return _vm.$bluemap.resetCamera()}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('rect',{attrs:{\"x\":\"7.085\",\"y\":\"4.341\",\"transform\":\"matrix(0.9774 0.2116 -0.2116 0.9774 3.2046 -1.394)\",\"width\":\"2.063\",\"height\":\"19.875\"}}),_c('path',{attrs:{\"d\":\"M12.528,5.088c0,0,3.416-0.382,4.479-0.031c1.005,0.332,2.375,2.219,3.382,2.545c1.096,0.354,4.607-0.089,4.607-0.089\\n      l-2.738,8.488c0,0-3.285,0.641-4.344,0.381c-1.049-0.257-2.607-2.015-3.642-2.324c-0.881-0.264-3.678-0.052-3.678-0.052\\n      L12.528,5.088z\"}})])]),_c('PositionInput',{staticClass:\"pos-input\"}),_c('Compass',{attrs:{\"title\":_vm.$t('compass.tooltip')}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"position-input\"},[_c('NumberInput',{attrs:{\"label\":\"x\",\"value\":_vm.controls.position.x},on:{\"input\":function($event){_vm.controls.position.x = parseFloat($event.target.value);}}}),(_vm.appState.controls.state === 'free')?_c('NumberInput',{attrs:{\"label\":\"y\",\"value\":_vm.controls.position.y},on:{\"input\":function($event){_vm.controls.position.y = parseFloat($event.target.value);}}}):_vm._e(),_c('NumberInput',{attrs:{\"label\":\"z\",\"value\":_vm.controls.position.z},on:{\"input\":function($event){_vm.controls.position.z = parseFloat($event.target.value);}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"number-input\"},[_c('label',[_c('span',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.label)+\":\")]),_c('input',{attrs:{\"type\":\"number\"},domProps:{\"value\":_vm._f(\"format\")(_vm.value)},on:{\"input\":function($event){return _vm.$emit('input', $event)},\"keydown\":function($event){return $event.stopPropagation()}}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"number-input\">\n    <label>\n      <span class=\"label\">{{label}}:</span>\n      <input type=\"number\"\n             v-bind:value=\"value | format\"\n             v-on:input=\"$emit('input', $event)\"\n             v-on:keydown=\"$event.stopPropagation()\"\n      >\n    </label>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"NumberInput\",\n  props: {\n    label: String,\n    value: Number\n  },\n  filters: {\n    format(value) {\n      return Math.floor(value);\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .number-input {\n    pointer-events: auto;\n\n    background-color: var(--theme-bg);\n    color: var(--theme-fg);\n\n    min-height: 2em;\n\n    .label {\n      display: inline-block;\n      width: 1em;\n      padding: 0 0.5em 0 0.5em;\n\n      color: var(--theme-fg-light);\n    }\n\n    input {\n      height: 100%;\n      line-height: 100%;\n      width: calc(100% - 2em);\n\n      background-color: inherit;\n      color: inherit;\n\n      // remove number spinner firefox\n      -moz-appearance: textfield;\n\n      // remove number spinner webkit\n      &::-webkit-inner-spin-button,\n      &::-webkit-outer-spin-button {\n        -webkit-appearance: none;\n        margin: 0;\n      }\n    }\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumberInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NumberInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./NumberInput.vue?vue&type=template&id=69a7a1b7&\"\nimport script from \"./NumberInput.vue?vue&type=script&lang=js&\"\nexport * from \"./NumberInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./NumberInput.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"position-input\">\n    <NumberInput label=\"x\" :value=\"controls.position.x\" v-on:input=\"controls.position.x = parseFloat($event.target.value);\" />\n    <NumberInput label=\"y\" :value=\"controls.position.y\" v-on:input=\"controls.position.y = parseFloat($event.target.value);\" v-if=\"appState.controls.state === 'free'\" />\n    <NumberInput label=\"z\" :value=\"controls.position.z\" v-on:input=\"controls.position.z = parseFloat($event.target.value);\" />\n  </div>\n</template>\n\n<script>\n  import NumberInput from \"@/components/ControlBar/NumberInput\";\n\n  export default {\n    name: \"PositionInput\",\n    components: {\n      NumberInput\n    },\n    data() {\n      return {\n        controls: this.$bluemap.mapViewer.controlsManager.data,\n        appState: this.$bluemap.appState\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .position-input {\n    display: flex;\n    user-select: none;\n\n    > * {\n      width: 100%;\n\n      &:not(:first-child) {\n        border-left: solid 1px var(--theme-bg-light);\n      }\n    }\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PositionInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PositionInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PositionInput.vue?vue&type=template&id=cd44c82e&\"\nimport script from \"./PositionInput.vue?vue&type=script&lang=js&\"\nexport * from \"./PositionInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PositionInput.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SvgButton',{staticClass:\"compass\",on:{\"action\":_vm.action}},[_c('svg',{style:(_vm.style),attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{staticClass:\"north\",attrs:{\"d\":\"M14.792,1.04c0.114-0.354,0.299-0.354,0.412,0l4.089,12.729c0.114,0.353-0.097,0.642-0.468,0.642\\n      l-7.651,0.001c-0.371,0-0.581-0.288-0.468-0.642L14.792,1.04z\"}}),_c('path',{staticClass:\"south\",attrs:{\"d\":\"M10.707,16.23c-0.114-0.353,0.097-0.642,0.468-0.642l7.651-0.001c0.371,0,0.581,0.289,0.468,0.642\\n      l-4.086,12.73c-0.113,0.353-0.299,0.353-0.412,0L10.707,16.23z\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {MathUtils, Vector2, Vector3} from \"three\";\n\nexport const VEC2_ZERO = new Vector2(0, 0);\nexport const VEC3_ZERO = new Vector3(0, 0, 0);\nexport const VEC3_X = new Vector3(1, 0, 0);\nexport const VEC3_Y = new Vector3(0, 1, 0);\nexport const VEC3_Z = new Vector3(0, 0, 1);\n\n/**\n * Converts a url-encoded image string to an actual image-element\n * @param string {string}\n * @returns {HTMLElement}\n */\nexport const stringToImage = string => {\n    let image = document.createElementNS('http://www.w3.org/1999/xhtml', 'img');\n    image.src = string;\n    return image;\n};\n\n/**\n * Creates an optimized path from x,z coordinates used by bluemap to save tiles\n * @param x {number}\n * @param z {number}\n * @returns {string}\n */\nexport const pathFromCoords = (x, z) => {\n    let path = 'x';\n    path += splitNumberToPath(x);\n\n    path += 'z';\n    path += splitNumberToPath(z);\n\n    path = path.substring(0, path.length - 1);\n\n    return path;\n};\n\n/**\n * Splits a number into an optimized folder-path used to save bluemap-tiles\n * @param num {number}\n * @returns {string}\n */\nconst splitNumberToPath = num => {\n    let path = '';\n\n    if (num < 0) {\n        num = -num;\n        path += '-';\n    }\n\n    let s = num.toString();\n\n    for (let i = 0; i < s.length; i++) {\n        path += s.charAt(i) + '/';\n    }\n\n    return path;\n};\n\n/**\n * Hashes tile-coordinates to be saved in a map\n * @param x {number}\n * @param z {number}\n * @returns {string}\n */\nexport const hashTile = (x, z) => `x${x}z${z}`;\n\nexport const generateCacheHash = () => {\n    return Math.round(Math.random() * 1000000);\n}\n\n/**\n * Dispatches an event to the element of this map-viewer\n * @param element {EventTarget} the element on that the event is dispatched\n * @param event {string}\n * @param detail {object}\n * @returns {undefined|void|boolean}\n */\nexport const dispatchEvent = (element, event, detail = {}) => {\n    if (!element || !element.dispatchEvent) return;\n\n    return element.dispatchEvent(new CustomEvent(event, {\n        detail: detail\n    }));\n}\n\n/**\n * Sends a \"bluemapAlert\" event with a message and a level.\n * The level can be anything, but the app uses the levels\n * - debug\n * - fine\n * - info\n * - warning\n * - error\n * @param element {EventTarget} the element on that the event is dispatched\n * @param message {object}\n * @param level {string}\n */\nexport const alert = (element, message, level = \"info\") => {\n\n    // alert event\n    let printToConsole = dispatchEvent(element, \"bluemapAlert\", {\n        message: message,\n        level: level\n    });\n\n    // log alert to console\n    if (printToConsole !== false) {\n        if (level === \"info\") {\n            console.log(`[BlueMap/${level}]`, message);\n        } else if (level === \"warning\") {\n            console.warn(`[BlueMap/${level}]`, message);\n        } else if (level === \"error\") {\n            console.error(`[BlueMap/${level}]`, message);\n        } else {\n            console.debug(`[BlueMap/${level}]`, message);\n        }\n    }\n}\n\n/**\n * Source: https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro/35385518#35385518\n *\n * @param html {string} representing a single element\n * @return {Element}\n */\nexport const htmlToElement = html => {\n    let template = document.createElement('template');\n    template.innerHTML = html.trim();\n    return template.content.firstChild;\n}\n\n/**\n * Source: https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro/35385518#35385518\n *\n * @param html {string} representing any number of sibling elements\n * @return {NodeList}\n */\nexport const htmlToElements = html => {\n    let template = document.createElement('template');\n    template.innerHTML = html;\n    return template.content.childNodes;\n}\n\n/**\n * Schedules an animation\n * @param durationMs {number} the duration of the animation in ms\n * @param animationFrame {function(progress: number, deltaTime: number)} a function that is getting called each frame with the parameters (progress (0-1), deltaTime)\n * @param postAnimation {function(finished: boolean)} a function that gets called once after the animation is finished or cancelled. The function accepts one bool-parameter whether the animation was finished (true) or canceled (false)\n * @returns {{cancel: function()}} the animation object\n */\nexport const animate = function (animationFrame, durationMs = 1000, postAnimation = null) {\n    let animation = {\n        animationStart: -1,\n        lastFrame: -1,\n        cancelled: false,\n\n        frame: function (time) {\n            if (this.cancelled) return;\n\n            if (this.animationStart === -1) {\n                this.animationStart = time;\n                this.lastFrame = time;\n            }\n\n            let progress = durationMs === 0 ? 1 : MathUtils.clamp((time - this.animationStart) / durationMs, 0, 1);\n            let deltaTime = time - this.lastFrame;\n\n            animationFrame(progress, deltaTime);\n\n            if (progress < 1) window.requestAnimationFrame(time => this.frame(time));\n            else if (postAnimation) postAnimation(true);\n\n            this.lastFrame = time;\n        },\n\n        cancel: function () {\n            this.cancelled = true;\n            if (postAnimation) postAnimation(false);\n        }\n    };\n\n    window.requestAnimationFrame(time => animation.frame(time));\n\n    return animation;\n}\n\n/**\n * Source: https://gist.github.com/gre/1650294\n * @type {{\n *      easeOutCubic: (function(number): number),\n *      linear: (function(number): number),\n *      easeOutQuint: (function(number): number),\n *      easeInQuart: (function(number): number),\n *      easeInOutQuint: (function(number): number),\n *      easeInQuad: (function(number): number),\n *      easeOutQuart: (function(number): number),\n *      easeInCubic: (function(number): number),\n *      easeInQuint: (function(number): number),\n *      easeOutQuad: (function(number): number),\n *      easeInOutQuad: (function(number): number),\n *      easeInOutCubic: (function(number): number),\n *      easeInOutQuart: (function(number): number)\n *      }}\n */\nexport const EasingFunctions = {\n    // no easing, no acceleration\n    linear: t => t,\n    // accelerating from zero velocity\n    easeInQuad: t => t*t,\n    // decelerating to zero velocity\n    easeOutQuad: t => t*(2-t),\n    // acceleration until halfway, then deceleration\n    easeInOutQuad: t => t<.5 ? 2*t*t : -1+(4-2*t)*t,\n    // accelerating from zero velocity\n    easeInCubic: t => t*t*t,\n    // decelerating to zero velocity\n    easeOutCubic: t => (--t)*t*t+1,\n    // acceleration until halfway, then deceleration\n    easeInOutCubic: t => t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1,\n    // accelerating from zero velocity\n    easeInQuart: t => t*t*t*t,\n    // decelerating to zero velocity\n    easeOutQuart: t => 1-(--t)*t*t*t,\n    // acceleration until halfway, then deceleration\n    easeInOutQuart: t => t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t,\n    // accelerating from zero velocity\n    easeInQuint: t => t*t*t*t*t,\n    // decelerating to zero velocity\n    easeOutQuint: t => 1+(--t)*t*t*t*t,\n    // acceleration until halfway, then deceleration\n    easeInOutQuint: t => t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t\n}\n\n/**\n * Returns the offset position of an element\n *\n * Source: https://plainjs.com/javascript/styles/get-the-position-of-an-element-relative-to-the-document-24/\n *\n * @param element {Element}\n * @returns {{top: number, left: number}}\n */\nexport const elementOffset = element => {\n    let rect = element.getBoundingClientRect(),\n        scrollLeft = window.pageXOffset || document.documentElement.scrollLeft,\n        scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n    return { top: rect.top + scrollTop, left: rect.left + scrollLeft }\n}\n\n/**\n * Very simple deep equals, should not be used for complex objects. Is designed for comparing parsed json-objects.\n * @param object1 {object}\n * @param object2 {object}\n * @returns {boolean}\n */\nexport const deepEquals = (object1, object2) => {\n    if (Object.is(object1, object2)) return true;\n\n    let type = typeof object1;\n    if (type !== typeof object2) return false;\n\n    if (type === 'number' || type === 'boolean' || type === 'string') return false;\n\n    if (Array.isArray(object1)){\n        let len = object1.length;\n        if (len !== object2.length) return false;\n        for (let i = 0; i < len; i++) {\n            if (!deepEquals(object1[i], object2[i])) return false;\n        }\n\n        return true;\n    }\n\n    for (let property in object1) {\n        if (!object1.hasOwnProperty(property)) continue;\n        if (!deepEquals(object1[property], object2[property])) return false;\n    }\n\n    return true;\n}\n\n/**\n * Adds one listener to multiple events\n * @param target {EventTarget}\n * @param types {string|string[]}\n * @param listener {EventListenerOrEventListenerObject | null}\n * @param options {boolean | AddEventListenerOptions?}\n */\nexport const addEventListeners = (target, types, listener, options) => {\n    if (!Array.isArray(types)){\n        types = types.trim().split(\" \");\n    }\n\n    types.forEach(type => target.addEventListener(type, listener, options));\n}\n\n/**\n * Removes one listener to multiple events\n * @param target {EventTarget}\n * @param types {string|string[]}\n * @param listener {EventListenerOrEventListenerObject | null}\n * @param options {boolean | EventListenerOptions?}\n */\nexport const removeEventListeners = (target, types, listener, options) => {\n    if (!Array.isArray(types)){\n        types = types.trim().split(\" \");\n    }\n\n    types.forEach(type => target.removeEventListener(type, listener, options));\n}\n\n/**\n * Softly clamps towards a minimum value\n * @param value {number}\n * @param min {number}\n * @param stiffness {number}\n * @returns {number}\n */\nexport const softMin = (value, min, stiffness) => {\n    if (value >= min) return value;\n    let delta = min - value;\n    if (delta < 0.0001) return min;\n    return value + delta * stiffness;\n}\n\n/**\n * Softly clamps towards a maximum value\n * @param value {number}\n * @param max {number}\n * @param stiffness {number}\n * @returns {number}\n */\nexport const softMax = (value, max, stiffness) => {\n    if (value <= max) return value;\n    let delta = value - max;\n    if (delta < 0.0001) return max;\n    return value - delta * stiffness;\n}\n\n/**\n * Softly clamps towards a minimum and maximum value\n * @param value {number}\n * @param min {number}\n * @param max {number}\n * @param stiffness {number}\n * @returns {number}\n */\nexport const softClamp = (value, min, max, stiffness) => {\n    return softMax(softMin(value, min, stiffness), max, stiffness);\n}\n\nexport const vecArrToObj = (val, useZ = false) => {\n    if (val && val.length >= 2) {\n        if (useZ) return {x: val[0], z: val[1]};\n        return {x: val[0], y: val[1]};\n    }\n    return {};\n}\n\nconst pixel = document.createElement('canvas');\npixel.width = 1;\npixel.height = 1;\nconst pixelContext = pixel.getContext('2d', {\n    willReadFrequently: true\n});\n\nexport const getPixel = (img, x, y) => {\n    pixelContext.drawImage(img, Math.floor(x), Math.floor(y), 1, 1, 0, 0, 1, 1);\n    return pixelContext.getImageData(0, 0, 1, 1).data;\n}\n","<template>\n  <SvgButton class=\"compass\" @action=\"action\">\n    <svg viewBox=\"0 0 30 30\" :style=\"style\">\n      <path class=\"north\" d=\"M14.792,1.04c0.114-0.354,0.299-0.354,0.412,0l4.089,12.729c0.114,0.353-0.097,0.642-0.468,0.642\n        l-7.651,0.001c-0.371,0-0.581-0.288-0.468-0.642L14.792,1.04z\"/>\n      <path class=\"south\" d=\"M10.707,16.23c-0.114-0.353,0.097-0.642,0.468-0.642l7.651-0.001c0.371,0,0.581,0.289,0.468,0.642\n        l-4.086,12.73c-0.113,0.353-0.299,0.353-0.412,0L10.707,16.23z\"/>\n    </svg>\n  </SvgButton>\n</template>\n\n<script>\n  import {animate, EasingFunctions} from \"bluemap/src/util/Utils\";\n  import SvgButton from \"@/components/ControlBar/SvgButton\";\n\n  let animation;\n\n  export default {\n    name: \"Compass\",\n    components: {SvgButton},\n    data() {\n      return {\n        controls: this.$bluemap.mapViewer.controlsManager.data\n      }\n    },\n    computed: {\n      style() {\n        return {transform: \"translate(-50%, -50%) rotate(\" + (-this.controls.rotation) + \"rad)\"}\n      }\n    },\n    methods: {\n      action(evt) {\n        evt.preventDefault();\n\n        if (animation) animation.cancel();\n\n        let startRotation = this.controls.rotation;\n        animation = animate(t => {\n          this.controls.rotation = startRotation * (1-EasingFunctions.easeOutQuad(t));\n        }, 300);\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .compass {\n    svg {\n      height: 1.8em;\n\n      .north {\n        fill: var(--theme-fg);\n      }\n\n      .south {\n        fill: var(--theme-fg-light);\n      }\n    }\n\n    &:active {\n      svg {\n        .north {\n          fill: var(--theme-bg);\n        }\n\n        .south {\n          fill: var(--theme-bg-light);\n        }\n      }\n    }\n  }\n</style>","<template>\n  <SvgButton class=\"day-night-switch\" :active=\"!isDay\" @action=\"action\">\n    <svg viewBox=\"0 0 30 30\">\n      <path d=\"M17.011,19.722c-3.778-1.613-5.533-5.982-3.921-9.76c0.576-1.348,1.505-2.432,2.631-3.204\n        c-3.418-0.243-6.765,1.664-8.186,4.992c-1.792,4.197,0.159,9.053,4.356,10.844c3.504,1.496,7.462,0.377,9.717-2.476\n        C20.123,20.465,18.521,20.365,17.011,19.722z\"/>\n      <circle cx=\"5.123\" cy=\"7.64\" r=\"1.196\"/>\n      <circle cx=\"23.178\" cy=\"5.249\" r=\"1.195\"/>\n      <circle cx=\"20.412\" cy=\"13.805\" r=\"1.195\"/>\n      <circle cx=\"25.878\" cy=\"23.654\" r=\"1.195\"/>\n    </svg>\n  </SvgButton>\n</template>\n\n<script>\nimport {animate, EasingFunctions} from \"bluemap/src/util/Utils\";\nimport SvgButton from \"@/components/ControlBar/SvgButton\";\n\nlet animation;\n\nexport default {\n    name: \"DayNightSwitch\",\n  components: {SvgButton},\n  data() {\n      return {\n        mapViewer: this.$bluemap.mapViewer.data\n      }\n    },\n    computed: {\n      isDay() {\n        return this.mapViewer.uniforms.sunlightStrength.value > 0.6;\n      }\n    },\n    methods: {\n      action(evt) {\n\n        evt.preventDefault();\n\n        if (animation) animation.cancel();\n\n        let startValue = this.mapViewer.uniforms.sunlightStrength.value;\n        let targetValue = this.isDay ? 0.25 : 1;\n        animation = animate(t => {\n          let u = EasingFunctions.easeOutQuad(t);\n          this.mapViewer.uniforms.sunlightStrength.value = startValue * (1-u) + targetValue * u;\n        }, 300);\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .day-night-switch {\n    svg {\n      fill: var(--theme-moon-day);\n      circle {\n        fill: var(--theme-stars-day);\n      }\n    }\n\n    &:active {\n      svg {\n        fill: var(--theme-moon-night);\n        circle {\n          fill: var(--theme-stars-night);\n        }\n      }\n    }\n  }\n</style>","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"svg-button\",class:{active: _vm.active},on:{\"click\":function($event){return _vm.$emit('action', $event)}}},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"svg-button\" :class=\"{active: active}\" @click=\"$emit('action', $event)\">\n    <slot />\n  </div>\n</template>\n\n<script>\n  export default {\n    name: \"SvgButton\",\n    props: {\n      active: Boolean,\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n.svg-button {\n  position: relative;\n  pointer-events: auto;\n  overflow: hidden;\n  cursor: pointer;\n\n  min-width: 2em;\n  min-height: 2em;\n\n  background-color: var(--theme-bg);\n  color: var(--theme-fg);\n\n  &:hover {\n    background-color: var(--theme-bg-hover);\n  }\n\n  &.active {\n    background-color: var(--theme-bg-light);\n  }\n\n  &:active {\n    background-color: var(--theme-fg-light);\n    color: var(--theme-bg);\n  }\n\n  svg {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n\n    height: 1.8em;\n\n    fill: var(--theme-fg-light);\n  }\n\n  &:active {\n    svg {\n      fill: var(--theme-bg-light);\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SvgButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SvgButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SvgButton.vue?vue&type=template&id=b5204e98&\"\nimport script from \"./SvgButton.vue?vue&type=script&lang=js&\"\nexport * from \"./SvgButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SvgButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Compass.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Compass.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Compass.vue?vue&type=template&id=9d1413c2&\"\nimport script from \"./Compass.vue?vue&type=script&lang=js&\"\nexport * from \"./Compass.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Compass.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SvgButton',{staticClass:\"day-night-switch\",attrs:{\"active\":!_vm.isDay},on:{\"action\":_vm.action}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M17.011,19.722c-3.778-1.613-5.533-5.982-3.921-9.76c0.576-1.348,1.505-2.432,2.631-3.204\\n      c-3.418-0.243-6.765,1.664-8.186,4.992c-1.792,4.197,0.159,9.053,4.356,10.844c3.504,1.496,7.462,0.377,9.717-2.476\\n      C20.123,20.465,18.521,20.365,17.011,19.722z\"}}),_c('circle',{attrs:{\"cx\":\"5.123\",\"cy\":\"7.64\",\"r\":\"1.196\"}}),_c('circle',{attrs:{\"cx\":\"23.178\",\"cy\":\"5.249\",\"r\":\"1.195\"}}),_c('circle',{attrs:{\"cx\":\"20.412\",\"cy\":\"13.805\",\"r\":\"1.195\"}}),_c('circle',{attrs:{\"cx\":\"25.878\",\"cy\":\"23.654\",\"r\":\"1.195\"}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DayNightSwitch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DayNightSwitch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DayNightSwitch.vue?vue&type=template&id=5b57efe8&\"\nimport script from \"./DayNightSwitch.vue?vue&type=script&lang=js&\"\nexport * from \"./DayNightSwitch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DayNightSwitch.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"controls-switch\"},[_c('SvgButton',{attrs:{\"active\":_vm.isPerspectiveView,\"title\":_vm.$t('controls.perspective.tooltip')},on:{\"action\":_vm.setPerspectiveView}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M19.475,10.574c-0.166-0.021-0.337-0.036-0.51-0.045c-0.174-0.009-0.35-0.013-0.525-0.011\\n        c-0.176,0.002-0.353,0.01-0.526,0.024c-0.175,0.015-0.347,0.036-0.515,0.063l-13.39,2.189\\n        c-0.372,0.061-0.7,0.146-0.975,0.247c-0.276,0.102-0.5,0.221-0.66,0.349c-0.161,0.129-0.259,0.268-0.282,0.408\\n        c-0.024,0.141,0.028,0.285,0.165,0.421l5.431,5.511c0.086,0.087,0.191,0.167,0.314,0.241s0.263,0.142,0.417,0.202\\n        c0.155,0.062,0.323,0.115,0.502,0.162c0.18,0.046,0.371,0.085,0.569,0.116s0.405,0.054,0.616,0.068\\n        c0.211,0.015,0.427,0.021,0.645,0.017c0.217-0.003,0.436-0.016,0.652-0.037c0.217-0.022,0.431-0.054,0.641-0.095L27.12,17.43\\n        c0.371-0.073,0.679-0.175,0.917-0.296c0.236-0.12,0.404-0.259,0.497-0.407c0.093-0.147,0.111-0.305,0.052-0.461\\n        c-0.059-0.156-0.195-0.313-0.415-0.46l-7.089-4.742c-0.089-0.06-0.192-0.115-0.308-0.166\\n        c-0.116-0.051-0.243-0.097-0.381-0.138c-0.137-0.041-0.283-0.078-0.438-0.108C19.803,10.621,19.641,10.595,19.475,10.574\"}})])]),_c('SvgButton',{attrs:{\"active\":_vm.isFlatView,\"title\":_vm.$t('controls.flatView.tooltip')},on:{\"action\":_vm.setFlatView}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M22.371,4.158c1.65,0,3,1.35,3,3v15.684c0,1.65-1.35,3-3,3H7.629c-1.65,0-3-1.35-3-3V7.158c0-1.65,1.35-3,3-3H22.371z\"}})])]),(_vm.controls.enableFreeFlight)?_c('SvgButton',{attrs:{\"active\":_vm.isFreeFlight,\"title\":_vm.$t('controls.freeFlight.tooltip')},on:{\"action\":_vm.setFreeFlight}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M21.927,11.253c-0.256-0.487-0.915-0.885-1.465-0.885h-2.004c-0.55,0-0.726-0.356-0.39-0.792c0,0,0.698-0.905,0.698-2.041\\n        c0-2.08-1.687-3.767-3.767-3.767s-3.767,1.687-3.767,3.767c0,1.136,0.698,2.041,0.698,2.041c0.336,0.436,0.161,0.794-0.389,0.797\\n        l-2.005,0.01c-0.55,0.002-1.21,0.403-1.467,0.889l-3.656,6.924c-0.257,0.487-0.088,1.128,0.375,1.425l1.824,1.171\\n        c0.462,0.297,1.116,0.184,1.451-0.253l0.839-1.092c0.335-0.437,0.662-0.346,0.726,0.2l0.637,5.415\\n        c0.064,0.546,0.567,0.993,1.117,0.993h7.234c0.55,0,1.053-0.447,1.117-0.993l0.635-5.401c0.064-0.546,0.392-0.637,0.727-0.2\\n        l0.828,1.078c0.335,0.437,0.988,0.55,1.451,0.253l1.823-1.171c0.463-0.297,0.633-0.938,0.377-1.425L21.927,11.253z\"}})])]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"controls-switch\">\n    <SvgButton :active=\"isPerspectiveView\" @action=\"setPerspectiveView\" :title=\"$t('controls.perspective.tooltip')\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M19.475,10.574c-0.166-0.021-0.337-0.036-0.51-0.045c-0.174-0.009-0.35-0.013-0.525-0.011\n          c-0.176,0.002-0.353,0.01-0.526,0.024c-0.175,0.015-0.347,0.036-0.515,0.063l-13.39,2.189\n          c-0.372,0.061-0.7,0.146-0.975,0.247c-0.276,0.102-0.5,0.221-0.66,0.349c-0.161,0.129-0.259,0.268-0.282,0.408\n          c-0.024,0.141,0.028,0.285,0.165,0.421l5.431,5.511c0.086,0.087,0.191,0.167,0.314,0.241s0.263,0.142,0.417,0.202\n          c0.155,0.062,0.323,0.115,0.502,0.162c0.18,0.046,0.371,0.085,0.569,0.116s0.405,0.054,0.616,0.068\n          c0.211,0.015,0.427,0.021,0.645,0.017c0.217-0.003,0.436-0.016,0.652-0.037c0.217-0.022,0.431-0.054,0.641-0.095L27.12,17.43\n          c0.371-0.073,0.679-0.175,0.917-0.296c0.236-0.12,0.404-0.259,0.497-0.407c0.093-0.147,0.111-0.305,0.052-0.461\n          c-0.059-0.156-0.195-0.313-0.415-0.46l-7.089-4.742c-0.089-0.06-0.192-0.115-0.308-0.166\n          c-0.116-0.051-0.243-0.097-0.381-0.138c-0.137-0.041-0.283-0.078-0.438-0.108C19.803,10.621,19.641,10.595,19.475,10.574\"/>\n      </svg>\n    </SvgButton>\n    <SvgButton :active=\"isFlatView\" @action=\"setFlatView\" :title=\"$t('controls.flatView.tooltip')\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M22.371,4.158c1.65,0,3,1.35,3,3v15.684c0,1.65-1.35,3-3,3H7.629c-1.65,0-3-1.35-3-3V7.158c0-1.65,1.35-3,3-3H22.371z\"/>\n      </svg>\n    </SvgButton>\n    <SvgButton v-if=\"controls.enableFreeFlight\" :active=\"isFreeFlight\" @action=\"setFreeFlight\" :title=\"$t('controls.freeFlight.tooltip')\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M21.927,11.253c-0.256-0.487-0.915-0.885-1.465-0.885h-2.004c-0.55,0-0.726-0.356-0.39-0.792c0,0,0.698-0.905,0.698-2.041\n          c0-2.08-1.687-3.767-3.767-3.767s-3.767,1.687-3.767,3.767c0,1.136,0.698,2.041,0.698,2.041c0.336,0.436,0.161,0.794-0.389,0.797\n          l-2.005,0.01c-0.55,0.002-1.21,0.403-1.467,0.889l-3.656,6.924c-0.257,0.487-0.088,1.128,0.375,1.425l1.824,1.171\n          c0.462,0.297,1.116,0.184,1.451-0.253l0.839-1.092c0.335-0.437,0.662-0.346,0.726,0.2l0.637,5.415\n          c0.064,0.546,0.567,0.993,1.117,0.993h7.234c0.55,0,1.053-0.447,1.117-0.993l0.635-5.401c0.064-0.546,0.392-0.637,0.727-0.2\n          l0.828,1.078c0.335,0.437,0.988,0.55,1.451,0.253l1.823-1.171c0.463-0.297,0.633-0.938,0.377-1.425L21.927,11.253z\"/>\n      </svg>\n    </SvgButton>\n  </div>\n</template>\n\n<script>\n  import SvgButton from \"@/components/ControlBar/SvgButton\";\n\n  export default {\n    name: \"ControlsSwitch\",\n    components: {SvgButton},\n    data() {\n      return {\n        controls: this.$bluemap.appState.controls,\n      }\n    },\n    computed: {\n      isPerspectiveView() {\n        return this.controls.state === \"perspective\";\n      },\n      isFlatView() {\n        return this.controls.state === \"flat\";\n      },\n      isFreeFlight() {\n        return this.controls.state === \"free\";\n      }\n    },\n    methods: {\n      setPerspectiveView() {\n        this.$bluemap.setPerspectiveView(500, this.isFreeFlight ? 100 : 0);\n      },\n      setFlatView() {\n        this.$bluemap.setFlatView(500, this.isFreeFlight ? 100 : 0);\n      },\n      setFreeFlight() {\n        this.$bluemap.setFreeFlight(500);\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .controls-switch {\n    display: flex;\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlsSwitch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlsSwitch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ControlsSwitch.vue?vue&type=template&id=76711d43&\"\nimport script from \"./ControlsSwitch.vue?vue&type=script&lang=js&\"\nexport * from \"./ControlsSwitch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ControlsSwitch.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SvgButton',{staticClass:\"menu-button\",class:{close: _vm.close, back: _vm.back},on:{\"action\":function($event){return _vm.$emit('action', $event)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('g',[_c('path',{attrs:{\"d\":\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\\n  c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"}}),_c('path',{attrs:{\"d\":\"M25.004,15c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n  c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,13.539,25.004,14.193,25.004,15L25.004,15z\"}}),_c('path',{attrs:{\"d\":\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n  c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"}})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <SvgButton class=\"menu-button\" :class=\"{close: close, back: back}\" @action=\"$emit('action', $event)\">\n    <svg viewBox=\"0 0 30 30\">\n      <g>\n        <path d=\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\n    c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"/>\n        <path d=\"M25.004,15c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n    c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,13.539,25.004,14.193,25.004,15L25.004,15z\"/>\n        <path d=\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n    c0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"/>\n      </g>\n    </svg>\n  </SvgButton>\n</template>\n\n<script>\nimport SvgButton from \"@/components/ControlBar/SvgButton\";\nexport default {\n  name: \"MenuButton\",\n  components: {SvgButton},\n  props: {\n    close: Boolean,\n    back: Boolean,\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .menu-button {\n\n    svg {\n      g {\n        transform-origin: center;\n        transition: transform 0.3s;\n      }\n      path {\n        transition: transform 0.3s, fill 0.3s;\n        transform: translate(0 0) rotate(0);\n\n        &:nth-child(1) {\n          transform-origin: 15px 9px;\n        }\n\n        &:nth-child(2) {\n          transform-origin: 15px 15px;\n        }\n\n        &:nth-child(3) {\n          transform-origin: 15px 21px;\n        }\n      }\n    }\n\n    &.close {\n      svg {\n        path:nth-child(1) {\n          transform: translate(0, 5.75px) rotate(45deg);\n        }\n        path:nth-child(2) {\n          transform: translate(-100%, 0) rotate(0);\n        }\n        path:nth-child(3) {\n          transform: translate(0, -5.75px) rotate(-45deg);\n        }\n      }\n\n      &.back {\n        svg {\n          g {\n            transform: scale(0.75);\n          }\n          path:nth-child(1) {\n            transform: translate(0, 10px) rotate(30deg);\n          }\n          path:nth-child(2) {\n            transform: translate(-150%, 0) rotate(0);\n          }\n          path:nth-child(3) {\n            transform: translate(0, -10px) rotate(-30deg);\n          }\n        }\n      }\n    }\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MenuButton.vue?vue&type=template&id=6d719739&\"\nimport script from \"./MenuButton.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"control-bar\">\n    <MenuButton :close=\"appState.menu.isOpen\" :back=\"false\" @action=\"appState.menu.reOpenPage()\" :title=\"$t('menu.tooltip')\" />\n    <div class=\"space thin-hide\"></div>\n    <SvgButton v-if=\"appState.maps.length > 0\" class=\"thin-hide\" :title=\"$t('maps.tooltip')\"\n               @action=\"appState.menu.openPage('maps', $t('maps.title'))\">\n      <svg viewBox=\"0 0 30 30\">\n        <polygon points=\"26.708,22.841 19.049,25.186 11.311,20.718 3.292,22.841 7.725,5.96 13.475,4.814 19.314,7.409 25.018,6.037 \"/>\n      </svg>\n    </SvgButton>\n    <SvgButton v-if=\"markers.markerSets.length > 0 || markers.markers.length > 0\" class=\"thin-hide\" :title=\"$t('markers.tooltip')\"\n               @action=\"appState.menu.openPage('markers', $t('markers.title'), {markerSet: markers})\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M15,3.563c-4.459,0-8.073,3.615-8.073,8.073c0,6.483,8.196,14.802,8.196,14.802s7.951-8.013,7.951-14.802\n\t\t\tC23.073,7.177,19.459,3.563,15,3.563z M15,15.734c-2.263,0-4.098-1.835-4.098-4.099c0-2.263,1.835-4.098,4.098-4.098\n\t\t\tc2.263,0,4.098,1.835,4.098,4.098C19.098,13.899,17.263,15.734,15,15.734z\"/>\n      </svg>\n    </SvgButton>\n    <SvgButton v-if=\"!playerMarkerSet.fake\" class=\"thin-hide\" :title=\"$t('players.tooltip')\" @action=\"openPlayerList\">\n      <svg viewBox=\"0 0 30 30\">\n        <g>\n          <path d=\"M8.95,14.477c0.409-0.77,1.298-1.307,2.164-1.309h0.026c-0.053-0.234-0.087-0.488-0.087-0.755\n\t\t\tc0-1.381,0.715-2.595,1.791-3.301c-0.01,0-0.021-0.006-0.03-0.006h-1.427c-0.39,0-0.514-0.251-0.276-0.563\n\t\t\tc0,0,0.497-0.645,0.497-1.452c0-1.48-1.2-2.681-2.679-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\n\t\t\tc0.24,0.311,0.114,0.565-0.275,0.565L5.042,9.118C4.649,9.119,4.182,9.405,3.998,9.75l-2.601,4.927\n\t\t\tc-0.184,0.347-0.062,0.802,0.265,1.015l1.297,0.83c0.332,0.213,0.794,0.135,1.034-0.18l0.598-0.775\n\t\t\tc0.238-0.31,0.471-0.245,0.516,0.141l0.454,3.854c0.035,0.311,0.272,0.566,0.564,0.66c0.018-0.279,0.087-0.561,0.225-0.82\n\t\t\tL8.95,14.477z\"/>\n          <path d=\"M28.604,14.677l-2.597-4.94c-0.185-0.346-0.65-0.631-1.042-0.631h-1.428c-0.39,0-0.514-0.251-0.274-0.563\n\t\t\tc0,0,0.496-0.645,0.496-1.452c0-1.48-1.2-2.681-2.68-2.681c-1.481,0-2.679,1.2-2.679,2.681c0,0.807,0.496,1.452,0.496,1.452\n\t\t\tc0.239,0.311,0.114,0.565-0.275,0.565l-1.428,0.009c-0.005,0-0.009,0.002-0.015,0.002c1.067,0.708,1.774,1.917,1.774,3.292\n\t\t\tc0,0.263-0.031,0.513-0.084,0.744h0.02c0.868,0,1.758,0.537,2.166,1.305l2.598,4.944c0.137,0.262,0.205,0.539,0.222,0.818\n\t\t\tc0.296-0.092,0.538-0.35,0.574-0.664l0.451-3.842c0.044-0.389,0.28-0.452,0.519-0.143l0.588,0.768\n\t\t\tc0.239,0.313,0.702,0.391,1.033,0.182l1.297-0.833C28.667,15.479,28.787,15.026,28.604,14.677z\"/>\n        </g>\n        <path d=\"M19.932,15.058c-0.184-0.346-0.651-0.63-1.043-0.63h-1.427c-0.39,0-0.515-0.252-0.275-0.564c0,0,0.496-0.645,0.496-1.451\n\t\tc0-1.479-1.199-2.68-2.679-2.68c-1.482,0-2.679,1.201-2.679,2.68c0,0.806,0.496,1.451,0.496,1.451\n\t\tc0.24,0.312,0.114,0.566-0.275,0.566l-1.427,0.009c-0.393,0.001-0.861,0.287-1.045,0.632l-2.602,4.925\n\t\tc-0.185,0.348-0.062,0.803,0.266,1.016l1.297,0.832c0.332,0.213,0.794,0.133,1.034-0.18l0.598-0.775\n\t\tc0.239-0.311,0.472-0.246,0.517,0.141l0.454,3.854c0.043,0.389,0.403,0.705,0.794,0.705h5.148c0.392,0,0.749-0.316,0.794-0.705\n\t\tl0.45-3.844c0.045-0.389,0.282-0.451,0.52-0.143l0.587,0.768c0.239,0.313,0.703,0.393,1.033,0.182l1.297-0.832\n\t\tc0.331-0.213,0.451-0.666,0.269-1.016L19.932,15.058z\"/>\n      </svg>\n    </SvgButton>\n    <div class=\"space thin-hide greedy\"></div>\n    <DayNightSwitch class=\"thin-hide\" :title=\"$t('lighting.dayNightSwitch.tooltip')\" />\n    <div class=\"space thin-hide\"></div>\n    <ControlsSwitch class=\"thin-hide\"></ControlsSwitch>\n    <div class=\"space thin-hide\"></div>\n    <SvgButton class=\"thin-hide\" :title=\"$t('resetCamera.tooltip')\" @action=\"$bluemap.resetCamera()\">\n      <svg viewBox=\"0 0 30 30\">\n        <rect x=\"7.085\" y=\"4.341\" transform=\"matrix(0.9774 0.2116 -0.2116 0.9774 3.2046 -1.394)\" width=\"2.063\" height=\"19.875\"/>\n        <path d=\"M12.528,5.088c0,0,3.416-0.382,4.479-0.031c1.005,0.332,2.375,2.219,3.382,2.545c1.096,0.354,4.607-0.089,4.607-0.089\n      l-2.738,8.488c0,0-3.285,0.641-4.344,0.381c-1.049-0.257-2.607-2.015-3.642-2.324c-0.881-0.264-3.678-0.052-3.678-0.052\n      L12.528,5.088z\"/>\n      </svg>\n    </SvgButton>\n    <PositionInput class=\"pos-input\" />\n    <Compass :title=\"$t('compass.tooltip')\" />\n  </div>\n</template>\n\n<script>\n  import PositionInput from \"@/components/ControlBar/PositionInput\";\n  import Compass from \"@/components/ControlBar/Compass\";\n  import DayNightSwitch from \"@/components/ControlBar/DayNightSwitch\";\n  import ControlsSwitch from \"@/components/ControlBar/ControlsSwitch\";\n  import MenuButton from \"@/components/ControlBar/MenuButton\";\n  import SvgButton from \"@/components/ControlBar/SvgButton\";\n\n  export default {\n    name: \"ControlBar\",\n    components: {\n      SvgButton,\n      MenuButton,\n      ControlsSwitch,\n      DayNightSwitch,\n      PositionInput,\n      Compass\n    },\n    data() {\n      return {\n        appState: this.$bluemap.appState,\n        markers: this.$bluemap.mapViewer.markers.data,\n      }\n    },\n    computed: {\n      playerMarkerSet() {\n        for (let set of this.markers.markerSets) {\n          if (set.id === \"bm-players\") return set;\n        }\n\n        return {\n          id: \"bm-players\",\n          label: \"Players\",\n          markerSets: [],\n          markers: [],\n          fake: true,\n        }\n      }\n    },\n    methods: {\n      openPlayerList() {\n        let playerList = this.playerMarkerSet;\n        this.appState.menu.openPage('markers', this.$t(\"players.title\"), {markerSet: playerList});\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  @import \"~@/scss/variables.scss\";\n\n  .control-bar {\n    position: fixed;\n    top: 0;\n    left: 0;\n\n    display: flex;\n\n    filter: drop-shadow(1px 1px 3px rgba(0, 0, 0, 0.53));\n    height: 2em;\n\n    margin: 0.5em;\n    width: calc(100% - 1em);\n\n    .pos-input {\n      max-width: 20em;\n      width: 100%;\n    }\n\n    > :not(:first-child) {\n      border-left: solid 1px var(--theme-bg-light);\n    }\n\n    .space {\n      width: 0.5em;\n      flex-shrink: 0;\n\n      &.greedy {\n        flex-grow: 1;\n      }\n    }\n\n    .space, .space + * {\n      border-left: none;\n    }\n\n    @media (max-width: $mobile-break) {\n      margin: 0;\n      width: 100%;\n\n      background-color: var(--theme-bg-light);\n\n      .pos-input {\n        max-width: unset;\n      }\n\n      .thin-hide {\n        display: none;\n      }\n\n      .space {\n        width: 1px;\n      }\n    }\n\n  }\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ControlBar.vue?vue&type=template&id=e943b240&\"\nimport script from \"./ControlBar.vue?vue&type=script&lang=js&\"\nexport * from \"./ControlBar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ControlBar.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('SideMenu',{attrs:{\"open\":_vm.menu.isOpen,\"title\":_vm.menu.currentPage().title,\"back\":_vm.menu.pageStack.length > 1},on:{\"back\":function($event){return _vm.menu.closePage()},\"close\":function($event){return _vm.menu.closeAll()}}},[(_vm.menu.currentPage().id === 'root')?_c('div',[_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('maps', function () { return _vm.$t('maps.title'); })}}},[_vm._v(_vm._s(_vm.$t(\"maps.button\")))]),_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('markers', function () { return _vm.$t('markers.title'); }, {markerSet: _vm.markers})}}},[_vm._v(_vm._s(_vm.$t(\"markers.button\")))]),_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('settings', function () { return _vm.$t('settings.title'); })}}},[_vm._v(_vm._s(_vm.$t(\"settings.button\")))]),_c('SimpleButton',{attrs:{\"submenu\":true},on:{\"action\":function($event){_vm.menu.openPage('info', function () { return _vm.$t('info.title'); })}}},[_vm._v(_vm._s(_vm.$t(\"info.button\")))]),_c('hr'),_c('SimpleButton',{on:{\"action\":_vm.goFullscreen}},[_vm._v(_vm._s(_vm.$t(\"goFullscreen.button\")))]),_c('SimpleButton',{on:{\"action\":function($event){return _vm.$bluemap.resetCamera()}}},[_vm._v(_vm._s(_vm.$t(\"resetCamera.button\")))]),_c('SimpleButton',{on:{\"action\":function($event){return _vm.$bluemap.takeScreenshot()}}},[_vm._v(_vm._s(_vm.$t(\"screenshot.button\")))]),_c('SimpleButton',{attrs:{\"title\":_vm.$t('updateMap.tooltip')},on:{\"action\":function($event){return _vm.$bluemap.updateMap()}}},[_vm._v(_vm._s(_vm.$t(\"updateMap.button\")))])],1):_vm._e(),(_vm.menu.currentPage().id === 'maps')?_c('div',_vm._l((_vm.appState.maps),function(map){return _c('MapButton',{key:map.id,attrs:{\"map\":map}})}),1):_vm._e(),(_vm.menu.currentPage().id === 'markers')?_c('MarkerSetMenu',{attrs:{\"menu\":_vm.menu}}):_vm._e(),(_vm.menu.currentPage().id === 'settings')?_c('SettingsMenu'):_vm._e(),(_vm.menu.currentPage().id === 'info')?_c('div',{staticClass:\"info-content\",domProps:{\"innerHTML\":_vm._s(_vm.$t('info.content', {\n    version: _vm.$bluemap.settings.version\n  }))}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Transition',{attrs:{\"name\":\"side-menu\"},on:{\"enter\":function($event){_vm.buttonEnterAnimation(); _vm.$emit('enter', $event)}}},[(_vm.open)?_c('div',{staticClass:\"side-menu\"},[_c('MenuButton',{attrs:{\"close\":_vm.open && _vm.rendered,\"back\":_vm.back},on:{\"action\":function($event){return _vm.$emit('back', $event)}}}),(_vm.open && _vm.back)?_c('MenuButton',{staticClass:\"full-close\",attrs:{\"close\":true},on:{\"action\":function($event){return _vm.$emit('close', $event)}}}):_vm._e(),_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.title))]),_c('div',{staticClass:\"content\"},[_vm._t(\"default\")],2)],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Transition name=\"side-menu\" @enter=\"buttonEnterAnimation(); $emit('enter', $event)\">\n    <div class=\"side-menu\" v-if=\"open\">\n      <MenuButton :close=\"open && rendered\" :back=\"back\" @action=\"$emit('back', $event)\" />\n      <MenuButton class=\"full-close\" v-if=\"open && back\" :close=\"true\" @action=\"$emit('close', $event)\" />\n      <div class=\"title\">{{ title }}</div>\n      <div class=\"content\">\n        <slot />\n      </div>\n    </div>\n  </Transition>\n</template>\n\n<script>\nimport MenuButton from \"@/components/ControlBar/MenuButton\";\n\nexport default {\n  name: \"SideMenu\",\n  components: {MenuButton},\n  props: {\n    title: {\n      type: String,\n      default: \"Menu\"\n    },\n    open: {\n      type: Boolean,\n      default: true\n    },\n    back: Boolean\n  },\n  data() {\n    return {\n      rendered: false\n    }\n  },\n  methods: {\n    async buttonEnterAnimation() {\n      this.rendered = false;\n      await this.$nextTick();\n      await this.$nextTick();\n      this.rendered = true;\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import \"~@/scss/variables.scss\";\n\n.side-menu {\n  position: fixed;\n  top: 0;\n  left: 0;\n\n  overflow: hidden;\n\n  pointer-events: auto;\n\n  width: 100%;\n  max-width: 20em;\n  height: 100%;\n\n  filter: drop-shadow(1px 1px 3px #0008);\n\n  background-color: var(--theme-bg);\n  color: var(--theme-fg);\n\n  &-enter-active, &-leave-active {\n    transition: opacity 0.3s;\n  }\n\n  &-enter, &-leave-to {\n    opacity: 0;\n    pointer-events: none;\n\n    * {\n      pointer-events: none !important;\n    }\n  }\n\n  > .menu-button {\n    position: absolute;\n    top: 0;\n    left: 0;\n\n    margin: 0.5em;\n\n    @media (max-width: $mobile-break) {\n      margin: 0;\n    }\n\n    &.full-close {\n      right: 0;\n      left: unset;\n    }\n  }\n\n  > .title {\n    line-height: 2em;\n    text-align: center;\n\n    background-color: inherit;\n    border-bottom: solid 1px var(--theme-bg-hover);\n\n    padding: 0.5em;\n    @media (max-width: $mobile-break) {\n      padding: 0;\n    }\n  }\n\n  > .content {\n    position: relative;\n\n    overflow-y: auto;\n    overflow-x: hidden;\n\n    padding: 0.5em;\n\n    height: calc(100% - 4em - 1px);\n    @media (max-width: $mobile-break) {\n      height: calc(100% - 3em - 1px);\n    }\n\n    hr {\n      border: none;\n      border-bottom: solid 2px var(--theme-bg-hover);\n      margin: 0.5em 0;\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SideMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SideMenu.vue?vue&type=template&id=aa1fb0b2&\"\nimport script from \"./SideMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./SideMenu.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SideMenu.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"simple-button\",class:{active: _vm.active},on:{\"click\":function($event){return _vm.$emit('action')}}},[_c('div',{staticClass:\"label\"},[_vm._t(\"default\")],2),(_vm.submenu)?_c('div',{staticClass:\"submenu-icon\"},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"}}),_c('path',{attrs:{\"d\":\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"}})])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"simple-button\" :class=\"{active: active}\" @click=\"$emit('action')\">\n  <div class=\"label\"><slot /></div>\n  <div class=\"submenu-icon\" v-if=\"submenu\">\n    <svg viewBox=\"0 0 30 30\">\n      <path d=\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"/>\n      <path d=\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"/>\n    </svg>\n  </div>\n</div>\n</template>\n\n<script>\nexport default {\n  name: \"SimpleButton\",\n  props: {\n    submenu: Boolean,\n    active: {\n      type: Boolean,\n      default: false,\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n.side-menu .simple-button {\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  line-height: 2em;\n\n  padding: 0 0.5em;\n\n  > .label {\n    flex-grow: 1;\n\n    white-space: nowrap;\n    overflow-x: hidden;\n    text-overflow: ellipsis;\n  }\n\n  &:hover {\n    background-color: var(--theme-bg-hover);\n  }\n\n  &.active {\n    background-color: var(--theme-bg-light);\n  }\n\n  > .submenu-icon {\n    width: 2em;\n    height: 2em;\n\n    flex-shrink: 0;\n\n    margin-right: -0.5em;\n\n    > svg {\n      fill: var(--theme-fg-light);\n\n      path:nth-child(1) {\n        transform-origin: 15px 9px;\n        transform: translate(0, 10px) rotate(-30deg);\n      }\n      path:nth-child(2) {\n        transform-origin: 15px 21px;\n        transform: translate(0, -10px) rotate(30deg);\n      }\n\n      transform: scale(0.75);\n    }\n  }\n\n  &:active {\n    background-color: var(--theme-fg-light);\n    color: var(--theme-bg);\n\n\n    > .submenu-icon > svg {\n      fill: var(--theme-bg-light);\n    }\n  }\n}\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SimpleButton.vue?vue&type=template&id=500e3b38&\"\nimport script from \"./SimpleButton.vue?vue&type=script&lang=js&\"\nexport * from \"./SimpleButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SimpleButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Group',{attrs:{\"title\":_vm.$t('controls.title')}},[_c('SimpleButton',{attrs:{\"active\":_vm.appState.controls.state === 'perspective'},on:{\"action\":function($event){return _vm.$bluemap.setPerspectiveView(500, _vm.appState.controls.state === 'free' ? 100 : 0)}}},[_vm._v(_vm._s(_vm.$t('controls.perspective.button')))]),_c('SimpleButton',{attrs:{\"active\":_vm.appState.controls.state === 'flat'},on:{\"action\":function($event){return _vm.$bluemap.setFlatView(500, _vm.appState.controls.state === 'free' ? 100 : 0)}}},[_vm._v(_vm._s(_vm.$t('controls.flatView.button')))]),_c('SimpleButton',{attrs:{\"active\":_vm.appState.controls.state === 'free'},on:{\"action\":function($event){return _vm.$bluemap.setFreeFlight(500)}}},[_vm._v(_vm._s(_vm.$t('controls.freeFlight.button')))])],1),_c('Group',{attrs:{\"title\":_vm.$t('lighting.title')}},[_c('Slider',{attrs:{\"value\":_vm.mapViewer.uniforms.sunlightStrength.value,\"min\":0,\"max\":1,\"step\":0.01},on:{\"update\":function($event){_vm.mapViewer.uniforms.sunlightStrength.value = $event}}},[_vm._v(_vm._s(_vm.$t('lighting.sunlight')))]),_c('Slider',{attrs:{\"value\":_vm.mapViewer.uniforms.ambientLight.value,\"min\":0,\"max\":1,\"step\":0.01},on:{\"update\":function($event){_vm.mapViewer.uniforms.ambientLight.value = $event}}},[_vm._v(_vm._s(_vm.$t('lighting.ambientLight')))])],1),_c('Group',{attrs:{\"title\":_vm.$t('resolution.title')}},_vm._l((_vm.qualityStages),function(stage){return _c('SimpleButton',{key:stage.name,attrs:{\"active\":_vm.mapViewer.superSampling === stage.value},on:{\"action\":function($event){_vm.$bluemap.mapViewer.superSampling = stage.value; _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(stage.name))])}),1),_c('Group',{attrs:{\"title\":_vm.$t('renderDistance.title')}},[_c('Slider',{attrs:{\"value\":_vm.mapViewer.loadedHiresViewDistance,\"min\":_vm.settings.hiresSliderMin,\"max\":_vm.settings.hiresSliderMax,\"step\":10,\"formatter\":_vm.renderDistanceFormatter},on:{\"update\":function($event){_vm.mapViewer.loadedHiresViewDistance = $event; _vm.$bluemap.mapViewer.updateLoadedMapArea()},\"lazy\":function($event){return _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"renderDistance.hiresLayer\")))]),_c('Slider',{attrs:{\"value\":_vm.mapViewer.loadedLowresViewDistance,\"min\":_vm.settings.lowresSliderMin,\"max\":_vm.settings.lowresSliderMax,\"step\":100},on:{\"update\":function($event){_vm.mapViewer.loadedLowresViewDistance = $event; _vm.$bluemap.mapViewer.updateLoadedMapArea()},\"lazy\":function($event){return _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"renderDistance.lowersLayer\")))]),_c('SwitchButton',{attrs:{\"on\":!_vm.appState.controls.pauseTileLoading},on:{\"action\":function($event){_vm.appState.controls.pauseTileLoading = !_vm.appState.controls.pauseTileLoading; _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"renderDistance.loadHiresWhileMoving\")))])],1),_c('Group',{attrs:{\"title\":_vm.$t('freeFlightControls.title')}},[_c('Slider',{attrs:{\"value\":_vm.appState.controls.mouseSensitivity,\"min\":0.1,\"max\":5,\"step\":0.05},on:{\"update\":function($event){_vm.appState.controls.mouseSensitivity = $event; _vm.$bluemap.updateControlsSettings();},\"lazy\":function($event){return _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"freeFlightControls.mouseSensitivity\")))]),_c('SwitchButton',{attrs:{\"on\":_vm.appState.controls.invertMouse},on:{\"action\":function($event){_vm.appState.controls.invertMouse = !_vm.appState.controls.invertMouse; _vm.$bluemap.updateControlsSettings(); _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"freeFlightControls.invertMouseY\")))])],1),_c('Group',{attrs:{\"title\":_vm.$t('theme.title')}},_vm._l((_vm.themes),function(theme){return _c('SimpleButton',{key:theme.name,attrs:{\"active\":_vm.appState.theme === theme.value},on:{\"action\":function($event){_vm.$bluemap.setTheme(theme.value); _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(theme.name))])}),1),_c('Group',{attrs:{\"title\":_vm.$t('screenshot.title')}},[_c('SwitchButton',{attrs:{\"on\":_vm.appState.screenshot.clipboard},on:{\"action\":function($event){_vm.appState.screenshot.clipboard = !_vm.appState.screenshot.clipboard; _vm.$bluemap.saveUserSettings()}}},[_vm._v(_vm._s(_vm.$t(\"screenshot.clipboard\")))])],1),(_vm.$i18n.languages.length > 1)?_c('Group',{attrs:{\"title\":_vm.$t('language.title')}},_vm._l((_vm.$i18n.languages),function(lang){return _c('SimpleButton',{key:lang.locale,attrs:{\"active\":lang.locale === _vm.$i18n.locale},on:{\"action\":function($event){_vm.$i18n.setLanguage(lang.locale); _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(lang.name))])}),1):_vm._e(),_c('SwitchButton',{attrs:{\"on\":_vm.appState.debug},on:{\"action\":function($event){_vm.switchDebug(); _vm.$bluemap.saveUserSettings();}}},[_vm._v(_vm._s(_vm.$t(\"debug.button\")))]),_c('SimpleButton',{on:{\"action\":function($event){return _vm.$bluemap.resetSettings()}}},[_vm._v(_vm._s(_vm.$t(\"resetAllSettings.button\")))])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"group\"},[_c('span',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.title))]),_c('div',{staticClass:\"content\"},[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"group\">\n    <span class=\"title\">{{ title }}</span>\n    <div class=\"content\">\n      <slot/>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"Group\",\n  props: {\n    title: String\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .group {\n  position: relative;\n  margin: 2em 0 1em;\n  padding-top: 1em;\n  border: solid 2px var(--theme-bg-hover);\n\n\n  > .title {\n    position: absolute;\n    top: calc(-0.5em - 1px);\n    right: 0.5em;\n    padding: 0 0.5em;\n    background-color: var(--theme-bg);\n  }\n\n  &:first-child {\n    margin-top: 1em;\n  }\n\n  > .content {\n    max-height: 15em;\n    overflow-y: auto;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Group.vue?vue&type=template&id=7490aab8&\"\nimport script from \"./Group.vue?vue&type=script&lang=js&\"\nexport * from \"./Group.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Group.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"slider\"},[_c('div',{staticClass:\"label\"},[_vm._t(\"default\"),_vm._v(\": \"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.formatter(_vm.value)))])],2),_c('label',[_c('input',{attrs:{\"type\":\"range\",\"min\":_vm.min,\"max\":_vm.max,\"step\":_vm.step},domProps:{\"value\":_vm.value},on:{\"input\":function($event){_vm.$emit('update', parseFloat($event.target.value))},\"change\":function($event){_vm.$emit('lazy', parseFloat($event.target.value))}}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"slider\">\n  <div class=\"label\"><slot />: <span class=\"value\">{{formatter(value)}}</span></div>\n  <label>\n    <input type=\"range\" :min=\"min\" :max=\"max\" :step=\"step\" :value=\"value\" @input=\"$emit('update', parseFloat($event.target.value))\" @change=\"$emit('lazy', parseFloat($event.target.value))\">\n  </label>\n</div>\n</template>\n\n<script>\n\nfunction countDecimals(value) {\n  if(Math.floor(value) === value) return 0;\n  return value.toString().split(\".\")[1].length || 0;\n}\n\nexport default {\n  name: \"Slider\",\n  props: {\n    value: Number,\n    min: Number,\n    max: Number,\n    step: Number,\n    formatter: {\n      type: Function,\n      default: function(value) {\n        return parseFloat(value).toFixed(countDecimals(this.step));\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .slider {\n  line-height: 2em;\n  padding: 0 0.5em;\n\n  &:hover {\n    background-color: var(--theme-bg-hover);\n  }\n\n  > .label {\n    > .value {\n      float: right;\n    }\n  }\n\n  > label {\n    > input {\n      appearance: none;\n      -moz-appearance: none;\n      -webkit-appearance: none;\n      outline: none;\n\n      width: 100%;\n      height: 1em;\n\n      border-radius: 1em;\n      //border: solid 0.125em var(--theme-fg-light);\n\n      overflow: hidden;\n      background-color: var(--theme-bg-light);\n\n      &::-webkit-slider-thumb {\n        appearance: none;\n        -moz-appearance: none;\n        -webkit-appearance: none;\n        outline: none;\n\n        width: 1em;\n        height: 1em;\n\n        border-radius: 1em;\n        border: solid 0.125em var(--theme-bg-light);\n\n        background-color: var(--theme-bg);\n\n        //box-shadow: calc(-100vw - 0.375em) 0 0 100vw var(--theme-switch-button-on);\n      }\n\n      &::-moz-range-thumb {\n        width: 0.75em;\n        height: 0.75em;\n\n        border-radius: 0.75em;\n        border: solid 0.125em var(--theme-bg-light);\n\n        background-color: var(--theme-bg);\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Slider.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Slider.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Slider.vue?vue&type=template&id=3f547a48&\"\nimport script from \"./Slider.vue?vue&type=script&lang=js&\"\nexport * from \"./Slider.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Slider.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"switch-button\",on:{\"click\":function($event){return _vm.$emit('action')}}},[_c('div',{staticClass:\"label\"},[_vm._t(\"default\")],2),_c('SwitchHandle',{attrs:{\"on\":_vm.on}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"switch\",class:{on: _vm.on}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"switch\" :class=\"{on: on}\"></div>\n</template>\n\n<script>\nexport default {\n  name: \"SwitchHandle\",\n  props: {\n    on: Boolean\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .switch {\n  height: 1em;\n  width: 2em;\n\n  border-radius: 1em;\n  background-color: var(--theme-bg-light);\n\n  transition: background-color 0.3s;\n\n  &::after {\n    content: \"\";\n    display: block;\n    width: 0.75em;\n    height: 0.75em;\n    border-radius: 100%;\n\n    background-color: var(--theme-bg);\n\n    position: relative;\n    top: 0.125em;\n    left: 0.125em;\n\n    transition: left 0.3s;\n  }\n\n  &.on {\n    background-color: var(--theme-switch-button-on);\n\n    &::after {\n      left: 1.125em;\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchHandle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchHandle.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SwitchHandle.vue?vue&type=template&id=3812a029&\"\nimport script from \"./SwitchHandle.vue?vue&type=script&lang=js&\"\nexport * from \"./SwitchHandle.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SwitchHandle.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n<div class=\"switch-button\" @click=\"$emit('action')\">\n  <div class=\"label\"><slot /></div>\n  <SwitchHandle :on=\"on\" />\n</div>\n</template>\n\n<script>\nimport SwitchHandle from \"@/components/Menu/SwitchHandle\";\nexport default {\n  name: \"SwitchButton\",\n  components: {SwitchHandle},\n  props: {\n    on: Boolean\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n.side-menu .switch-button {\n  cursor: pointer;\n  user-select: none;\n  display: flex;\n  line-height: 2em;\n\n  padding: 0 0.5em;\n\n  > .label {\n    flex-grow: 1;\n\n    white-space: nowrap;\n    overflow-x: hidden;\n    text-overflow: ellipsis;\n  }\n\n  > .switch {\n    margin: 0.5em 0;\n  }\n\n  &:hover {\n    background-color: var(--theme-bg-hover);\n  }\n}\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SwitchButton.vue?vue&type=template&id=618b8d4f&\"\nimport script from \"./SwitchButton.vue?vue&type=script&lang=js&\"\nexport * from \"./SwitchButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SwitchButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n\tpageTitle: \"BlueMap - {map}\",\n\tmenu: {\n\t\ttitle: \"Menu\",\n\t\ttooltip: \"Menu\"\n\t},\n\tmaps: {\n\t\ttitle: \"Maps\",\n\t\tbutton: \"Maps\",\n\t\ttooltip: \"Map-List\"\n\t},\n\tmarkers: {\n\t\ttitle: \"Markers\",\n\t\tbutton: \"Markers\",\n\t\ttooltip: \"Marker-List\",\n\t\tmarker: \"marker | markers\",\n\t\tmarkerSet: \"marker-set | marker-sets\",\n\t\tsearchPlaceholder: \"Search...\",\n\t\tfollowPlayerTitle: \"Follow Player\"\n\t},\n\tsettings: {\n\t\ttitle: \"Settings\",\n\t\tbutton: \"Settings\"\n\t},\n\tgoFullscreen: {\n\t\tbutton: \"Go Fullscreen\"\n\t},\n\tresetCamera: {\n\t\tbutton: \"Reset Camera\",\n\t\ttooltip: \"Reset Camera & Position\"\n\t},\n\tupdateMap: {\n\t\tbutton: \"Update Map\",\n\t\ttooltip: \"Clear Tile Cache\"\n\t},\n\tlighting: {\n\t\ttitle: \"Lighting\",\n\t\tdayNightSwitch: {\n\t\t\ttooltip: \"Day/Night\"\n\t\t},\n\t\tsunlight: \"Sunlight\",\n\t\tambientLight: \"Ambient-Light\"\n\t},\n\tresolution: {\n\t\ttitle: \"Resolution\",\n\t\thigh: \"High (SSAA, x2)\",\n\t\tnormal: \"Normal (Native, x1)\",\n\t\tlow: \"Low (Upscaling, x0.5)\"\n\t},\n\tfreeFlightControls: {\n\t\ttitle: \"Free-Flight Controls\",\n\t\tmouseSensitivity: \"Mouse-Sensitivity\",\n\t\tinvertMouseY: \"Invert Mouse Y\"\n\t},\n\trenderDistance: {\n\t\ttitle: \"Render Distance\",\n\t\thiresLayer: \"Hires layer\",\n\t\tlowersLayer: \"Lowres layer\",\n\t\tloadHiresWhileMoving: \"Load hires-tiles while moving\",\n\t\toff: \"Off\"\n\t},\n\ttheme: {\n\t\ttitle: \"Theme\",\n\t\tdefault: \"Default (System/Browser)\",\n\t\tdark: \"Dark\",\n\t\tlight: \"Light\",\n\t\tcontrast: \"Contrast\"\n\t},\n\tdebug: {\n\t\tbutton: \"Debug\"\n\t},\n\tresetAllSettings: {\n\t\tbutton: \"Reset All Settings\"\n\t},\n\tplayers: {\n\t\ttitle: \"Players\",\n\t\ttooltip: \"Player-List\"\n\t},\n\tcompass: {\n\t\ttooltip: \"Compass / Face North\"\n\t},\n\tscreenshot: {\n\t\ttitle: \"Screenshot\",\n\t\tbutton: \"Take Screenshot\",\n    clipboard: \"Copy to Clipboard\"\n\t},\n\tcontrols: {\n\t\ttitle: \"View / Controls\",\n\t\tperspective: {\n\t\t\tbutton: \"Perspective\",\n\t\t\ttooltip: \"Perspective-View\"\n\t\t},\n\t\tflatView: {\n\t\t\tbutton: \"Flat\",\n\t\t\ttooltip: \"Orthographic / Flat-View\",\n\t\t},\n\t\tfreeFlight: {\n\t\t\tbutton: \"Free-Flight\",\n\t\t\ttooltip: \"Free-Flight / Spectator Mode\"\n\t\t}\n\t},\n\tlanguage: {\n\t\ttitle: \"Language\",\n\t},\n\tblockTooltip: {\n\t\tblock: \"Block\",\n\t\tposition: \"Position\",\n\t\tchunk: \"Chunk\",\n\t\tregion: {\n\t\t\tregion: \"Region\",\n\t\t\tfile: \"File\"\n\t\t},\n\t\tlight: {\n\t\t\tlight: \"Light\",\n\t\t\tsun: \"Sun\",\n\t\t\tblock: \"Block\",\n\t\t}\n\t},\n\tinfo: {\n\t\ttitle: \"Info\",\n\t\tbutton: \"Info\",\n\t\tcontent: `\n<img src=\"assets/logo.png\" style=\"display: block; width: 40%; margin: 3em auto; border-radius: 50%\">\n<p>\n\t<h2>Mouse-Controls:</h2>\n\t<table>\n\t\t<tr><th>move</th><td><kbd>left-click</kbd> + drag</td></tr>\n\t\t<tr><th>zoom</th><td><kbd>mousewheel</kbd> (scroll)</td></tr>\n\t\t<tr><th>rotate / tilt</th><td><kbd>right-click</kbd> + drag</td></tr>\n\t</table>\n</p>\n<p>\n\t<h2>Keyboard-Controls:</h2>\n\t<table>\n\t\t<tr><th>move</th><td><kbd>wasd</kbd> / <kbd>arrow-keys</kbd></td></tr>\n\t\t<tr><th>zoom</th><td>Numpad: <kbd>+</kbd>/<kbd>-</kbd> or <kbd>Ins</kbd>/<kbd>Home</kbd></td></tr>\n\t\t<tr><th>rotate / tilt</th><td><kbd>Left-Alt</kbd> + <kbd>wasd</kbd> / <kbd>arrow-keys</kbd> or <kbd>Delete</kbd>/<kbd>End</kbd>/<kbd>Page Up</kbd>/<kbd>Page Down</kbd></td></tr>\n\t</table>\n</p>\n<p>\n\t<h2>Touch-Controls:</h2>\n\t<table>\n\t\t<tr><th>move</th><td>touch + drag</td></tr>\n\t\t<tr><th>zoom</th><td>touch with two fingers + pinch</td></tr>\n\t\t<tr><th>rotate / tilt</th><td>touch with two fingers + rotate / move up/down</td></tr>\n\t</table>\n</p>\n<br><hr>\n<p class=\"info-footer\">\n\tThis map has been generated with &#9829; using <a href=\"https://bluecolo.red/bluemap\">BlueMap</a> {version}\n</p>\n\t\t`\n\t}\n};\n","import VueI18n from 'vue-i18n';\nimport Vue from 'vue';\nimport fallback from './fallback';\n\nVueI18n.prototype.setLanguage = async function(lang) {\n\ttry {\n\t\tif (!this.messages[lang]){\n\t\t\tlet messages = {};\n\t\t\tmessages = (await import(/* webpackIgnore: true */ `../lang/${lang}.js`)).default;\n\n\t\t\tthis.setLocaleMessage(lang, messages);\n\t\t}\n\n\t\tthis.locale = lang;\n\t\tdocument.querySelector('html').setAttribute('lang', lang);\n\t} catch (e) {\n\t\tconsole.error(`Failed to load language '${lang}'!`, e);\n\t}\n}\n\nVueI18n.prototype.loadLanguageSettings = async function() {\n\tlet settings = (await import(/* webpackIgnore: true */ \"../lang/settings.js\")).default;\n\tthis.languages = settings.languages;\n\tthis.setLanguage(settings.default);\n};\n\nVue.use(VueI18n);\n\nconst i18n = new VueI18n({\n\tlocale: 'fallback',\n\tfallbackLocale: 'fallback',\n\tsilentFallbackWarn: true,\n\tmessages: { fallback }\n});\n\nexport default i18n;\n","<template>\n  <div>\n    <Group :title=\"$t('controls.title')\">\n      <SimpleButton :active=\"appState.controls.state === 'perspective'\" @action=\"$bluemap.setPerspectiveView(500, appState.controls.state === 'free' ? 100 : 0)\">{{$t('controls.perspective.button')}}</SimpleButton>\n      <SimpleButton :active=\"appState.controls.state === 'flat'\" @action=\"$bluemap.setFlatView(500, appState.controls.state === 'free' ? 100 : 0)\">{{$t('controls.flatView.button')}}</SimpleButton>\n      <SimpleButton :active=\"appState.controls.state === 'free'\" @action=\"$bluemap.setFreeFlight(500)\">{{$t('controls.freeFlight.button')}}</SimpleButton>\n    </Group>\n\n    <Group :title=\"$t('lighting.title')\">\n      <Slider :value=\"mapViewer.uniforms.sunlightStrength.value\" :min=\"0\" :max=\"1\" :step=\"0.01\"\n              @update=\"mapViewer.uniforms.sunlightStrength.value = $event\">{{$t('lighting.sunlight')}}</Slider>\n      <Slider :value=\"mapViewer.uniforms.ambientLight.value\" :min=\"0\" :max=\"1\" :step=\"0.01\"\n              @update=\"mapViewer.uniforms.ambientLight.value = $event\">{{$t('lighting.ambientLight')}}</Slider>\n    </Group>\n\n    <Group :title=\"$t('resolution.title')\">\n      <SimpleButton v-for=\"stage of qualityStages\" :key=\"stage.name\"\n                    :active=\"mapViewer.superSampling === stage.value\"\n                    @action=\"$bluemap.mapViewer.superSampling = stage.value; $bluemap.saveUserSettings();\"\n      >{{stage.name}}</SimpleButton>\n    </Group>\n\n    <Group :title=\"$t('renderDistance.title')\">\n      <Slider :value=\"mapViewer.loadedHiresViewDistance\" :min=\"settings.hiresSliderMin\" :max=\"settings.hiresSliderMax\" :step=\"10\" :formatter=\"renderDistanceFormatter\"\n              @update=\"mapViewer.loadedHiresViewDistance = $event; $bluemap.mapViewer.updateLoadedMapArea()\" @lazy=\"$bluemap.saveUserSettings()\">{{ $t(\"renderDistance.hiresLayer\") }}</Slider>\n      <Slider :value=\"mapViewer.loadedLowresViewDistance\" :min=\"settings.lowresSliderMin\" :max=\"settings.lowresSliderMax\" :step=\"100\"\n              @update=\"mapViewer.loadedLowresViewDistance = $event; $bluemap.mapViewer.updateLoadedMapArea()\" @lazy=\"$bluemap.saveUserSettings()\">{{ $t(\"renderDistance.lowersLayer\") }}</Slider>\n      <SwitchButton :on=\"!appState.controls.pauseTileLoading\" @action=\"appState.controls.pauseTileLoading = !appState.controls.pauseTileLoading; $bluemap.saveUserSettings()\">{{ $t(\"renderDistance.loadHiresWhileMoving\") }}</SwitchButton>\n    </Group>\n\n    <Group :title=\"$t('freeFlightControls.title')\">\n      <Slider :value=\"appState.controls.mouseSensitivity\" :min=\"0.1\" :max=\"5\" :step=\"0.05\"\n              @update=\"appState.controls.mouseSensitivity = $event; $bluemap.updateControlsSettings();\" @lazy=\"$bluemap.saveUserSettings()\">{{ $t(\"freeFlightControls.mouseSensitivity\") }}</Slider>\n      <SwitchButton :on=\"appState.controls.invertMouse\" @action=\"appState.controls.invertMouse = !appState.controls.invertMouse; $bluemap.updateControlsSettings(); $bluemap.saveUserSettings()\">{{ $t(\"freeFlightControls.invertMouseY\") }}</SwitchButton>\n    </Group>\n\n    <Group :title=\"$t('theme.title')\">\n      <SimpleButton v-for=\"theme of themes\" :key=\"theme.name\"\n                    :active=\"appState.theme === theme.value\"\n                    @action=\"$bluemap.setTheme(theme.value); $bluemap.saveUserSettings();\"\n      >{{theme.name}}</SimpleButton>\n    </Group>\n\n    <Group :title=\"$t('screenshot.title')\">\n      <SwitchButton :on=\"appState.screenshot.clipboard\" @action=\"appState.screenshot.clipboard = !appState.screenshot.clipboard; $bluemap.saveUserSettings()\">{{ $t(\"screenshot.clipboard\") }}</SwitchButton>\n    </Group>\n\n    <Group v-if=\"$i18n.languages.length > 1\" :title=\"$t('language.title')\">\n      <SimpleButton v-for=\"lang of $i18n.languages\" :key=\"lang.locale\"\n                    :active=\"lang.locale === $i18n.locale\"\n                    @action=\"$i18n.setLanguage(lang.locale); $bluemap.saveUserSettings();\"\n      >{{lang.name}}</SimpleButton>\n    </Group>\n\n    <SwitchButton :on=\"appState.debug\" @action=\"switchDebug(); $bluemap.saveUserSettings();\">{{ $t(\"debug.button\") }}</SwitchButton>\n\n    <SimpleButton @action=\"$bluemap.resetSettings()\">{{ $t(\"resetAllSettings.button\") }}</SimpleButton>\n  </div>\n</template>\n\n<script>\nimport Group from \"@/components/Menu/Group\";\nimport SimpleButton from \"@/components/Menu/SimpleButton\";\nimport Slider from \"@/components/Menu/Slider\";\nimport SwitchButton from \"@/components/Menu/SwitchButton\";\nimport i18n from \"../../i18n\";\n\nconst themes = [\n  {get name(){ return i18n.t(\"theme.default\")}, value: null},\n  {get name(){ return i18n.t(\"theme.dark\")}, value: 'dark'},\n  {get name(){ return i18n.t(\"theme.light\")}, value: 'light'},\n  {get name(){ return i18n.t(\"theme.contrast\")}, value: 'contrast'},\n];\n\nconst qualityStages = [\n  {get name(){ return i18n.t(\"resolution.high\")}, value: 2},\n  {get name(){ return i18n.t(\"resolution.normal\")}, value: 1},\n  {get name(){ return i18n.t(\"resolution.low\")}, value: 0.5},\n];\n\nexport default {\nname: \"SettingsMenu\",\n  components: {SwitchButton, Slider, SimpleButton, Group},\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n      mapViewer: this.$bluemap.mapViewer.data,\n      settings: {\n        ...{\n          hiresSliderMax: 500,\n          hiresSliderMin: 50,\n          lowresSliderMax: 10000,\n          lowresSliderMin: 500\n        },\n        ...this.$bluemap.settings\n      },\n\n      qualityStages: qualityStages,\n      themes: themes,\n    }\n  },\n  methods: {\n    switchDebug() {\n      this.$bluemap.setDebug(!this.appState.debug);\n    },\n    renderDistanceFormatter(value) {\n      let f = parseFloat(value);\n      return f === 0 ? this.$t(\"renderDistance.off\") : f.toFixed(0);\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SettingsMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SettingsMenu.vue?vue&type=template&id=f1a78d74&\"\nimport script from \"./SettingsMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./SettingsMenu.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport i18n from \"../i18n\";\n\nexport class MainMenu {\n\n    static NULL_PAGE = {\n        id: \"-\",\n        title: \"-\"\n    }\n\n    constructor() {\n        this.isOpen = false;\n        this.pageStack = [];\n    }\n\n    currentPage() {\n        if (this.pageStack.length === 0) return MainMenu.NULL_PAGE;\n        return this.pageStack[this.pageStack.length - 1];\n    }\n\n    openPage(id = \"root\", title = () => i18n.t(\"menu.title\"), data = {}) {\n        if (!this.isOpen){\n            this.pageStack.splice(0, this.pageStack.length);\n            this.isOpen = true;\n        }\n\n        if (typeof title === \"function\"){\n            this.pageStack.push({\n                id: id,\n                get title(){ return title() },\n                ...data\n            });\n        } else {\n            this.pageStack.push({\n                id: id,\n                title: title,\n                ...data\n            });\n        }\n\n    }\n\n    closePage() {\n        this.pageStack.splice(this.pageStack.length - 1, 1);\n\n        if (this.pageStack.length < 1) {\n            this.isOpen = false\n        }\n    }\n\n    reOpenPage() {\n        if (this.pageStack.length === 0){\n            this.openPage();\n        } else if (this.pageStack[0].id !== 'root') {\n            this.pageStack.splice(0, this.pageStack.length);\n            this.openPage();\n        } else {\n            this.isOpen = true;\n        }\n    }\n\n    closeAll() {\n        this.isOpen = false;\n    }\n\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"marker-sets\"},_vm._l((_vm.filteredMarkerSets),function(markerSet){return _c('MarkerSet',{key:markerSet.id,attrs:{\"marker-set\":markerSet},on:{\"more\":function($event){return _vm.openMore(markerSet)}}})}),1),(_vm.filteredMarkerSets.length > 0 & _vm.thisMarkerSet.markers.length > 0)?_c('hr'):_vm._e(),(_vm.thisMarkerSet.markers.length > 0)?_c('div',{staticClass:\"markers\"},[_c('TextInput',{attrs:{\"value\":_vm.filter.search,\"placeholder\":_vm.$t('markers.searchPlaceholder')},on:{\"input\":function($event){_vm.filter.search = $event.target.value}}}),_vm._l((_vm.filteredMarkers),function(marker){return _c('MarkerItem',{key:marker.id,attrs:{\"marker\":marker}})})],2):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"marker-item\",class:{'marker-hidden': !_vm.marker.visible}},[_c('div',{staticClass:\"marker-button\",attrs:{\"title\":_vm.marker.id},on:{\"click\":function($event){return _vm.click(false)}}},[(_vm.marker.type === 'player')?_c('div',{staticClass:\"icon\"},[_c('img',{attrs:{\"src\":'assets/playerheads/' + _vm.marker.playerUuid + '.png',\"alt\":\"playerhead\"},on:{\"error\":_vm.steve}})]):_vm._e(),_c('div',{staticClass:\"info\"},[_c('div',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.markerLabel))]),_c('div',{staticClass:\"stats\"},[(_vm.appState.debug)?_c('div',[_vm._v(\" \"+_vm._s(_vm.marker.type)+\"-marker \")]):_vm._e(),_c('div',[_vm._v(\" (\"+_vm._s(_vm._f(\"position\")(_vm.marker.position.x))+\" | \"+_vm._s(_vm._f(\"position\")(_vm.marker.position.y))+\" | \"+_vm._s(_vm._f(\"position\")(_vm.marker.position.z))+\") \")])])])]),(_vm.marker.type === 'player')?_c('div',{staticClass:\"follow-player-button\",class:{active: _vm.controls.controls.followingPlayer && _vm.controls.controls.followingPlayer.id === _vm.marker.id},attrs:{\"title\":_vm.$t('markers.followPlayerTitle')},on:{\"click\":function($event){return _vm.click(true)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('circle',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"cx\":\"15\",\"cy\":\"15\",\"r\":\"10.375\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"3.25\",\"y1\":\"15\",\"x2\":\"1.063\",\"y2\":\"15\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"15\",\"y1\":\"26.75\",\"x2\":\"15\",\"y2\":\"28.938\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"26.75\",\"y1\":\"15\",\"x2\":\"28.938\",\"y2\":\"15\"}}),_c('line',{attrs:{\"fill\":\"none\",\"stroke-width\":\"3\",\"stroke-miterlimit\":\"10\",\"x1\":\"15\",\"y1\":\"3.25\",\"x2\":\"15\",\"y2\":\"1.063\"}}),_c('circle',{attrs:{\"stroke\":\"none\",\"cx\":\"15\",\"cy\":\"15\",\"r\":\"6.042\"}})])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"marker-item\" :class=\"{'marker-hidden': !marker.visible}\">\n    <div class=\"marker-button\" :title=\"marker.id\" @click=\"click(false)\">\n      <div class=\"icon\" v-if=\"marker.type === 'player'\">\n        <img :src=\"'assets/playerheads/' + marker.playerUuid + '.png'\" alt=\"playerhead\" @error=\"steve\">\n      </div>\n      <div class=\"info\">\n        <div class=\"label\">{{markerLabel}}</div>\n        <div class=\"stats\">\n          <div v-if=\"appState.debug\">\n            {{marker.type}}-marker\n          </div>\n          <div>\n            ({{marker.position.x | position}} | {{marker.position.y | position}} | {{marker.position.z | position}})\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"follow-player-button\" :class=\"{active: controls.controls.followingPlayer && controls.controls.followingPlayer.id === marker.id}\"\n         v-if=\"marker.type === 'player'\" @click=\"click(true)\" :title=\"$t('markers.followPlayerTitle')\">\n      <svg viewBox=\"0 0 30 30\">\n        <circle fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" cx=\"15\" cy=\"15\" r=\"10.375\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"3.25\" y1=\"15\" x2=\"1.063\" y2=\"15\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"15\" y1=\"26.75\" x2=\"15\" y2=\"28.938\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"26.75\" y1=\"15\" x2=\"28.938\" y2=\"15\"/>\n        <line fill=\"none\" stroke-width=\"3\" stroke-miterlimit=\"10\" x1=\"15\" y1=\"3.25\" x2=\"15\" y2=\"1.063\"/>\n        <circle stroke=\"none\" cx=\"15\" cy=\"15\" r=\"6.042\"/>\n      </svg>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"MarkerItem\",\n  props: {\n    marker: Object,\n  },\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n      controls: this.$bluemap.mapViewer.controlsManager.data,\n    }\n  },\n  computed: {\n    markerLabel() {\n      switch (this.marker.type) {\n        case \"player\" : return this.marker.name;\n        default : break;\n      }\n\n      if (this.marker.label){\n        let strippedLabel = /^(?:<[^>]*>\\s*)*([^<>]*\\S[^<>]*)(?:<|$)/gi.exec(this.marker.label);\n        if (strippedLabel && strippedLabel.length > 1) {\n          return strippedLabel[1];\n        }\n      }\n\n      return this.marker.id;\n    }\n  },\n  filters: {\n    position(v) {\n      return Math.floor(v);\n    }\n  },\n  methods: {\n    async click(follow) {\n      let cm = this.$bluemap.mapViewer.controlsManager;\n      \n      if (cm.controls && cm.controls.stopFollowingPlayerMarker) {\n        cm.controls.stopFollowingPlayerMarker();\n      }\n\n      if (this.marker.type === \"player\") {\n\n        if (this.marker.foreign) {\n          let matchingMap = await this.$bluemap.findPlayerMap(this.marker.playerUuid);\n          if (!matchingMap) return;\n\n          //this.$bluemap.appState.menu.closeAll();\n          await this.$bluemap.switchMap(matchingMap.data.id);\n        }\n\n        if (follow && cm.controls && cm.controls.followPlayerMarker && this.marker.visible) {\n          cm.controls.followPlayerMarker(this.marker);\n        }\n\n      } else if (!this.marker.visible) {\n        return;\n      }\n\n      cm.position.copy(this.marker.position);\n    },\n    steve(event) {\n      event.target.src = \"assets/steve.png\";\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import \"~@/scss/variables.scss\";\n\n.side-menu .marker-item {\n  display: flex;\n\n  margin: 0.5em 0;\n  &:first-child {\n    margin-top: 0;\n  }\n  &:last-child {\n    margin-bottom: 0;\n  }\n\n  white-space: nowrap;\n  user-select: none;\n\n  &.marker-hidden {\n    opacity: 0.5;\n    filter: grayscale(1);\n  }\n\n  .marker-button {\n    display: flex;\n    flex-grow: 1;\n    cursor: pointer;\n\n    &:hover {\n      background-color: var(--theme-bg-hover);\n    }\n\n    > .info {\n      position: relative;\n      flex-grow: 1;\n      overflow-x: hidden;\n      text-overflow: ellipsis;\n\n      .label {\n        line-height: 2em;\n        overflow-x: hidden;\n        text-overflow: ellipsis;\n        margin: 0 0.5em 1.5em 0.5em;\n      }\n\n      .stats {\n        display: flex;\n        margin: 0 0.5em;\n\n        position: absolute;\n        bottom: 0;\n\n        font-size: 0.8em;\n        line-height: 2em;\n        color: var(--theme-fg-light);\n\n        > div {\n          &:not(:first-child) {\n            margin-left: 0.5em;\n            padding-left: 0.5em;\n            border-left: solid 1px var(--theme-bg-hover);\n          }\n        }\n      }\n    }\n\n    > .icon {\n      height: 2.5em;\n      margin: 0.5em;\n      flex-shrink: 0;\n\n      img {\n        image-rendering: pixelated;\n        height: 100%;\n      }\n    }\n  }\n\n  > .follow-player-button {\n    width: 2em;\n    cursor: pointer;\n    background-color: var(--theme-bg);\n\n    &:hover, &.active {\n      background-color: var(--theme-bg-light);\n    }\n\n    > svg {\n      position: relative;\n      fill: var(--theme-fg-light);\n      stroke: var(--theme-fg-light);\n\n      top: 50%;\n      transform: translate(0, -50%) scale(0.75);\n    }\n\n    &:active {\n      background-color: var(--theme-fg-light);\n      color: var(--theme-bg);\n\n      > svg {\n        fill: var(--theme-bg-light);\n        stroke: var(--theme-bg-light);\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MarkerItem.vue?vue&type=template&id=ea7ab79a&\"\nimport script from \"./MarkerItem.vue?vue&type=script&lang=js&\"\nexport * from \"./MarkerItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MarkerItem.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{staticClass:\"text-input\",attrs:{\"type\":\"text\"},domProps:{\"value\":_vm.value},on:{\"input\":function($event){return _vm.$emit('input', $event)},\"keydown\":function($event){return $event.stopPropagation()}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <input class=\"text-input\" type=\"text\" :value=\"value\" @input=\"$emit('input', $event)\" @keydown=\"$event.stopPropagation()\">\n</template>\n\n<script>\nexport default {\n  name: \"TextInput\",\n  props: {\n    value: String\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .text-input {\n  background-color: var(--theme-bg-hover);\n  width: calc(100% - 1em);\n  padding: 0.5em;\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TextInput.vue?vue&type=template&id=13c3caa0&\"\nimport script from \"./TextInput.vue?vue&type=script&lang=js&\"\nexport * from \"./TextInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TextInput.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"marker-set\",attrs:{\"title\":_vm.markerSet.id}},[_c('div',{staticClass:\"info\",on:{\"click\":_vm.toggle}},[_c('div',{staticClass:\"marker-set-switch\"},[_c('div',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.label))]),(_vm.markerSet.toggleable)?_c('SwitchHandle',{attrs:{\"on\":_vm.markerSet.visible}}):_vm._e()],1),_c('div',{staticClass:\"stats\"},[_c('div',[_vm._v(\" \"+_vm._s(_vm.markerSet.markers.length)+\" \"+_vm._s(_vm.$tc('markers.marker', _vm.markerSet.markers.length))+\" \")]),(_vm.filteredMarkerSets.length > 0)?_c('div',[_vm._v(\" \"+_vm._s(_vm.filteredMarkerSets.length)+\" \"+_vm._s(_vm.$tc('markers.markerSet', _vm.filteredMarkerSets.length))+\" \")]):_vm._e()])]),_c('div',{staticClass:\"open-menu-button\",on:{\"click\":function($event){return _vm.$emit('more', $event)}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 30 30\"}},[_c('path',{attrs:{\"d\":\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"}}),_c('path',{attrs:{\"d\":\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\\n\\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"}})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"marker-set\" :title=\"markerSet.id\">\n    <div class=\"info\" @click=\"toggle\">\n      <div class=\"marker-set-switch\">\n        <div class=\"label\">{{ label }}</div>\n        <SwitchHandle :on=\"markerSet.visible\" v-if=\"markerSet.toggleable\"/>\n      </div>\n      <div class=\"stats\">\n        <div>\n          {{ markerSet.markers.length }}\n          {{ $tc('markers.marker', markerSet.markers.length) }}\n        </div>\n        <div v-if=\"filteredMarkerSets.length > 0\">\n          {{ filteredMarkerSets.length }}\n          {{ $tc('markers.markerSet', filteredMarkerSets.length) }}\n        </div>\n      </div>\n    </div>\n    <div class=\"open-menu-button\" @click=\"$emit('more', $event)\">\n      <svg viewBox=\"0 0 30 30\">\n        <path d=\"M25.004,9.294c0,0.806-0.75,1.46-1.676,1.46H6.671c-0.925,0-1.674-0.654-1.674-1.46l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,7.833,25.004,8.487,25.004,9.294L25.004,9.294z\"/>\n        <path d=\"M25.004,20.706c0,0.807-0.75,1.461-1.676,1.461H6.671c-0.925,0-1.674-0.654-1.674-1.461l0,0\n\tc0-0.807,0.749-1.461,1.674-1.461h16.657C24.254,19.245,25.004,19.899,25.004,20.706L25.004,20.706z\"/>\n      </svg>\n    </div>\n  </div>\n</template>\n\n<script>\nimport SwitchHandle from \"@/components/Menu/SwitchHandle\";\n\nexport default {\n  name: \"MarkerSet\",\n  components: {SwitchHandle},\n  props: {\n    markerSet: Object,\n  },\n  computed: {\n    filteredMarkerSets() {\n      return this.markerSet.markerSets.filter(markerSet => {\n        return (markerSet.id !== \"bm-popup-set\");\n      });\n    },\n    label() {\n      if (this.markerSet.id === \"bm-players\") return this.$t(\"players.title\");\n      return this.markerSet.label;\n    }\n  },\n  methods: {\n    toggle() {\n      if (this.markerSet.toggleable) {\n        this.markerSet.visible = !this.markerSet.visible\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .marker-set {\n  display: flex;\n  user-select: none;\n\n  line-height: 2em;\n\n  margin: 0.5em 0;\n\n  &:first-child {\n    margin-top: 0;\n  }\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n\n  > .info {\n    flex-grow: 1;\n    cursor: pointer;\n\n    &:hover {\n      background-color: var(--theme-bg-hover);\n    }\n\n    > .marker-set-switch {\n      position: relative;\n\n      .label {\n        margin: 0 3em 0 0.5em;\n      }\n\n      > .switch {\n        position: absolute;\n        top: 0.5em;\n        right: 0.5em;\n      }\n    }\n\n    > .stats {\n      display: flex;\n\n      margin: 0 0.5em;\n\n      font-size: 0.8em;\n      line-height: 2em;\n      color: var(--theme-fg-light);\n\n      > div {\n        &:not(:first-child) {\n          margin-left: 0.5em;\n          padding-left: 0.5em;\n          border-left: solid 1px var(--theme-bg-light);\n        }\n      }\n    }\n  }\n\n  > .open-menu-button {\n    width: 2em;\n    cursor: pointer;\n\n    &:hover {\n      background-color: var(--theme-bg-hover);\n    }\n\n    > svg {\n      position: relative;\n      fill: var(--theme-fg-light);\n\n      top: 50%;\n      transform: translate(0, -50%) scale(0.75);\n\n      path:nth-child(1) {\n        transform-origin: 15px 9px;\n        transform: translate(0, 10px) rotate(-30deg);\n      }\n\n      path:nth-child(2) {\n        transform-origin: 15px 21px;\n        transform: translate(0, -10px) rotate(30deg);\n      }\n    }\n\n    &:active {\n      background-color: var(--theme-fg-light);\n      color: var(--theme-bg);\n\n      > svg {\n        fill: var(--theme-bg-light);\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSet.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSet.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MarkerSet.vue?vue&type=template&id=3cd5339e&\"\nimport script from \"./MarkerSet.vue?vue&type=script&lang=js&\"\nexport * from \"./MarkerSet.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MarkerSet.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n<div>\n  <div class=\"marker-sets\">\n    <MarkerSet v-for=\"markerSet of filteredMarkerSets\" :key=\"markerSet.id\" :marker-set=\"markerSet\" @more=\"openMore(markerSet)\" />\n  </div>\n  <hr v-if=\"filteredMarkerSets.length > 0 & thisMarkerSet.markers.length > 0\">\n  <div class=\"markers\" v-if=\"thisMarkerSet.markers.length > 0\">\n    <TextInput :value=\"filter.search\" @input=\"filter.search = $event.target.value\" :placeholder=\"$t('markers.searchPlaceholder')\" />\n    <MarkerItem v-for=\"marker of filteredMarkers\" :key=\"marker.id\" :marker=\"marker\" />\n  </div>\n</div>\n</template>\n\n<script>\nimport MarkerItem from \"@/components/Menu/MarkerItem\";\nimport TextInput from \"@/components/Menu/TextInput\";\nimport MarkerSet from \"@/components/Menu/MarkerSet\";\nimport {MainMenu} from \"@/js/MainMenu\";\nexport default {\n  name: \"MarkerSetMenu\",\n  components: {MarkerSet, TextInput, MarkerItem},\n  props: {\n    menu: MainMenu\n  },\n  data() {\n    return {\n      filter: {\n        search: \"\",\n      }\n    }\n  },\n  computed: {\n    thisMarkerSet() {\n      return this.menu.currentPage().markerSet;\n    },\n    filteredMarkers() {\n      return [...this.thisMarkerSet.markers].sort((a, b) => {\n        if (a.id < b.id) return -1;\n        if (a.id > b.id) return 1;\n        return 0;\n      }).filter(marker => {\n        if (!this.filter.search) return true;\n        if (marker.id.includesCI(this.filter.search)) return true;\n        if (marker.label && marker.label.includesCI(this.filter.search)) return true;\n        if (marker.type === \"player\" && (marker.name.includesCI(this.filter.search) || marker.playerUuid.includesCI(this.filter.search))) return true;\n        return false;\n      });\n    },\n    filteredMarkerSets() {\n      return this.thisMarkerSet.markerSets.filter(markerSet => {\n        return (markerSet.id !== \"bm-popup-set\");\n      });\n    }\n  },\n  methods: {\n    openMore(markerSet) {\n      this.menu.openPage(\n          this.menu.currentPage().id,\n          this.menu.currentPage().title + \" > \" + markerSet.label,\n          {markerSet: markerSet}\n      )\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSetMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSetMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MarkerSetMenu.vue?vue&type=template&id=21f0c4c5&\"\nimport script from \"./MarkerSetMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./MarkerSetMenu.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"map-button\",class:{selected: _vm.map.id === _vm.selectedMapId},attrs:{\"title\":_vm.map.id},on:{\"click\":function($event){return _vm.switchMap(_vm.map.id)}}},[_c('span',{staticClass:\"sky\",style:({color: 'rgb(' + _vm.map.skyColor.r * 255 + ',' + _vm.map.skyColor.g * 255 + ',' + _vm.map.skyColor.b * 255 + ')'})},[_vm._v(\"\")]),_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.map.name))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"map-button\" :class=\"{selected: map.id === selectedMapId}\" @click=\"switchMap(map.id)\" :title=\"map.id\">\n    <span class=\"sky\" :style=\"{color: 'rgb(' + map.skyColor.r * 255 + ',' + map.skyColor.g * 255 + ',' + map.skyColor.b * 255 + ')'}\">&bull;</span>\n    <span class=\"name\">{{map.name}}</span>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"MapButton\",\n  props: {\n    map: Object,\n  },\n  data() {\n    return {\n      mapViewer: this.$bluemap.mapViewer.data,\n      appState: this.$bluemap.appState,\n    }\n  },\n  computed: {\n    selectedMapId() {\n      return this.mapViewer.map ? this.mapViewer.map.id : null;\n    }\n  },\n  methods: {\n    switchMap(mapId) {\n      this.$bluemap.switchMap(mapId);\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.side-menu .map-button {\n  position: relative;\n  cursor: pointer;\n  user-select: none;\n\n  height: 2em;\n  line-height: 2em;\n\n  white-space: nowrap;\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n\n  &.selected {\n    background-color: var(--theme-bg-light);\n  }\n\n  &:hover {\n    background-color: var(--theme-bg-hover);\n  }\n\n  .sky {\n    float: left;\n    border-radius: 100%;\n\n    width: 0.5em;\n    height: 0.5em;\n\n    margin: 0 0.25em 0 0.5em;\n  }\n\n  .id {\n    font-style: italic;\n    color: var(--theme-fg-light);\n\n    margin: 0 0.5em;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapButton.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapButton.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapButton.vue?vue&type=template&id=17174b7f&\"\nimport script from \"./MapButton.vue?vue&type=script&lang=js&\"\nexport * from \"./MapButton.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MapButton.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <SideMenu :open=\"menu.isOpen\"\n            :title=\"menu.currentPage().title\"\n            :back=\"menu.pageStack.length > 1\"\n            @back=\"menu.closePage()\"\n            @close=\"menu.closeAll()\">\n\n    <div v-if=\"menu.currentPage().id === 'root'\">\n      <SimpleButton @action=\"menu.openPage('maps', () => $t('maps.title'))\" :submenu=\"true\">{{ $t(\"maps.button\") }}</SimpleButton>\n      <SimpleButton @action=\"menu.openPage('markers', () => $t('markers.title'), {markerSet: markers})\" :submenu=\"true\">{{ $t(\"markers.button\") }}</SimpleButton>\n      <SimpleButton @action=\"menu.openPage('settings', () => $t('settings.title'))\" :submenu=\"true\">{{ $t(\"settings.button\") }}</SimpleButton>\n      <SimpleButton @action=\"menu.openPage('info', () => $t('info.title'))\" :submenu=\"true\">{{ $t(\"info.button\") }}</SimpleButton>\n      <hr>\n      <SimpleButton @action=\"goFullscreen\">{{ $t(\"goFullscreen.button\") }}</SimpleButton>\n      <SimpleButton @action=\"$bluemap.resetCamera()\">{{ $t(\"resetCamera.button\") }}</SimpleButton>\n      <SimpleButton @action=\"$bluemap.takeScreenshot()\">{{ $t(\"screenshot.button\") }}</SimpleButton>\n      <SimpleButton @action=\"$bluemap.updateMap()\" :title=\"$t('updateMap.tooltip')\">{{ $t(\"updateMap.button\") }}</SimpleButton>\n    </div>\n\n    <div v-if=\"menu.currentPage().id === 'maps'\">\n      <MapButton v-for=\"map of appState.maps\" :key=\"map.id\" :map=\"map\" />\n    </div>\n\n    <MarkerSetMenu v-if=\"menu.currentPage().id === 'markers'\" :menu=\"menu\" />\n\n    <SettingsMenu v-if=\"menu.currentPage().id === 'settings'\" />\n\n    <div class=\"info-content\" v-if=\"menu.currentPage().id === 'info'\" v-html=\"$t('info.content', {\n      version: $bluemap.settings.version\n    })\"></div>\n\n  </SideMenu>\n</template>\n\n<script>\nimport SideMenu from \"@/components/Menu/SideMenu\";\nimport SimpleButton from \"@/components/Menu/SimpleButton\";\nimport SettingsMenu from \"@/components/Menu/SettingsMenu\";\nimport {MainMenu} from \"@/js/MainMenu\";\nimport MarkerSetMenu from \"@/components/Menu/MarkerSetMenu\";\nimport MapButton from \"@/components/Menu/MapButton\";\n\nexport default {\n  name: \"MainMenu\",\n  components: {MapButton, MarkerSetMenu, SettingsMenu, SimpleButton, SideMenu},\n  props: {\n    menu: MainMenu\n  },\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n      markers: this.$bluemap.mapViewer.markers.data,\n    }\n  },\n  methods: {\n    goFullscreen() {\n      document.body.requestFullscreen();\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.info-content {\n  font-size: 0.8em;\n\n  table {\n    border-collapse: collapse;\n    width: 100%;\n\n    tr {\n      th, td {\n        padding: 0.2em 0.5em;\n        border: solid 1px var(--theme-bg-light);\n      }\n\n      th {\n        font-weight: inherit;\n        text-align: inherit;\n      }\n    }\n  }\n\n  .info-footer {\n    text-align: center;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainMenu.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainMenu.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MainMenu.vue?vue&type=template&id=7818903c&\"\nimport script from \"./MainMenu.vue?vue&type=script&lang=js&\"\nexport * from \"./MainMenu.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MainMenu.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{disabled: !_vm.enabled},attrs:{\"id\":\"ff-mobile-controls\"}},[_c('div',{staticClass:\"move-fields\"},[_c('div',{staticClass:\"button up-button\",on:{\"touchstart\":function($event){_vm.forward = 1; _vm.forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])]),_c('div',{staticClass:\"button down-button\",on:{\"touchstart\":function($event){_vm.forward = -1; _vm.forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{staticClass:\"down\",attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])])]),_c('div',{staticClass:\"height-fields\"},[_c('div',{staticClass:\"button up-button\",on:{\"touchstart\":function($event){_vm.up = 1; _vm.upPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])]),_c('div',{staticClass:\"button down-button\",on:{\"touchstart\":function($event){_vm.up = -1; _vm.upPointer = $event.changedTouches[0].identifier; $event.preventDefault();}}},[_c('svg',{staticClass:\"down\",attrs:{\"viewBox\":\"0 0 100 50\"}},[_c('path',{attrs:{\"d\":\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\\n          c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"}})])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"ff-mobile-controls\" :class=\"{disabled: !enabled}\">\n    <div class=\"move-fields\">\n      <div class=\"button up-button\" @touchstart=\"forward = 1; forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n      <div class=\"button down-button\" @touchstart=\"forward = -1; forwardPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\" class=\"down\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n    </div>\n    <div class=\"height-fields\">\n      <div class=\"button up-button\" @touchstart=\"up = 1; upPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n      <div class=\"button down-button\" @touchstart=\"up = -1; upPointer = $event.changedTouches[0].identifier; $event.preventDefault();\">\n        <svg viewBox=\"0 0 100 50\" class=\"down\">\n          <path d=\"M6.75,48.375c-2.75,0-3.384-1.565-1.409-3.479L46.41,5.104c1.975-1.914,5.207-1.913,7.182,0l41.067,39.792\n            c1.975,1.914,1.341,3.479-1.409,3.479H6.75z\"/>\n        </svg>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"FreeFlightMobileControls\",\n  data() {\n    return {\n      enabled: false,\n      forward: 0,\n      forwardPointer: -1,\n      up: 0,\n      upPointer: -1,\n    }\n  },\n  methods: {\n    onTouchStop(evt) {\n      console.log(\"Stop: \", evt);\n\n      if (evt.changedTouches[0].identifier === this.forwardPointer) this.forward = 0;\n      if (evt.changedTouches[0].identifier === this.upPointer) this.up = 0;\n    },\n    onFrame(evt) {\n      let cm = this.$bluemap.mapViewer.controlsManager;\n      cm.position.x += this.forward * Math.sin(cm.rotation) * evt.detail.delta * 0.02;\n      cm.position.z += this.forward * -Math.cos(cm.rotation) * evt.detail.delta * 0.02;\n      cm.position.y += this.up * evt.detail.delta * 0.01;\n    },\n    enable(evt) {\n      this.enabled = true;\n    },\n  },\n  mounted() {\n    window.addEventListener(\"touchstart\", this.enable);\n\n    window.addEventListener(\"touchend\", this.onTouchStop);\n    window.addEventListener(\"touchcancel\", this.onTouchStop);\n    this.$bluemap.events.addEventListener(\"bluemapRenderFrame\", this.onFrame);\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"touchstart\", this.enable);\n\n    window.removeEventListener(\"touchend\", this.onTouchStop);\n    window.removeEventListener(\"touchcancel\", this.onTouchStop);\n    this.$bluemap.events.removeEventListener(\"bluemapRenderFrame\", this.onFrame);\n  }\n}\n</script>\n\n<style lang=\"scss\">\n\n#ff-mobile-controls {\n  font-size: 15vw;\n\n  &.disabled {\n    display: none;\n  }\n\n  @media (orientation: portrait) {\n    font-size: 15vh;\n  }\n\n  .button {\n    width: 1em;\n    margin: 0.1em;\n    opacity: 0.5;\n\n    pointer-events: auto;\n\n    svg {\n      fill: var(--theme-bg);\n\n      &:active {\n        fill: var(--theme-bg-light);\n        opacity: 0.8;\n      }\n\n      &.down {\n        transform: scaleY(-1);\n      }\n    }\n  }\n\n  .move-fields {\n    position: fixed;\n\n    bottom: 0.2em;\n    left: 0.2em;\n\n  }\n\n  .height-fields {\n    position: fixed;\n\n    bottom: 0.2em;\n    right: 0.2em;\n  }\n\n}\n\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FreeFlightMobileControls.vue?vue&type=template&id=3e2107aa&\"\nimport script from \"./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"\nexport * from \"./FreeFlightMobileControls.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FreeFlightMobileControls.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\" :class=\"{'theme-light': appState.theme === 'light', 'theme-dark': appState.theme === 'dark', 'theme-contrast': appState.theme === 'contrast'}\">\n    <FreeFlightMobileControls v-if=\"appState.controls.state === 'free'\" />\n    <ControlBar />\n    <MainMenu :menu=\"appState.menu\" />\n  </div>\n</template>\n\n<script>\nimport ControlBar from \"@/components/ControlBar/ControlBar\";\nimport MainMenu from \"@/components/Menu/MainMenu\";\nimport FreeFlightMobileControls from \"@/components/Controls/FreeFlightMobileControls\";\n\nexport default {\n  name: 'App',\n  components: {\n    FreeFlightMobileControls,\n    MainMenu,\n    ControlBar\n  },\n  data() {\n    return {\n      appState: this.$bluemap.appState,\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  @import \"~@/scss/global.scss\";\n\n  #map-container {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n  }\n\n  #app {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n\n    z-index: 100; // put over bluemap markers\n\n    pointer-events: none;\n\n    font-size: 1rem;\n    @media (max-width: $mobile-break) {\n      font-size: 1.5rem;\n    }\n  }\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=e84f4214&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nexport class Tile {\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @param onLoad {function(Tile)}\n     * @param onUnload {function(Tile)}\n     */\n    constructor(x, z, onLoad, onUnload) {\n        Object.defineProperty( this, 'isTile', { value: true } );\n\n        /** @type {THREE.Mesh} */\n        this.model = null;\n\n        this.onLoad = onLoad;\n        this.onUnload = onUnload;\n\n        this.x = x;\n        this.z = z;\n\n        this.unloaded = true;\n        this.loading = false;\n    }\n\n    /**\n     * @param tileLoader {TileLoader}\n     * @returns {Promise<void>}\n     */\n    load(tileLoader) {\n        if (this.loading) return Promise.reject(\"tile is already loading!\");\n        this.loading = true;\n\n        this.unload();\n\n        this.unloaded = false;\n        return tileLoader.load(this.x, this.z, () => this.unloaded)\n            .then(model => {\n                if (this.unloaded){\n                    Tile.disposeModel(model);\n                    return;\n                }\n\n                this.model = model;\n                this.onLoad(this);\n            })\n            .finally(() => {\n                this.loading = false;\n            });\n    }\n\n    unload() {\n        this.unloaded = true;\n        if (this.model) {\n            this.onUnload(this);\n\n            Tile.disposeModel(this.model);\n\n            this.model = null;\n        }\n    }\n\n    static disposeModel(model) {\n        if (model.userData?.tileType === \"hires\") {\n            model.geometry.dispose();\n        }\n\n        else if (model.userData?.tileType === \"lowres\") {\n            model.material.uniforms.textureImage.value.dispose();\n            model.material.dispose();\n        }\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get loaded() {\n        return !!this.model;\n    }\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {ClampToEdgeWrapping, LinearFilter, NearestFilter, Texture} from \"three\";\n\nexport class TileMap {\n\n    static EMPTY = \"#000\";\n    static LOADED = \"#fff\";\n\n    /**\n     * @param width {number}\n     * @param height {number}\n     */\n    constructor(width, height) {\n        this.canvas = document.createElementNS('http://www.w3.org/1999/xhtml', 'canvas');\n        this.canvas.width = width;\n        this.canvas.height = height;\n\n        /**\n         * @type CanvasRenderingContext2D\n         */\n        this.tileMapContext = this.canvas.getContext('2d', {\n            alpha: false,\n            willReadFrequently: true,\n        });\n\n        this.texture = new Texture(this.canvas);\n        this.texture.generateMipmaps = false;\n        this.texture.magFilter = LinearFilter;\n        this.texture.minFilter = LinearFilter;\n        this.texture.wrapS = ClampToEdgeWrapping;\n        this.texture.wrapT = ClampToEdgeWrapping;\n        this.texture.flipY = false;\n        this.texture.needsUpdate = true;\n    }\n\n    /**\n     * @param state {string}\n     */\n    setAll(state) {\n        this.tileMapContext.fillStyle = state;\n        this.tileMapContext.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n        this.texture.needsUpdate = true;\n    }\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @param state {string}\n     */\n    setTile(x, z, state) {\n        this.tileMapContext.fillStyle = state;\n        this.tileMapContext.fillRect(x, z, 1, 1);\n\n        this.texture.needsUpdate = true;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { Vector2, Scene, Group } from 'three';\nimport  { Tile } from './Tile.js';\nimport {alert, hashTile} from '../util/Utils.js';\nimport {TileMap} from \"./TileMap\";\n\nexport class TileManager {\n\n    static tileMapSize = 100;\n    static tileMapHalfSize = TileManager.tileMapSize / 2;\n\n    /**\n     * @param tileLoader {TileLoader | LowresTileLoader}\n     * @param onTileLoad {function(Tile)}\n     * @param onTileUnload {function(Tile)}\n     * @param events {EventTarget}\n     */\n    constructor(tileLoader, onTileLoad = null, onTileUnload = null, events = null) {\n        Object.defineProperty( this, 'isTileManager', { value: true } );\n\n        this.sceneParent = new Scene();\n        this.scene = new Group();\n        this.sceneParent.add(this.scene);\n\n        this.events = events;\n        this.tileLoader = tileLoader;\n\n        this.onTileLoad = onTileLoad || function(){};\n        this.onTileUnload = onTileUnload || function(){};\n\n        this.viewDistanceX = 1;\n        this.viewDistanceZ = 1;\n        this.centerTile = new Vector2(0, 0);\n\n        this.currentlyLoading = 0;\n        this.loadTimeout = null;\n\n        //map of loaded tiles\n        this.tiles = new Map();\n\n        // a canvas that keeps track of the loaded tiles, used for shaders\n        this.tileMap = new TileMap(TileManager.tileMapSize, TileManager.tileMapSize);\n\n        this.unloaded = true;\n    }\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @param viewDistanceX {number}\n     * @param viewDistanceZ {number}\n     */\n    loadAroundTile(x, z, viewDistanceX, viewDistanceZ) {\n        this.unloaded = false;\n\n        let unloadTiles = false;\n        if (this.viewDistanceX > viewDistanceX || this.viewDistanceZ > viewDistanceZ) {\n            unloadTiles = true;\n        }\n\n        this.viewDistanceX = viewDistanceX;\n        this.viewDistanceZ = viewDistanceZ;\n\n        if (viewDistanceX <= 0 || viewDistanceZ <= 0) {\n            this.removeAllTiles();\n            return;\n        }\n\n        if (unloadTiles || this.centerTile.x !== x || this.centerTile.y !== z) {\n            this.centerTile.set(x, z);\n            this.removeFarTiles();\n\n            this.tileMap.setAll(TileMap.EMPTY);\n            this.tiles.forEach(tile => {\n                if (!tile.loading && !tile.unloaded) {\n                    this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.LOADED);\n                }\n            });\n        }\n\n        this.loadCloseTiles();\n    }\n\n    unload() {\n        this.unloaded = true;\n        this.removeAllTiles();\n    }\n\n    removeFarTiles() {\n        this.tiles.forEach((tile, hash, map) => {\n            if (\n                tile.x + this.viewDistanceX < this.centerTile.x ||\n                tile.x - this.viewDistanceX > this.centerTile.x ||\n                tile.z + this.viewDistanceZ < this.centerTile.y ||\n                tile.z - this.viewDistanceZ > this.centerTile.y\n            ) {\n                tile.unload();\n                map.delete(hash);\n            }\n        });\n    }\n\n    removeAllTiles() {\n        this.tileMap.setAll(TileMap.EMPTY);\n\n        this.tiles.forEach(tile => {\n            tile.unload();\n        });\n        this.tiles.clear();\n    }\n\n    loadCloseTiles = () => {\n        if (this.unloaded) return;\n        if (!this.loadNextTile()) return;\n\n        if (this.loadTimeout) clearTimeout(this.loadTimeout);\n\n        if (this.currentlyLoading < 8) {\n            this.loadTimeout = setTimeout(this.loadCloseTiles, 0);\n        } else {\n            this.loadTimeout = setTimeout(this.loadCloseTiles, 1000);\n        }\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    loadNextTile() {\n        if (this.unloaded) return false;\n\n        let x = 0;\n        let z = 0;\n        let d = 1;\n        let m = 1;\n\n        while (m < Math.max(this.viewDistanceX, this.viewDistanceZ) * 2 + 1) {\n            while (2 * x * d < m) {\n                if (this.tryLoadTile(this.centerTile.x + x, this.centerTile.y + z)) return true;\n                x = x + d;\n            }\n            while (2 * z * d < m) {\n                if (this.tryLoadTile(this.centerTile.x + x, this.centerTile.y + z)) return true;\n                z = z + d;\n            }\n            d = -1 * d;\n            m = m + 1;\n        }\n\n        return false;\n    }\n\n    /**\n     * @param x {number}\n     * @param z {number}\n     * @returns {boolean}\n     */\n    tryLoadTile(x, z) {\n        if (this.unloaded) return false;\n\n        if (Math.abs(x - this.centerTile.x) > this.viewDistanceX) return false;\n        if (Math.abs(z - this.centerTile.y) > this.viewDistanceZ) return false;\n\n        let tileHash = hashTile(x, z);\n\n        let tile = this.tiles.get(tileHash);\n        if (tile !== undefined) return false;\n\n        this.currentlyLoading++;\n\n        tile = new Tile(x, z, this.handleLoadedTile, this.handleUnloadedTile);\n        this.tiles.set(tileHash, tile);\n        tile.load(this.tileLoader)\n            .then(() => {\n                if (this.loadTimeout) clearTimeout(this.loadTimeout);\n                this.loadTimeout = setTimeout(this.loadCloseTiles, 0);\n            })\n            .catch(error => {})\n            .finally(() => {\n                this.currentlyLoading--;\n            });\n\n        return true;\n    }\n\n    handleLoadedTile = tile => {\n        this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.LOADED);\n\n        this.scene.add(tile.model);\n        this.onTileLoad(tile);\n    }\n\n    handleUnloadedTile = tile => {\n        this.tileMap.setTile(tile.x - this.centerTile.x + TileManager.tileMapHalfSize, tile.z - this.centerTile.y + TileManager.tileMapHalfSize, TileMap.EMPTY);\n\n        this.scene.remove(tile.model);\n        this.onTileUnload(tile);\n    }\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {pathFromCoords} from \"../util/Utils\";\nimport {BufferGeometryLoader, FileLoader, Mesh} from \"three\";\n\nexport class TileLoader {\n\n    /**\n     * @param tilePath {string}\n     * @param material {THREE.Material | THREE.Material[]}\n     * @param tileSettings {{\n     *      tileSize: {x: number, z: number},\n     *\t    scale: {x: number, z: number},\n     *      translate: {x: number, z: number}\n     * }}\n     * @param loadBlocker {function: Promise}\n     * @param tileCacheHash {number}\n     */\n    constructor(tilePath, material, tileSettings, loadBlocker = () => Promise.resolve(), tileCacheHash = 0) {\n        Object.defineProperty( this, 'isTileLoader', { value: true } );\n\n        this.tilePath = tilePath;\n        this.material = material;\n        this.tileSettings = tileSettings;\n\n        this.tileCacheHash = tileCacheHash;\n\n        this.loadBlocker = loadBlocker;\n\n        this.fileLoader = new FileLoader();\n        this.fileLoader.setResponseType('json');\n\n        this.bufferGeometryLoader = new BufferGeometryLoader();\n    }\n\n    load = (tileX, tileZ, cancelCheck = () => false) => {\n        let tileUrl = this.tilePath + pathFromCoords(tileX, tileZ) + '.json';\n\n        //await this.loadBlocker();\n        return new Promise((resolve, reject) => {\n            this.fileLoader.load(tileUrl + '?' + this.tileCacheHash,\n                async json => {\n                    let geometryJson = json.tileGeometry || {};\n                    if (!geometryJson.type || geometryJson.type !== 'BufferGeometry'){\n                        reject({status: \"empty\"});\n                        return;\n                    }\n\n                    await this.loadBlocker();\n                    if (cancelCheck()){\n                        reject({status: \"cancelled\"});\n                        return;\n                    }\n\n                    let geometry = this.bufferGeometryLoader.parse(geometryJson);\n\n                    let object = new Mesh(geometry, this.material);\n\n                    let tileSize = this.tileSettings.tileSize;\n                    let translate = this.tileSettings.translate;\n                    let scale = this.tileSettings.scale;\n                    object.position.set(tileX * tileSize.x + translate.x, 0, tileZ * tileSize.z + translate.z);\n                    object.scale.set(scale.x, 1, scale.z);\n\n                    object.userData.tileUrl = tileUrl;\n                    object.userData.tileType = \"hires\";\n\n                    object.updateMatrixWorld(true);\n\n                    resolve(object);\n                },\n                () => {},\n                reject\n            );\n        });\n    }\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {pathFromCoords} from \"../util/Utils\";\nimport {\n    TextureLoader,\n    Mesh,\n    PlaneBufferGeometry,\n    VertexColors,\n    FrontSide,\n    ShaderMaterial,\n    NearestFilter,\n    ClampToEdgeWrapping,\n    NearestMipMapLinearFilter,\n    Vector2\n} from \"three\";\n\nexport class LowresTileLoader {\n\n    constructor(tilePath, tileSettings, lod, vertexShader, fragmentShader, uniforms, loadBlocker = () => Promise.resolve(), tileCacheHash = 0) {\n        Object.defineProperty( this, 'isLowresTileLoader', { value: true } );\n\n        this.tilePath = tilePath;\n        this.tileSettings = tileSettings;\n        this.lod = lod;\n        this.loadBlocker = loadBlocker;\n        this.tileCacheHash = tileCacheHash;\n\n        this.vertexShader = vertexShader;\n        this.fragmentShader = fragmentShader;\n        this.uniforms = uniforms;\n\n        this.textureLoader = new TextureLoader();\n        this.geometry = new PlaneBufferGeometry(\n            tileSettings.tileSize.x + 1, tileSettings.tileSize.z + 1,\n            Math.ceil(100 / (lod * 2)), Math.ceil(100 / (lod * 2))\n        );\n        this.geometry.deleteAttribute('normal');\n        this.geometry.deleteAttribute('uv');\n        this.geometry.rotateX(-Math.PI / 2);\n        this.geometry.translate(tileSettings.tileSize.x / 2 + 1, 0, tileSettings.tileSize.x / 2 + 1);\n    }\n\n    load = (tileX, tileZ, cancelCheck = () => false) => {\n        let tileUrl = this.tilePath + this.lod + \"/\" + pathFromCoords(tileX, tileZ) + '.png';\n\n        //await this.loadBlocker();\n        return new Promise((resolve, reject) => {\n            this.textureLoader.load(tileUrl + '?' + this.tileCacheHash,\n                async texture => {\n                    texture.anisotropy = 1;\n                    texture.generateMipmaps = false;\n                    texture.magFilter = NearestFilter;\n                    texture.minFilter = texture.generateMipmaps ? NearestMipMapLinearFilter : NearestFilter;\n                    texture.wrapS = ClampToEdgeWrapping;\n                    texture.wrapT = ClampToEdgeWrapping;\n                    texture.flipY = false;\n                    texture.flatShading = true;\n\n                    await this.loadBlocker();\n                    if (cancelCheck()){\n                        texture.dispose();\n                        reject({status: \"cancelled\"});\n                        return;\n                    }\n\n                    const scale = Math.pow(this.tileSettings.lodFactor, this.lod - 1);\n\n                    let material = new ShaderMaterial({\n                        uniforms: {\n                            ...this.uniforms,\n                            tileSize: {\n                                value: new Vector2(this.tileSettings.tileSize.x, this.tileSettings.tileSize.z)\n                            },\n                            textureSize: {\n                                value: new Vector2(texture.image.width, texture.image.height)\n                            },\n                            textureImage: {\n                                type: 't',\n                                value: texture\n                            },\n                            lod: {\n                                value: this.lod\n                            },\n                            lodScale: {\n                                value: scale\n                            }\n                        },\n                        vertexShader: this.vertexShader,\n                        fragmentShader: this.fragmentShader,\n                        transparent: false,\n                        depthWrite: true,\n                        depthTest: true,\n                        vertexColors: VertexColors,\n                        side: FrontSide,\n                        wireframe: false,\n                    });\n\n                    let object = new Mesh(this.geometry, material);\n\n                    object.position.set(tileX * this.tileSettings.tileSize.x * scale, 0, tileZ * this.tileSettings.tileSize.z * scale);\n                    object.scale.set(scale, 1, scale);\n\n                    object.userData.tileUrl = tileUrl;\n                    object.userData.tileType = \"lowres\";\n\n                    object.updateMatrixWorld(true);\n\n                    resolve(object);\n                },\n                undefined,\n                reject\n            );\n        });\n    }\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {\n\tClampToEdgeWrapping,\n\tColor,\n\tFileLoader,\n\tFrontSide,\n\tNearestFilter,\n\tNearestMipMapLinearFilter,\n\tRaycaster,\n\tScene,\n\tShaderMaterial,\n\tTexture,\n\tVector3,\n\tVertexColors\n} from \"three\";\nimport {alert, dispatchEvent, generateCacheHash, getPixel, hashTile, stringToImage, vecArrToObj} from \"../util/Utils\";\nimport {TileManager} from \"./TileManager\";\nimport {TileLoader} from \"./TileLoader\";\nimport {LowresTileLoader} from \"./LowresTileLoader\";\n\nexport class Map {\n\n\t/**\n\t * @param id {string}\n\t * @param dataUrl {string}\n\t * @param loadBlocker {function: Promise<void>}\n\t * @param events {EventTarget}\n\t */\n\tconstructor(id, dataUrl, loadBlocker, events = null) {\n\t\tObject.defineProperty( this, 'isMap', { value: true } );\n\n\t\tthis.loadBlocker = loadBlocker;\n\t\tthis.events = events;\n\n\t\tthis.data = {\n\t\t\tid: id,\n\t\t\tsorting: 0,\n\t\t\tdataUrl: dataUrl,\n\t\t\tsettingsUrl: dataUrl + \"settings.json\",\n\t\t\ttexturesUrl: dataUrl + \"textures.json\",\n\t\t\tname: id,\n\t\t\tstartPos: {x: 0, z: 0},\n\t\t\tskyColor: new Color(),\n\t\t\tambientLight: 0,\n\t\t\thires: {\n\t\t\t\ttileSize: {x: 32, z: 32},\n\t\t\t\tscale: {x: 1, z: 1},\n\t\t\t\ttranslate: {x: 2, z: 2}\n\t\t\t},\n\t\t\tlowres: {\n\t\t\t\ttileSize: {x: 32, z: 32},\n\t\t\t\tlodFactor: 5,\n\t\t\t\tlodCount: 3\n\t\t\t}\n\t\t};\n\n\t\tthis.raycaster = new Raycaster();\n\n\t\t/** @type {ShaderMaterial[]} */\n\t\tthis.hiresMaterial = null;\n\t\t/** @type {ShaderMaterial} */\n\t\tthis.lowresMaterial = null;\n\t\t/** @type {Texture[]} */\n\t\tthis.loadedTextures = [];\n\n\t\t/** @type {TileManager} */\n\t\tthis.hiresTileManager = null;\n\t\t/** @type {TileManager[]} */\n\t\tthis.lowresTileManager = null;\n\t}\n\n\t/**\n\t * Loads textures and materials for this map so it is ready to load map-tiles\n\t * @param hiresVertexShader {string}\n\t * @param hiresFragmentShader {string}\n\t * @param lowresVertexShader {string}\n\t * @param lowresFragmentShader {string}\n\t * @param uniforms {object}\n\t * @param tileCacheHash {number}\n\t * @returns {Promise<void>}\n\t */\n\tload(hiresVertexShader, hiresFragmentShader, lowresVertexShader, lowresFragmentShader, uniforms, tileCacheHash = 0) {\n\t\tthis.unload()\n\n\t\tlet settingsPromise = this.loadSettings();\n\t\tlet textureFilePromise = this.loadTexturesFile();\n\n\t\tthis.lowresMaterial = this.createLowresMaterial(lowresVertexShader, lowresFragmentShader, uniforms);\n\n\t\treturn Promise.all([settingsPromise, textureFilePromise])\n            .then(values => {\n                let textures = values[1];\n                if (textures === null) throw new Error(\"Failed to parse textures.json!\");\n\n                this.hiresMaterial = this.createHiresMaterial(hiresVertexShader, hiresFragmentShader, uniforms, textures);\n\n                this.hiresTileManager = new TileManager(new TileLoader(`${this.data.dataUrl}tiles/0/`, this.hiresMaterial, this.data.hires, this.loadBlocker, tileCacheHash), this.onTileLoad(\"hires\"), this.onTileUnload(\"hires\"), this.events);\n\t\t\t\tthis.hiresTileManager.scene.autoUpdate = false;\n\n                this.lowresTileManager = [];\n\t\t\t\tfor (let i = 0; i < this.data.lowres.lodCount; i++) {\n\t\t\t\t\tthis.lowresTileManager[i] = new TileManager(new LowresTileLoader(`${this.data.dataUrl}tiles/`, this.data.lowres, i + 1, lowresVertexShader, lowresFragmentShader, uniforms, async () => {}, tileCacheHash), this.onTileLoad(\"lowres\"), this.onTileUnload(\"lowres\"), this.events);\n\t\t\t\t\tthis.lowresTileManager[i].scene.autoUpdate = false;\n\t\t\t\t}\n\n                alert(this.events, `Map '${this.data.id}' is loaded.`, \"fine\");\n            });\n\t}\n\n\t/**\n\t * Loads the settings of this map\n\t * @returns {Promise<void>}\n\t */\n\tloadSettings() {\n\t\treturn this.loadSettingsFile()\n\t\t\t.then(worldSettings => {\n\t\t\t\tthis.data.name = worldSettings.name ? worldSettings.name : this.data.name;\n\n\t\t\t\tthis.data.sorting = worldSettings.sorting ? worldSettings.sorting : this.data.sorting;\n\n\t\t\t\tthis.data.startPos = {...this.data.startPos, ...vecArrToObj(worldSettings.startPos, true)};\n\n\t\t\t\tif (worldSettings.skyColor && worldSettings.skyColor.length >= 3) {\n\t\t\t\t\tthis.data.skyColor.setRGB(\n\t\t\t\t\t\tworldSettings.skyColor[0],\n\t\t\t\t\t\tworldSettings.skyColor[1],\n\t\t\t\t\t\tworldSettings.skyColor[2]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.data.ambientLight = worldSettings.ambientLight ? worldSettings.ambientLight : this.data.ambientLight;\n\n\t\t\t\tif (worldSettings.hires === undefined) worldSettings.hires = {};\n\t\t\t\tif (worldSettings.lowres === undefined) worldSettings.lowres = {};\n\n\t\t\t\tthis.data.hires = {\n\t\t\t\t\ttileSize: {...this.data.hires.tileSize, ...vecArrToObj(worldSettings.hires.tileSize, true)},\n\t\t\t\t\tscale: {...this.data.hires.scale, ...vecArrToObj(worldSettings.hires.scale, true)},\n\t\t\t\t\ttranslate: {...this.data.hires.translate, ...vecArrToObj(worldSettings.hires.translate, true)}\n\t\t\t\t};\n\t\t\t\tthis.data.lowres = {\n\t\t\t\t\ttileSize: {...this.data.lowres.tileSize, ...vecArrToObj(worldSettings.lowres.tileSize, true)},\n\t\t\t\t\tlodFactor: worldSettings.lowres.lodFactor !== undefined ? worldSettings.lowres.lodFactor : this.data.lowres.lodFactor,\n\t\t\t\t\tlodCount: worldSettings.lowres.lodCount !== undefined ? worldSettings.lowres.lodCount : this.data.lowres.lodCount\n\t\t\t\t};\n\n\t\t\t\talert(this.events, `Settings for map '${this.data.id}' loaded.`, \"fine\");\n\t\t\t});\n\t}\n\n\tonTileLoad = layer => tile => {\n\t\tdispatchEvent(this.events, \"bluemapMapTileLoaded\", {\n\t\t\ttile: tile,\n\t\t\tlayer: layer\n\t\t});\n\t}\n\n\tonTileUnload = layer => tile => {\n\t\tdispatchEvent(this.events, \"bluemapMapTileUnloaded\", {\n\t\t\ttile: tile,\n\t\t\tlayer: layer\n\t\t});\n\t}\n\n\t/**\n\t * @param x {number}\n\t * @param z {number}\n\t * @param hiresViewDistance {number}\n\t * @param lowresViewDistance {number}\n\t */\n\tloadMapArea(x, z, hiresViewDistance, lowresViewDistance) {\n\t\tif (!this.isLoaded) return;\n\n\t\tconst hiresX = Math.floor((x - this.data.hires.translate.x) / this.data.hires.tileSize.x);\n\t\tconst hiresZ = Math.floor((z - this.data.hires.translate.z) / this.data.hires.tileSize.z);\n\t\tconst hiresViewX = Math.floor(hiresViewDistance / this.data.hires.tileSize.x);\n\t\tconst hiresViewZ = Math.floor(hiresViewDistance / this.data.hires.tileSize.z);\n\t\tthis.hiresTileManager.loadAroundTile(hiresX, hiresZ, hiresViewX, hiresViewZ);\n\n\t\tfor (let i = 0; i < this.lowresTileManager.length; i++) {\n\t\t\tconst lod = i + 1;\n\t\t\tconst scale = Math.pow(this.data.lowres.lodFactor, lod - 1);\n\t\t\tconst lowresX = Math.floor(x / (this.data.lowres.tileSize.x * scale));\n\t\t\tconst lowresZ = Math.floor(z / (this.data.lowres.tileSize.z * scale));\n\t\t\tconst lowresViewX = Math.floor(lowresViewDistance / this.data.lowres.tileSize.x);\n\t\t\tconst lowresViewZ = Math.floor(lowresViewDistance / this.data.lowres.tileSize.z);\n\t\t\tthis.lowresTileManager[i].loadAroundTile(lowresX, lowresZ, lowresViewX, lowresViewZ);\n\t\t}\n\t}\n\n    /**\n     * Loads the settings.json file for this map\n     * @returns {Promise<Object>}\n     */\n    loadSettingsFile() {\n        return new Promise((resolve, reject) => {\n            alert(this.events, `Loading settings for map '${this.data.id}'...`, \"fine\");\n\n            let loader = new FileLoader();\n            loader.setResponseType(\"json\");\n            loader.load(this.data.settingsUrl + \"?\" + generateCacheHash(),\n                resolve,\n                () => {},\n                () => reject(`Failed to load the settings.json for map: ${this.data.id}`)\n            )\n        });\n    }\n\n\t/**\n\t * Loads the textures.json file for this map\n\t * @returns {Promise<Object>}\n\t */\n\tloadTexturesFile() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\talert(this.events, `Loading textures for map '${this.data.id}'...`, \"fine\");\n\n\t\t\tlet loader = new FileLoader();\n\t\t\tloader.setResponseType(\"json\");\n\t\t\tloader.load(this.data.texturesUrl + \"?\" + generateCacheHash(),\n\t\t\t\tresolve,\n\t\t\t\t() => {},\n\t\t\t\t() => reject(`Failed to load the textures.json for map: ${this.data.id}`)\n\t\t\t)\n\t\t});\n\t}\n\n\t/**\n\t * Creates a hires Material with the given textures\n\t * @param vertexShader {string}\n\t * @param fragmentShader {string}\n\t * @param uniforms {object}\n\t * @param textures {{\n\t *     resourcePath: string,\n\t *     color: number[],\n\t *     halfTransparent: boolean,\n\t *     texture: string\n\t * }[]} the textures-data\n\t * @returns {ShaderMaterial[]} the hires Material (array because its a multi-material)\n\t */\n\tcreateHiresMaterial(vertexShader, fragmentShader, uniforms, textures) {\n\t\tlet materials = [];\n\t\tif (!Array.isArray(textures)) throw new Error(\"Invalid texture.json: 'textures' is not an array!\")\n\t\tfor (let i = 0; i < textures.length; i++) {\n\t\t\tlet textureSettings = textures[i];\n\n\t\t\tlet color = textureSettings.color;\n\t\t\tif (!Array.isArray(color) || color.length < 4){\n\t\t\t\tcolor = [0, 0, 0, 0];\n\t\t\t}\n\n\t\t\tlet opaque = color[3] === 1;\n\t\t\tlet transparent = !!textureSettings.halfTransparent;\n\n\t\t\tlet texture = new Texture();\n\t\t\ttexture.image = stringToImage(textureSettings.texture);\n\n\t\t\ttexture.anisotropy = 1;\n\t\t\ttexture.generateMipmaps = opaque || transparent;\n\t\t\ttexture.magFilter = NearestFilter;\n\t\t\ttexture.minFilter = texture.generateMipmaps ? NearestMipMapLinearFilter : NearestFilter;\n\t\t\ttexture.wrapS = ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = ClampToEdgeWrapping;\n\t\t\ttexture.flipY = false;\n\t\t\ttexture.flatShading = true;\n\t\t\ttexture.image.addEventListener(\"load\", () => texture.needsUpdate = true);\n\n\t\t\tthis.loadedTextures.push(texture);\n\n\t\t\tlet material = new ShaderMaterial({\n\t\t\t\tuniforms: {\n\t\t\t\t\t...uniforms,\n\t\t\t\t\ttextureImage: {\n\t\t\t\t\t\ttype: 't',\n\t\t\t\t\t\tvalue: texture\n\t\t\t\t\t},\n\t\t\t\t\ttransparent: { value: transparent }\n\t\t\t\t},\n\t\t\t\tvertexShader: vertexShader,\n\t\t\t\tfragmentShader: fragmentShader,\n\t\t\t\ttransparent: transparent,\n\t\t\t\tdepthWrite: true,\n\t\t\t\tdepthTest: true,\n\t\t\t\tvertexColors: VertexColors,\n\t\t\t\tside: FrontSide,\n\t\t\t\twireframe: false,\n\t\t\t});\n\n\t\t\tmaterial.needsUpdate = true;\n\t\t\tmaterials[i] = material;\n\t\t}\n\n\t\treturn materials;\n\t}\n\n\t/**\n\t * Creates a lowres Material\n\t * @param vertexShader {string}\n\t * @param fragmentShader {string}\n\t * @param uniforms {object}\n\t * @returns {ShaderMaterial} the hires Material\n\t */\n\tcreateLowresMaterial(vertexShader, fragmentShader, uniforms) {\n\t\treturn new ShaderMaterial({\n\t\t\tuniforms: uniforms,\n\t\t\tvertexShader: vertexShader,\n\t\t\tfragmentShader: fragmentShader,\n\t\t\ttransparent: false,\n\t\t\tdepthWrite: true,\n\t\t\tdepthTest: true,\n\t\t\tvertexColors: VertexColors,\n\t\t\tside: FrontSide,\n\t\t\twireframe: false\n\t\t});\n\t}\n\n\tunload() {\n\t\tif (this.hiresTileManager) this.hiresTileManager.unload();\n\t\tthis.hiresTileManager = null;\n\n\t\tif (this.lowresTileManager) {\n\t\t\tfor (let i = 0; i < this.lowresTileManager.length; i++) {\n\t\t\t\tthis.lowresTileManager[i].unload();\n\t\t\t}\n\t\t\tthis.lowresTileManager = null;\n\t\t}\n\n\t\tif (this.hiresMaterial) this.hiresMaterial.forEach(material => material.dispose());\n\t\tthis.hiresMaterial = null;\n\n\t\tif (this.lowresMaterial) this.lowresMaterial.dispose();\n\t\tthis.lowresMaterial = null;\n\n\t\tthis.loadedTextures.forEach(texture => texture.dispose());\n\t\tthis.loadedTextures = [];\n\t}\n\n\t/**\n\t * Ray-traces and returns the terrain-height at a specific location, returns <code>false</code> if there is no map-tile loaded at that location\n\t * @param x {number}\n\t * @param z {number}\n\t * @returns {boolean|number}\n\t */\n\tterrainHeightAt(x, z) {\n\t\tif (!this.isLoaded) return false;\n\n\t\tthis.raycaster.set(\n\t\t\tnew Vector3(x, 300, z), // ray-start\n\t\t\tnew Vector3(0, -1, 0) // ray-direction\n\t\t);\n\t\tthis.raycaster.near = 1;\n\t\tthis.raycaster.far = 300;\n\t\tthis.raycaster.layers.enableAll();\n\n\t\tlet hiresTileHash = hashTile(Math.floor((x - this.data.hires.translate.x) / this.data.hires.tileSize.x), Math.floor((z - this.data.hires.translate.z) / this.data.hires.tileSize.z));\n\t\tlet tile = this.hiresTileManager.tiles.get(hiresTileHash);\n\n\t\tif (tile?.model) {\n\t\t\ttry {\n\t\t\t\tlet intersects = this.raycaster.intersectObjects([tile.model]);\n\t\t\t\tif (intersects.length > 0) {\n\t\t\t\t\treturn intersects[0].point.y;\n\t\t\t\t}\n\t\t\t} catch (ignore) {\n\t\t\t\t//empty\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.lowresTileManager.length; i++) {\n\t\t\tconst lod = i + 1;\n\t\t\tconst scale = Math.pow(this.data.lowres.lodFactor, lod - 1);\n\t\t\tconst scaledTileSize = {\n\t\t\t\tx: this.data.lowres.tileSize.x * scale,\n\t\t\t\tz: this.data.lowres.tileSize.z * scale\n\t\t\t}\n\t\t\tconst tileX = Math.floor(x / scaledTileSize.x);\n\t\t\tconst tileZ = Math.floor(z / scaledTileSize.z);\n\t\t\tlet lowresTileHash = hashTile(tileX, tileZ);\n\t\t\ttile = this.lowresTileManager[i].tiles.get(lowresTileHash);\n\n\t\t\tif (!tile || !tile.model) continue;\n\n\t\t\tconst texture = tile.model.material.uniforms?.textureImage?.value?.image;\n\t\t\tif (texture == null) continue;\n\n\t\t\tconst color = getPixel(texture, x - tileX * scaledTileSize.x, z - tileZ * scaledTileSize.z + this.data.lowres.tileSize.z + 1);\n\n\t\t\tlet heightUnsigned = color[1] * 256.0 + color[2];\n\t\t\tif (heightUnsigned >= 32768.0) {\n\t\t\t\treturn -(65535.0 - heightUnsigned);\n\t\t\t} else {\n\t\t\t\treturn heightUnsigned;\n\t\t\t}\n\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tdispose() {\n\t\tthis.unload();\n\t}\n\n\t/**\n\t * @returns {boolean}\n\t */\n\tget isLoaded() {\n\t\treturn !!(this.hiresMaterial && this.lowresMaterial);\n\t}\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nexport const SKY_FRAGMENT_SHADER = `\nuniform float sunlightStrength;\nuniform float ambientLight;\nuniform vec3 skyColor;\n\nvarying vec3 vPosition;\n\nvoid main() {\n\tfloat horizonWidth = 0.005;\n\tfloat horizonHeight = 0.0;\n\t\n\tvec4 color = vec4(skyColor * max(sunlightStrength * sunlightStrength, ambientLight), 1.0);\n\tfloat voidMultiplier = (clamp(vPosition.y - horizonHeight, -horizonWidth, horizonWidth) + horizonWidth) / (horizonWidth * 2.0);\n\tcolor.rgb *= voidMultiplier;\n\n\tgl_FragColor = color;\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nexport const SKY_VERTEX_SHADER = `\nvarying vec3 vPosition;\nvoid main() {\n\tvPosition = position;\n\t\n\tgl_Position = \n\t\tprojectionMatrix *\n\t\tmodelViewMatrix *\n\t\tvec4(position, 1);\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {BackSide, Mesh, Scene, ShaderMaterial, SphereGeometry} from 'three';\n\nimport {SKY_FRAGMENT_SHADER} from './SkyFragmentShader';\nimport {SKY_VERTEX_SHADER} from './SkyVertexShader';\n\nexport class SkyboxScene extends Scene {\n\n\tconstructor(uniforms) {\n\t\tsuper();\n\n\t\tthis.autoUpdate = false;\n\n\t\tObject.defineProperty(this, 'isSkyboxScene', {value: true});\n\n\t\tlet geometry = new SphereGeometry(1, 40, 5);\n\t\tlet material = new ShaderMaterial({\n\t\t\tuniforms: uniforms,\n\t\t\tvertexShader: SKY_VERTEX_SHADER,\n\t\t\tfragmentShader: SKY_FRAGMENT_SHADER,\n\t\t\tside: BackSide\n\t\t});\n\t\tlet skybox = new Mesh(geometry, material);\n\n\t\tthis.add(skybox);\n\t}\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector3} from \"three\";\nimport {dispatchEvent} from \"../util/Utils\";\nimport {Map} from \"../map/Map\";\n\nexport class ControlsManager {\n\n\t/**\n\t * @param mapViewer {MapViewer}\n\t * @param camera {CombinedCamera}\n\t */\n\tconstructor(mapViewer, camera) {\n\t\tObject.defineProperty( this, 'isControlsManager', { value: true } );\n\n\t\tthis.data = {\n\t\t\tmapViewer: null,\n\t\t\tcamera: null,\n\t\t\tcontrols: null,\n\t\t\tposition: new Vector3(0, 0, 0),\n\t\t\trotation: 0,\n\t\t\tangle: 0,\n\t\t\ttilt: 0,\n\t\t};\n\n\t\tthis.mapViewer = mapViewer;\n\t\tthis.camera = camera;\n\n\t\t/** @type {Vector3} */\n\t\tthis.lastPosition = this.position.clone();\n\t\tthis.lastRotation = this.rotation;\n\t\tthis.lastAngle = this.angle;\n\t\tthis.lastDistance = this.distance;\n\t\tthis.lastOrtho = this.ortho;\n\t\tthis.lastTilt = this.tilt;\n\n\t\tthis.lastMapUpdatePosition = this.position.clone();\n\t\tthis.lastMapUpdateDistance = this.distance;\n\n\t\tthis.averageDeltaTime = 16;\n\n\t\tthis._controls = null;\n\n\t\t// start\n\t\tthis.distance = 300;\n\t\tthis.position.set(0, 0, 0);\n\t\tthis.rotation = 0;\n\t\tthis.angle = 0;\n\t\tthis.tilt = 0;\n\t\tthis.ortho = 0;\n\n\t\tthis.updateCamera();\n\t}\n\n\t/**\n\t * @param deltaTime {number}\n\t * @param map {Map}\n\t */\n\tupdate(deltaTime, map) {\n\t\tif (deltaTime > 50) deltaTime = 50; // assume min 20 UPS\n\t\tthis.averageDeltaTime = this.averageDeltaTime * 0.9 + deltaTime * 0.1; // average delta-time to avoid choppy controls on lag-spikes\n\n\t\tif (this._controls) this._controls.update(this.averageDeltaTime, map);\n\n\t\tthis.updateCamera();\n\t}\n\n\tupdateCamera() {\n\t\tlet valueChanged = this.isValueChanged();\n\n\t\tif (valueChanged) {\n\t\t\tthis.resetValueChanged();\n\n\t\t\t// wrap rotation\n\t\t\twhile (this.rotation >= Math.PI) this.rotation -= Math.PI * 2;\n\t\t\twhile (this.rotation <= -Math.PI) this.rotation += Math.PI * 2;\n\n\t\t\t// prevent problems with the rotation when the angle is 0 (top-down) or distance is 0 (first-person)\n\t\t\tlet rotatableAngle = this.angle;\n\t\t\tif (Math.abs(rotatableAngle) <= 0.0001) rotatableAngle = 0.0001;\n\t\t\telse if (Math.abs(rotatableAngle) - Math.PI <= 0.0001) rotatableAngle = rotatableAngle - 0.0001;\n\t\t\tlet rotatableDistance = this.distance;\n\t\t\tif (Math.abs(rotatableDistance) <= 0.0001) rotatableDistance = 0.0001;\n\n\t\t\t// fix distance for orthogonal-camera\n\t\t\tif (this.ortho > 0) {\n\t\t\t\trotatableDistance = MathUtils.lerp(rotatableDistance, Math.max(rotatableDistance, 300), Math.pow(this.ortho, 8));\n\t\t\t}\n\n\t\t\t// calculate rotationVector\n\t\t\tlet rotationVector = new Vector3(Math.sin(this.rotation), 0, -Math.cos(this.rotation)); // 0 is towards north\n\t\t\tlet angleRotationAxis = new Vector3(0, 1, 0).cross(rotationVector);\n\t\t\trotationVector.applyAxisAngle(angleRotationAxis, (Math.PI / 2) - rotatableAngle);\n\t\t\trotationVector.multiplyScalar(rotatableDistance);\n\n\t\t\t// position camera\n\t\t\tthis.camera.rotation.set(0, 0, 0);\n\t\t\tthis.camera.position.copy(this.position).sub(rotationVector);\n\t\t\tthis.camera.lookAt(this.position);\n\t\t\tthis.camera.rotateZ(this.tilt + rotatableAngle < 0 ? Math.PI : 0);\n\n\t\t\t// optimize far/near planes\n\t\t\tif (this.ortho <= 0) {\n\t\t\t\tlet near = MathUtils.clamp(rotatableDistance / 1000, 0.01, 1);\n\t\t\t\tlet far = MathUtils.clamp(rotatableDistance * 2, Math.max(near + 1, 2000), rotatableDistance + 5000);\n\t\t\t\tif (far - near > 10000) near = far - 10000;\n\t\t\t\tthis.camera.near = near;\n\t\t\t\tthis.camera.far = far;\n\t\t\t} else if (this.angle === 0) {\n\t\t\t\tthis.camera.near = 1;\n\t\t\t\tthis.camera.far = rotatableDistance + 300;\n\t\t\t} else {\n\t\t\t\tthis.camera.near = 1;\n\t\t\t\tthis.camera.far = 100000;\n\t\t\t}\n\n\t\t\t// event\n\t\t\tdispatchEvent(this.mapViewer.events, \"bluemapCameraMoved\", {\n\t\t\t\tcontrolsManager: this,\n\t\t\t\tcamera: this.camera\n\t\t\t});\n\t\t}\n\n\t\t// if the position changed, update map to show new position\n\t\tif (this.mapViewer.map) {\n\t\t\tlet triggerDistance = 1;\n\t\t\tif (valueChanged) {\n\t\t\t\tif (this.distance > 300) {\n\t\t\t\t\ttriggerDistance = this.mapViewer.data.loadedLowresViewDistance * 0.5;\n\t\t\t\t} else {\n\t\t\t\t\ttriggerDistance = this.mapViewer.data.loadedHiresViewDistance * 0.5;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tMath.abs(this.lastMapUpdatePosition.x - this.position.x) >= triggerDistance ||\n\t\t\t\tMath.abs(this.lastMapUpdatePosition.z - this.position.z) >= triggerDistance ||\n\t\t\t\t(this.distance < 1000 && this.lastMapUpdateDistance > 1000)\n\t\t\t) {\n\t\t\t\tthis.lastMapUpdatePosition = this.position.clone();\n\t\t\t\tthis.lastMapUpdateDistance = this.distance;\n\t\t\t\tthis.mapViewer.loadMapArea(this.position.x, this.position.z);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Triggers an interaction on the screen (map), e.g. a mouse-click\n\t * @param screenPosition {THREE.Vector2} - Clicked position on the screen (usually event.x, event.y)\n\t * @param data {object} - Custom event data that will be added to the interaction-event\n\t */\n\thandleMapInteraction(screenPosition, data = {}) {\n\t\tthis.mapViewer.handleMapInteraction(screenPosition, data);\n\t}\n\n\tisValueChanged() {\n\t\treturn !(\n\t\t\tthis.data.position.equals(this.lastPosition) &&\n\t\t\tthis.data.rotation === this.lastRotation &&\n\t\t\tthis.data.angle === this.lastAngle &&\n\t\t\tthis.distance === this.lastDistance &&\n\t\t\tthis.ortho === this.lastOrtho &&\n\t\t\tthis.data.tilt === this.lastTilt\n\t\t);\n\t}\n\n\tresetValueChanged() {\n\t\tthis.lastPosition.copy(this.data.position);\n\t\tthis.lastRotation = this.data.rotation;\n\t\tthis.lastAngle = this.data.angle;\n\t\tthis.lastDistance = this.distance;\n\t\tthis.lastOrtho = this.ortho;\n\t\tthis.lastTilt = this.data.tilt;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget ortho() {\n\t\treturn this.camera.ortho;\n\t}\n\n\t/**\n\t * @param ortho {number}\n\t */\n\tset ortho(ortho) {\n\t\tthis.camera.ortho = ortho;\n\t}\n\n\tget distance() {\n\t\treturn this.camera.distance;\n\t}\n\n\tset distance(distance) {\n\t\tthis.camera.distance = distance;\n\t}\n\n\t/** @typedef ControlsLike {{\n\t * \t\tstart: function(controls: ControlsManager),\n\t * \t\tstop: function(),\n\t * \t\tupdate: function(deltaTime: number, map: Map)\n\t * \t}}\n\n\t/**\n\t * @param controls {ControlsLike}\n\t */\n\tset controls(controls) {\n\t\tif (this._controls && this._controls.stop)\n\t\t\tthis._controls.stop();\n\n\t\tthis._controls = controls;\n\t\tif (controls) this.data.controls = controls.data || null\n\n\t\tif (this._controls && this._controls.start)\n\t\t\tthis._controls.start(this);\n\t}\n\n\t/**\n\t * @returns {ControlsLike}\n\t */\n\tget controls() {\n\t\treturn this._controls;\n\t}\n\n\t/**\n\t * @returns {MapViewer}\n\t */\n\tget mapViewer() {\n\t\treturn this._mapViewer;\n\t}\n\n\t/**\n\t * @param value {MapViewer}\n\t */\n\tset mapViewer(value) {\n\t\tthis._mapViewer = value;\n\t\tthis.data.mapViewer = value.data;\n\t}\n\n\t/**\n\t * @returns {CombinedCamera}\n\t */\n\tget camera() {\n\t\treturn this._camera;\n\t}\n\n\t/**\n\t * @param value {CombinedCamera}\n\t */\n\tset camera(value) {\n\t\tthis._camera = value;\n\t\tthis.data.camera = value.data;\n\t}\n\n\t/**\n\t * @returns {Vector3}\n\t */\n\tget position() {\n\t\treturn this.data.position;\n\t}\n\n\t/**\n\t * @param value {Vector3}\n\t */\n\tset position(value) {\n\t\tthis.data.position = value;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget rotation() {\n\t\treturn this.data.rotation;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset rotation(value) {\n\t\tthis.data.rotation = value;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget angle() {\n\t\treturn this.data.angle;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset angle(value) {\n\t\tthis.data.angle = value;\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget tilt() {\n\t\treturn this.data.tilt;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset tilt(value) {\n\t\tthis.data.tilt = value;\n\t}\n}","/**\n * Taken from https://github.com/mrdoob/three.js/blob/master/examples/jsm/libs/stats.module.js\n */\nlet Stats = function () {\n\n    let mode = 0;\n\n    let container = document.createElement( 'div' );\n    container.style.cssText = 'position:absolute;bottom:5px;right:5px;cursor:pointer;opacity:0.9;z-index:10000';\n    container.addEventListener( 'click', function ( event ) {\n\n        event.preventDefault();\n        showPanel( ++ mode % container.children.length );\n\n    }, false );\n\n    //\n\n    function addPanel( panel ) {\n\n        container.appendChild( panel.dom );\n        return panel;\n\n    }\n\n    function showPanel( id ) {\n\n        for ( let i = 0; i < container.children.length; i ++ ) {\n\n            container.children[ i ].style.display = i === id ? 'block' : 'none';\n\n        }\n\n        mode = id;\n\n    }\n\n    function hide() {\n        showPanel(-1);\n    }\n\n    //\n\n    let beginTime = ( performance || Date ).now(), prevTime = beginTime, frames = 0;\n    let prevFrameTime = beginTime;\n\n    let fpsPanel = addPanel( new Stats.Panel( 'FPS', '#0ff', '#002' ) );\n    let msPanel = addPanel( new Stats.Panel( 'MS (render)', '#0f0', '#020' ) );\n    let lastFrameMsPanel = addPanel( new Stats.Panel( 'MS (all)', '#f80', '#210' ) );\n\n    let memPanel = null;\n    if ( self.performance && self.performance.memory ) {\n\n        memPanel = addPanel( new Stats.Panel( 'MB', '#f08', '#201' ) );\n\n    }\n\n    showPanel( 0 );\n\n    return {\n\n        REVISION: 16,\n\n        dom: container,\n\n        addPanel: addPanel,\n        showPanel: showPanel,\n        hide: hide,\n\n        begin: function () {\n\n            beginTime = ( performance || Date ).now();\n\n        },\n\n        end: function () {\n\n            frames ++;\n\n            let time = ( performance || Date ).now();\n\n            msPanel.update( time - beginTime, 200 );\n            lastFrameMsPanel.update( time - prevFrameTime, 200 )\n\n            if ( time >= prevTime + 1000 ) {\n\n                fpsPanel.update( ( frames * 1000 ) / ( time - prevTime ), 100 );\n\n                prevTime = time;\n                frames = 0;\n\n                if ( memPanel ) {\n\n                    let memory = performance.memory;\n                    memPanel.update( memory.usedJSHeapSize / 1048576, memory.jsHeapSizeLimit / 1048576 );\n\n                }\n\n            }\n\n            return time;\n\n        },\n\n        update: function () {\n\n            beginTime = this.end();\n            prevFrameTime = beginTime;\n\n        },\n\n        // Backwards Compatibility\n\n        domElement: container,\n        setMode: showPanel\n\n    };\n\n};\n\nStats.Panel = function ( name, fg, bg ) {\n\n    let min = Infinity, max = 0, round = Math.round;\n    let PR = round( window.devicePixelRatio || 1 );\n\n    let WIDTH = 160 * PR, HEIGHT = 96 * PR,\n        TEXT_X = 3 * PR, TEXT_Y = 3 * PR,\n        GRAPH_X = 3 * PR, GRAPH_Y = 15 * PR,\n        GRAPH_WIDTH = 154 * PR, GRAPH_HEIGHT = 77 * PR;\n\n    let canvas = document.createElement( 'canvas' );\n    canvas.width = WIDTH;\n    canvas.height = HEIGHT;\n    canvas.style.cssText = 'width:160px;height:96px';\n\n    let context = canvas.getContext( '2d' );\n    context.font = 'bold ' + ( 9 * PR ) + 'px Helvetica,Arial,sans-serif';\n    context.textBaseline = 'top';\n\n    context.fillStyle = bg;\n    context.fillRect( 0, 0, WIDTH, HEIGHT );\n\n    context.fillStyle = fg;\n    context.fillText( name, TEXT_X, TEXT_Y );\n    context.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n    context.fillStyle = bg;\n    context.globalAlpha = 0.9;\n    context.fillRect( GRAPH_X, GRAPH_Y, GRAPH_WIDTH, GRAPH_HEIGHT );\n\n    return {\n\n        dom: canvas,\n\n        update: function ( value, maxValue ) {\n\n            min = Math.min( min, value );\n            max = Math.max( max, value );\n\n            context.fillStyle = bg;\n            context.globalAlpha = 1;\n            context.fillRect( 0, 0, WIDTH, GRAPH_Y );\n            context.fillStyle = fg;\n            context.fillText( round( value ) + ' ' + name + ' (' + round( min ) + '-' + round( max ) + ')', TEXT_X, TEXT_Y );\n\n            context.drawImage( canvas, GRAPH_X + PR, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT, GRAPH_X, GRAPH_Y, GRAPH_WIDTH - PR, GRAPH_HEIGHT );\n\n            context.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, GRAPH_HEIGHT );\n\n            context.fillStyle = bg;\n            context.globalAlpha = 0.9;\n            context.fillRect( GRAPH_X + GRAPH_WIDTH - PR, GRAPH_Y, PR, round( ( 1 - ( value / maxValue ) ) * GRAPH_HEIGHT ) );\n\n        }\n\n    };\n\n};\n\nexport default Stats;","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const HIRES_VERTEX_SHADER = `\n#include <common>\n${ShaderChunk.logdepthbuf_pars_vertex}\n\nattribute float ao;\nattribute float sunlight;\nattribute float blocklight;\n\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vAo;\nvarying float vSunlight;\nvarying float vBlocklight;\n\nvoid main() {\n\tvPosition = position;\n\tvNormal = normal;\n\tvUv = uv;\n\tvColor = color;\n\tvAo = ao;\n\tvSunlight = sunlight;\n\tvBlocklight = blocklight;\n\t\n\tgl_Position = projectionMatrix * (viewMatrix * modelMatrix * vec4(position, 1));\n\t\n\t${ShaderChunk.logdepthbuf_vertex} \n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const HIRES_FRAGMENT_SHADER = `\n${ShaderChunk.logdepthbuf_pars_fragment}\n\n#ifndef texture\n\t#define texture texture2D\n#endif\n\nuniform sampler2D textureImage;\nuniform float sunlightStrength;\nuniform float ambientLight;\n\nvarying vec3 vPosition;\n//varying vec3 vWorldPosition;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvarying float vAo;\nvarying float vSunlight;\nvarying float vBlocklight;\n//varying float vDistance;\n\nvoid main() {\n\tvec4 color = texture(textureImage, vUv);\n\tif (color.a <= 0.01) discard;\n\t\n\t//apply vertex-color\n\tcolor.rgb *= vColor.rgb;\n\n\t//apply ao\n\tcolor.rgb *= vAo;\n\t\n\t//apply light\n\tfloat light = mix(vBlocklight, max(vSunlight, vBlocklight), sunlightStrength);\n\tcolor.rgb *= mix(ambientLight, 1.0, light / 15.0);\n\t\n\tgl_FragColor = color;\n\t\n\t${ShaderChunk.logdepthbuf_fragment}\n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const LOWRES_VERTEX_SHADER = `\n#include <common>\n${ShaderChunk.logdepthbuf_pars_vertex}\n\nuniform sampler2D textureImage;\nuniform vec2 tileSize;\nuniform vec2 textureSize;\n\nvarying vec3 vPosition;\nvarying vec3 vWorldPosition;\nvarying float vDistance;\n\nfloat metaToHeight(vec4 meta) {\n\tfloat heightUnsigned = meta.g * 65280.0 + meta.b * 255.0;\n\tif (heightUnsigned >= 32768.0) {\n\t\treturn -(65535.0 - heightUnsigned);\n\t} else {\n\t\treturn heightUnsigned;\t\n\t}\n}\n\nvec2 posToMetaUV(vec2 pos) {\n\treturn vec2(pos.x / textureSize.x, pos.y / textureSize.y + 0.5);\n}\n\nvoid main() {\n\tvPosition = position;\n\t\n\tvec4 meta = texture(textureImage, posToMetaUV(position.xz));\n\tvPosition.y = metaToHeight(meta) + 1.0 - position.x * 0.0001 - position.z * 0.0002; //including small offset-tilt to prevent z-fighting\n\t\n\tvec4 worldPos = modelMatrix * vec4(vPosition, 1);\n\tvec4 viewPos = viewMatrix * worldPos;\n\t\n\tvWorldPosition = worldPos.xyz;\n\tvDistance = -viewPos.z;\n\t\n\tgl_Position = projectionMatrix * viewPos;\n\t\t\n\t${ShaderChunk.logdepthbuf_vertex}\n}\n\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const LOWRES_FRAGMENT_SHADER = `\n${ShaderChunk.logdepthbuf_pars_fragment}\n\n#define PI 3.1415926535897932\n\n#ifndef texture\n\t#define texture texture2D\n#endif\n\nstruct TileMap {\n\tsampler2D map;\n\tfloat size;\n\tvec2 scale;\n\tvec2 translate;\n\tvec2 pos; \n};\n\nuniform float sunlightStrength;\nuniform float ambientLight;\nuniform TileMap hiresTileMap;\nuniform sampler2D textureImage;\nuniform vec2 tileSize;\nuniform vec2 textureSize;\nuniform float lod;\nuniform float lodScale;\n\nvarying vec3 vPosition;\nvarying vec3 vWorldPosition;\nvarying float vDistance;\n\nfloat metaToHeight(vec4 meta) {\n\tfloat heightUnsigned = meta.g * 65280.0 + meta.b * 255.0;\n\tif (heightUnsigned >= 32768.0) {\n\t\treturn -(65535.0 - heightUnsigned);\n\t} else {\n\t\treturn heightUnsigned;\t\n\t}\n}\n\nfloat metaToLight(vec4 meta) {\n\treturn meta.r * 255.0;\n}\n\nvec2 posToColorUV(vec2 pos) {\n\treturn vec2(pos.x / textureSize.x, min(pos.y, tileSize.y) / textureSize.y);\n}\n\nvec2 posToMetaUV(vec2 pos) {\n\treturn vec2(pos.x / textureSize.x, pos.y / textureSize.y + 0.5);\n}\n\n\nvoid main() {\n\t//discard if hires tile is loaded at that position\n\tif (vDistance < 900.0 && texture(hiresTileMap.map, ((vWorldPosition.xz - hiresTileMap.translate) / hiresTileMap.scale - hiresTileMap.pos) / hiresTileMap.size + 0.5).r > 0.75) discard;\n\t\n\tvec4 color = texture(textureImage, posToColorUV(vPosition.xz));\n\tvec4 meta = texture(textureImage, posToMetaUV(vPosition.xz));\n\t\n\tfloat height = metaToHeight(meta);\n\t\n\tfloat heightX = metaToHeight(texture(textureImage, posToMetaUV(vPosition.xz + vec2(1.0, 0.0))));\n\tfloat heightZ = metaToHeight(texture(textureImage, posToMetaUV(vPosition.xz + vec2(0.0, 1.0))));\n\tfloat heightDiff = ((height - heightX) + (height - heightZ)) / lodScale;\n\tfloat shade = clamp(heightDiff * 0.06, -0.2, 0.04);\n\t\n\tfloat ao = 0.0;\n\tfloat aoStrength = 0.0;\n\tif(lod == 1.0) {\n\t\taoStrength = smoothstep(PI - 0.8, PI - 0.2, acos(-clamp(viewMatrix[1][2], 0.0, 1.0)));\n\t\taoStrength *= 1.0 - smoothstep(300.0, 500.0, vDistance);\n\t\t\n\t\tif (aoStrength > 0.0) { \n\t\t\tconst float r = 3.0;\n\t\t\tconst float step = 0.2;\n\t\t\tconst float o = step / r * 0.1;\n\t\t\tfor (float vx = -r; vx <= r; vx++) {\n\t\t\t\tfor (float vz = -r; vz <= r; vz++) {\n\t\t\t\t\theightDiff = height - metaToHeight(texture(textureImage, posToMetaUV(vPosition.xz + vec2(vx * step, vz * step))));\n\t\t\t\t\tif (heightDiff < 0.0) {\n\t\t\t\t\t\tao -= o;            \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcolor.rgb += mix(shade, shade * 0.3 + ao, aoStrength);\n\t\n\tfloat blockLight = metaToLight(meta);\n\tfloat light = mix(blockLight, 15.0, sunlightStrength);\n\tcolor.rgb *= mix(ambientLight, 1.0, light / 15.0);\n\t\n\tgl_FragColor = color;\n\t\n\t${ShaderChunk.logdepthbuf_fragment}\n}\n\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {MathUtils, Matrix4, PerspectiveCamera} from \"three\";\n\nexport class CombinedCamera extends PerspectiveCamera {\n\n    /**\n     * @param fov {number}\n     * @param aspect {number}\n     * @param near {number}\n     * @param far {number}\n     * @param ortho {number}\n     */\n    constructor(fov, aspect, near, far, ortho) {\n        super(fov, aspect, near, far);\n\n        this.needsUpdate = true;\n\n        this.data = {\n            fov: this.fov,\n            aspect: this.aspect,\n            near: this.near,\n            far: this.far,\n            zoom: this.zoom,\n            ortho: ortho,\n            distance: 1,\n        };\n\n        // redirect parent properties\n        Object.defineProperty(this, \"fov\", {\n            get() { return this.data.fov },\n            set(value) { if (value !== this.data.fov) { this.data.fov = value; this.needsUpdate = true }}\n        });\n        Object.defineProperty(this, \"aspect\", {\n            get() { return this.data.aspect },\n            set(value) { if (value !== this.data.aspect) { this.data.aspect = value; this.needsUpdate = true }}\n        });\n        Object.defineProperty(this, \"near\", {\n            get() { return this.data.near },\n            set(value) { if (value !== this.data.near) { this.data.near = value; this.needsUpdate = true }}\n        });\n        Object.defineProperty(this, \"far\", {\n            get() { return this.data.far },\n            set(value) { if (value !== this.data.far) { this.data.far = value; this.needsUpdate = true }}\n        });\n        Object.defineProperty(this, \"zoom\", {\n            get() { return this.data.zoom },\n            set(value) { if (value !== this.data.zoom) { this.data.zoom = value; this.needsUpdate = true }}\n        });\n\n        this.updateProjectionMatrix();\n    }\n\n    updateProjectionMatrix() {\n        if (!this.needsUpdate) return;\n\n        if (!this.ortographicProjection)\n            this.ortographicProjection = new Matrix4();\n\n        if (!this.perspectiveProjection)\n            this.perspectiveProjection = new Matrix4();\n\n        if (!this.data)\n            this.data = {};\n\n        //copied from PerspectiveCamera\n        const near = this.near;\n        let top = near * Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom;\n        let height = 2 * top;\n        let width = this.aspect * height;\n        let left = - 0.5 * width;\n        const view = this.view;\n\n        if ( this.view !== null && this.view.enabled ) {\n\n            const fullWidth = view.fullWidth,\n                fullHeight = view.fullHeight;\n\n            left += view.offsetX * width / fullWidth;\n            top -= view.offsetY * height / fullHeight;\n            width *= view.width / fullWidth;\n            height *= view.height / fullHeight;\n\n        }\n\n        const skew = this.filmOffset;\n        if ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n        // this part different to PerspectiveCamera\n        let normalizedOrtho = -Math.pow(this.ortho - 1, 6) + 1;\n        let orthoTop = Math.max(this.distance, 0.0001) * Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom;\n        let orthoHeight = 2 * orthoTop;\n        let orthoWidth = this.aspect * orthoHeight;\n        let orthoLeft = - 0.5 * orthoWidth;\n\n        this.perspectiveProjection.makePerspective( left, left + width, top, top - height, near, this.far );\n        this.ortographicProjection.makeOrthographic( orthoLeft, orthoLeft + orthoWidth, orthoTop, orthoTop - orthoHeight, near, this.far );\n\n        for (let i = 0; i < 16; i++){\n            this.projectionMatrix.elements[i] = (this.perspectiveProjection.elements[i] * (1 - normalizedOrtho)) + (this.ortographicProjection.elements[i] * normalizedOrtho);\n        }\n        // to here\n\n        this.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n        this.needsUpdate = false;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get isPerspectiveCamera() {\n        return this.ortho < 1;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get isOrthographicCamera() {\n        return !this.isPerspectiveCamera;\n    }\n\n    /**\n     * @returns {string}\n     */\n    get type() {\n        return this.isPerspectiveCamera ? 'PerspectiveCamera' : 'OrthographicCamera';\n    }\n\n    /**\n     * @param type {string}\n     */\n    set type(type) {\n        //ignore\n    }\n\n    /**\n     * @returns {number}\n     */\n    get ortho() {\n        return this.data.ortho;\n    }\n\n    /**\n     * @param value {number}\n     */\n    set ortho(value) {\n        if (value !== this.data.ortho){\n            this.data.ortho = value;\n            this.needsUpdate = true;\n        }\n    }\n\n    /**\n     * @returns {number}\n     */\n    get distance() {\n        return this.data.distance;\n    }\n\n    /**\n     * @param value {number}\n     */\n    set distance(value) {\n        if (value !== this.data.distance) {\n            this.data.distance = value;\n            this.needsUpdate = true;\n        }\n    }\n\n}","/**\n * @author mrdoob / http://mrdoob.com/\n *\n * adapted for bluemap's purposes\n */\n\nimport {\n    Matrix4,\n    Object3D, Vector2,\n    Vector3\n} from \"three\";\nimport {dispatchEvent, htmlToElement} from \"./Utils\";\n\nvar CSS2DObject = function ( element ) {\n\n    Object3D.call( this );\n\n    this.element = document.createElement(\"div\");\n    let parent = element.parentNode;\n    parent.replaceChild(this.element, element);\n    this.element.appendChild(element);\n\n    this.element.style.position = 'absolute';\n\n    this.anchor = new Vector2();\n\n    this.events = null;\n\n    this.addEventListener( 'removed', function () {\n\n        this.traverse( function ( object ) {\n\n            if ( object.element instanceof Element && object.element.parentNode !== null ) {\n\n                object.element.parentNode.removeChild( object.element );\n\n            }\n\n        } );\n\n    } );\n\n    let lastClick = -1;\n    let handleClick = event => {\n        let doubleTap = false;\n\n        let now = Date.now();\n        if (now - lastClick < 500){\n            doubleTap = true;\n        }\n\n        lastClick = now;\n\n        let data = {doubleTap: doubleTap};\n\n        if (this.onClick( {event: event, data: data} )) {\n            event.preventDefault();\n            event.stopPropagation();\n        } else {\n            // fire event\n            dispatchEvent(this.events, \"bluemapMapInteraction\", {\n                data: data,\n                object: this,\n            });\n        }\n    }\n\n    this.element.addEventListener(\"click\", handleClick);\n    this.element.addEventListener(\"touch\", handleClick);\n\n};\n\nCSS2DObject.prototype = Object.create( Object3D.prototype );\nCSS2DObject.prototype.constructor = CSS2DObject;\n\n//\n\nvar CSS2DRenderer = function (events = null) {\n\n    var _this = this;\n\n    var _width, _height;\n    var _widthHalf, _heightHalf;\n\n    var vector = new Vector3();\n    var viewMatrix = new Matrix4();\n    var viewProjectionMatrix = new Matrix4();\n\n    var cache = {\n        objects: new WeakMap()\n    };\n\n    var domElement = document.createElement( 'div' );\n    domElement.style.overflow = 'hidden';\n\n    this.domElement = domElement;\n\n    this.events = events;\n\n    this.getSize = function () {\n\n        return {\n            width: _width,\n            height: _height\n        };\n\n    };\n\n    this.setSize = function ( width, height ) {\n\n        _width = width;\n        _height = height;\n\n        _widthHalf = _width / 2;\n        _heightHalf = _height / 2;\n\n        domElement.style.width = width + 'px';\n        domElement.style.height = height + 'px';\n\n    };\n\n    var renderObject = function ( object, scene, camera, parentVisible ) {\n\n        if ( object instanceof CSS2DObject ) {\n\n            object.events = _this.events;\n\n            object.onBeforeRender( _this, scene, camera );\n\n            vector.setFromMatrixPosition( object.matrixWorld );\n            vector.applyMatrix4( viewProjectionMatrix );\n\n            var element = object.element;\n            var style = 'translate(' + ( vector.x * _widthHalf + _widthHalf - object.anchor.x) + 'px,' + ( - vector.y * _heightHalf + _heightHalf - object.anchor.y ) + 'px)';\n\n            element.style.WebkitTransform = style;\n            element.style.MozTransform = style;\n            element.style.oTransform = style;\n            element.style.transform = style;\n\n            element.style.display = ( parentVisible && object.visible && vector.z >= - 1 && vector.z <= 1 && element.style.opacity !== \"0\" ) ? '' : 'none';\n\n            var objectData = {\n                distanceToCameraSquared: getDistanceToSquared( camera, object )\n            };\n\n            cache.objects.set( object, objectData );\n\n            if ( element.parentNode !== domElement ) {\n\n                domElement.appendChild( element );\n\n            }\n\n            object.onAfterRender( _this, scene, camera );\n\n        }\n\n        for ( var i = 0, l = object.children.length; i < l; i ++ ) {\n\n            renderObject( object.children[ i ], scene, camera, parentVisible && object.visible );\n\n        }\n\n    };\n\n    var getDistanceToSquared = function () {\n\n        var a = new Vector3();\n        var b = new Vector3();\n\n        return function ( object1, object2 ) {\n\n            a.setFromMatrixPosition( object1.matrixWorld );\n            b.setFromMatrixPosition( object2.matrixWorld );\n\n            return a.distanceToSquared( b );\n\n        };\n\n    }();\n\n    var filterAndFlatten = function ( scene ) {\n\n        var result = [];\n\n        scene.traverse( function ( object ) {\n\n            if ( object instanceof CSS2DObject ) result.push( object );\n\n        } );\n\n        return result;\n\n    };\n\n    var zOrder = function ( scene ) {\n\n        var sorted = filterAndFlatten( scene ).sort( function ( a, b ) {\n\n            var distanceA = cache.objects.get( a ).distanceToCameraSquared;\n            var distanceB = cache.objects.get( b ).distanceToCameraSquared;\n\n            return distanceA - distanceB;\n\n        } );\n\n        var zMax = sorted.length;\n\n        for ( var i = 0, l = sorted.length; i < l; i ++ ) {\n\n            sorted[ i ].element.style.zIndex = zMax - i;\n\n        }\n\n    };\n\n    this.render = function ( scene, camera ) {\n\n        if ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n        if ( camera.parent === null ) camera.updateMatrixWorld();\n\n        viewMatrix.copy( camera.matrixWorldInverse );\n        viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, viewMatrix );\n\n        renderObject( scene, scene, camera, true );\n        zOrder( scene );\n\n    };\n\n};\n\nexport { CSS2DObject, CSS2DRenderer };","import {\n\tShaderLib,\n\tShaderMaterial,\n\tUniformsLib,\n\tUniformsUtils,\n\tVector2\n} from \"three\";\n/**\n * parameters = {\n *  color: <hex>,\n *  linewidth: <float>,\n *  dashed: <boolean>,\n *  dashScale: <float>,\n *  dashSize: <float>,\n *  gapSize: <float>,\n *  resolution: <Vector2>, // to be set by renderer\n * }\n */\n\nUniformsLib.line = {\n\n\tlinewidth: { value: 1 },\n\tresolution: { value: new Vector2( 1, 1 ) },\n\tdashScale: { value: 1 },\n\tdashSize: { value: 1 },\n\tgapSize: { value: 1 },\n\topacity: { value: 1 }\n\n};\n\nShaderLib[ 'line' ] = {\n\n\tuniforms: UniformsUtils.merge( [\n\t\tUniformsLib.common,\n\t\tUniformsLib.fog,\n\t\tUniformsLib.line\n\t] ),\n\n\tvertexShader:\n\t\t`\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\t\t\n\t\tvarying float vDistance;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\t\t\t\n\t\t\tvDistance = -mvPosition.z;\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t`,\n\n\tfragmentShader:\n\t\t`\n\t\t#define FLT_MAX 3.402823466e+38\n\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\t\n\t\tuniform float fadeDistanceMax;\n\t\tuniform float fadeDistanceMin;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\t\t\n\t\tvarying float vDistance;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\t// distance fading\n\t\t\tfloat fdMax = FLT_MAX;\n\t\t\tif ( fadeDistanceMax > 0.0 ) fdMax = fadeDistanceMax;\n\t\t\t\n\t\t\tfloat minDelta = (vDistance - fadeDistanceMin) / fadeDistanceMin;\n\t\t\tfloat maxDelta = (vDistance - fadeDistanceMax) / (fadeDistanceMax * 0.5);\n\t\t\tfloat distanceOpacity = min(\n\t\t\t\tclamp(minDelta, 0.0, 1.0),\n\t\t\t\t1.0 - clamp(maxDelta + 1.0, 0.0, 1.0)\n\t\t\t);\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity * distanceOpacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t`\n};\n\nvar LineMaterial = function ( parameters ) {\n\n\tShaderMaterial.call( this, {\n\n\t\ttype: 'LineMaterial',\n\n\t\tuniforms: UniformsUtils.clone( ShaderLib[ 'line' ].uniforms ),\n\n\t\tvertexShader: ShaderLib[ 'line' ].vertexShader,\n\t\tfragmentShader: ShaderLib[ 'line' ].fragmentShader,\n\n\t\tclipping: true // required for clipping support\n\n\t} );\n\n\tthis.dashed = false;\n\n\tObject.defineProperties( this, {\n\n\t\tcolor: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.diffuse.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.diffuse.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tlinewidth: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.linewidth.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.linewidth.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tdashScale: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.dashScale.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.dashScale.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tdashSize: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.dashSize.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.dashSize.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tgapSize: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.gapSize.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.gapSize.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\topacity: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.opacity.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.opacity.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tresolution: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.resolution.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.resolution.value.copy( value );\n\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n\tthis.setValues( parameters );\n\n};\n\nLineMaterial.prototype = Object.create( ShaderMaterial.prototype );\nLineMaterial.prototype.constructor = LineMaterial;\n\nLineMaterial.prototype.isLineMaterial = true;\n\nexport { LineMaterial };\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const MARKER_FILL_VERTEX_SHADER = `\n#include <common>\n${ShaderChunk.logdepthbuf_pars_vertex}\n\nvarying vec3 vPosition;\n//varying vec3 vWorldPosition;\n//varying vec3 vNormal;\n//varying vec2 vUv;\n//varying vec3 vColor;\nvarying float vDistance;\n\nvoid main() {\n\tvec4 worldPos = modelMatrix * vec4(position, 1);\n\tvec4 viewPos = viewMatrix * worldPos;\n\t\n\tvPosition = position;\n\t//vWorldPosition = worldPos.xyz;\n\t//vNormal = normal;\n\t//vUv = uv;\n\t//vColor = vec3(1.0);\n\tvDistance = -viewPos.z;\n\t\n\tgl_Position = projectionMatrix * viewPos;\n\t\n\t${ShaderChunk.logdepthbuf_vertex} \n}\n`;\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the 'Software'), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport { ShaderChunk } from 'three';\n\nexport const MARKER_FILL_FRAGMENT_SHADER = `\n${ShaderChunk.logdepthbuf_pars_fragment}\n\n#define FLT_MAX 3.402823466e+38\n\nvarying vec3 vPosition;\n//varying vec3 vWorldPosition;\n//varying vec3 vNormal;\n//varying vec2 vUv;\n//varying vec3 vColor;\nvarying float vDistance;\n\nuniform vec3 markerColor;\nuniform float markerOpacity;\n\nuniform float fadeDistanceMax;\nuniform float fadeDistanceMin;\n\nvoid main() {\n\tvec4 color = vec4(markerColor, markerOpacity);\n\t\n\t// distance fading\n\tfloat fdMax = FLT_MAX;\n\tif ( fadeDistanceMax > 0.0 ) fdMax = fadeDistanceMax;\n\t\n\tfloat minDelta = (vDistance - fadeDistanceMin) / fadeDistanceMin;\n\tfloat maxDelta = (vDistance - fadeDistanceMax) / (fadeDistanceMax * 0.5);\n\tfloat distanceOpacity = min(\n\t\tclamp(minDelta, 0.0, 1.0),\n\t\t1.0 - clamp(maxDelta + 1.0, 0.0, 1.0)\n\t);\n\t\n\tcolor.a *= distanceOpacity;\n\t\n\t// apply vertex-color\n\t//color.rgb *= vColor.rgb;\n\t\n\tgl_FragColor = color;\n\t\n\t${ShaderChunk.logdepthbuf_fragment}\n}\n`;\n","import {\n\tBox3,\n\tFloat32BufferAttribute,\n\tInstancedBufferGeometry,\n\tInstancedInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tSphere,\n\tVector3,\n\tWireframeGeometry\n} from \"three\";\n\nvar LineSegmentsGeometry = function () {\n\n\tInstancedBufferGeometry.call( this );\n\n\tthis.type = 'LineSegmentsGeometry';\n\n\tvar positions = [ - 1, 2, 0, 1, 2, 0, - 1, 1, 0, 1, 1, 0, - 1, 0, 0, 1, 0, 0, - 1, - 1, 0, 1, - 1, 0 ];\n\tvar uvs = [ - 1, 2, 1, 2, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 2, 1, - 2 ];\n\tvar index = [ 0, 2, 1, 2, 3, 1, 2, 4, 3, 4, 5, 3, 4, 6, 5, 6, 7, 5 ];\n\n\tthis.setIndex( index );\n\tthis.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n};\n\nLineSegmentsGeometry.prototype = Object.assign( Object.create( InstancedBufferGeometry.prototype ), {\n\n\tconstructor: LineSegmentsGeometry,\n\n\tisLineSegmentsGeometry: true,\n\n\tapplyMatrix4: function ( matrix ) {\n\n\t\tvar start = this.attributes.instanceStart;\n\t\tvar end = this.attributes.instanceEnd;\n\n\t\tif ( start !== undefined ) {\n\n\t\t\tstart.applyMatrix4( matrix );\n\n\t\t\tend.applyMatrix4( matrix );\n\n\t\t\tstart.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetPositions: function ( array ) {\n\n\t\tvar lineSegments;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\tlineSegments = array;\n\n\t\t} else if ( Array.isArray( array ) ) {\n\n\t\t\tlineSegments = new Float32Array( array );\n\n\t\t}\n\n\t\tvar instanceBuffer = new InstancedInterleavedBuffer( lineSegments, 6, 1 ); // xyz, xyz\n\n\t\tthis.setAttribute( 'instanceStart', new InterleavedBufferAttribute( instanceBuffer, 3, 0 ) ); // xyz\n\t\tthis.setAttribute( 'instanceEnd', new InterleavedBufferAttribute( instanceBuffer, 3, 3 ) ); // xyz\n\n\t\t//\n\n\t\tthis.computeBoundingBox();\n\t\tthis.computeBoundingSphere();\n\n\t\treturn this;\n\n\t},\n\n\tsetColors: function ( array ) {\n\n\t\tvar colors;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\tcolors = array;\n\n\t\t} else if ( Array.isArray( array ) ) {\n\n\t\t\tcolors = new Float32Array( array );\n\n\t\t}\n\n\t\tvar instanceColorBuffer = new InstancedInterleavedBuffer( colors, 6, 1 ); // rgb, rgb\n\n\t\tthis.setAttribute( 'instanceColorStart', new InterleavedBufferAttribute( instanceColorBuffer, 3, 0 ) ); // rgb\n\t\tthis.setAttribute( 'instanceColorEnd', new InterleavedBufferAttribute( instanceColorBuffer, 3, 3 ) ); // rgb\n\n\t\treturn this;\n\n\t},\n\n\tfromWireframeGeometry: function ( geometry ) {\n\n\t\tthis.setPositions( geometry.attributes.position.array );\n\n\t\treturn this;\n\n\t},\n\n\tfromEdgesGeometry: function ( geometry ) {\n\n\t\tthis.setPositions( geometry.attributes.position.array );\n\n\t\treturn this;\n\n\t},\n\n\tfromMesh: function ( mesh ) {\n\n\t\tthis.fromWireframeGeometry( new WireframeGeometry( mesh.geometry ) );\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tfromLineSegments: function ( lineSegments ) {\n\n\t\tvar geometry = lineSegments.geometry;\n\n\t\tif ( geometry.isGeometry ) {\n\n\t\t\tthis.setPositions( geometry.vertices );\n\n\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\tthis.setPositions( geometry.attributes.position.array ); // assumes non-indexed\n\n\t\t}\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tcomputeBoundingBox: function () {\n\n\t\tvar box = new Box3();\n\n\t\treturn function computeBoundingBox() {\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.boundingBox = new Box3();\n\n\t\t\t}\n\n\t\t\tvar start = this.attributes.instanceStart;\n\t\t\tvar end = this.attributes.instanceEnd;\n\n\t\t\tif ( start !== undefined && end !== undefined ) {\n\n\t\t\t\tthis.boundingBox.setFromBufferAttribute( start );\n\n\t\t\t\tbox.setFromBufferAttribute( end );\n\n\t\t\t\tthis.boundingBox.union( box );\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tcomputeBoundingSphere: function () {\n\n\t\tvar vector = new Vector3();\n\n\t\treturn function computeBoundingSphere() {\n\n\t\t\tif ( this.boundingSphere === null ) {\n\n\t\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t\t}\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.computeBoundingBox();\n\n\t\t\t}\n\n\t\t\tvar start = this.attributes.instanceStart;\n\t\t\tvar end = this.attributes.instanceEnd;\n\n\t\t\tif ( start !== undefined && end !== undefined ) {\n\n\t\t\t\tvar center = this.boundingSphere.center;\n\n\t\t\t\tthis.boundingBox.getCenter( center );\n\n\t\t\t\tvar maxRadiusSq = 0;\n\n\t\t\t\tfor ( var i = 0, il = start.count; i < il; i ++ ) {\n\n\t\t\t\t\tvector.fromBufferAttribute( start, i );\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t\tvector.fromBufferAttribute( end, i );\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t}\n\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\t\tconsole.error( 'THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.', this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\ttoJSON: function () {\n\n\t},\n\n\tapplyMatrix: function ( matrix ) {\n\n\t\tconsole.warn( 'THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4().' );\n\n\t\treturn this.applyMatrix4( matrix );\n\n\t}\n\n} );\n\nexport { LineSegmentsGeometry };\n","\nimport { LineSegmentsGeometry } from \"./LineSegmentsGeometry\";\n\nvar LineGeometry = function () {\n\n\tLineSegmentsGeometry.call( this );\n\n\tthis.type = 'LineGeometry';\n\n};\n\nLineGeometry.prototype = Object.assign( Object.create( LineSegmentsGeometry.prototype ), {\n\n\tconstructor: LineGeometry,\n\n\tisLineGeometry: true,\n\n\tsetPositions: function ( array ) {\n\n\t\t// converts [ x1, y1, z1,  x2, y2, z2, ... ] to pairs format\n\n\t\tvar length = array.length - 3;\n\t\tvar points = new Float32Array( 2 * length );\n\n\t\tfor ( var i = 0; i < length; i += 3 ) {\n\n\t\t\tpoints[ 2 * i ] = array[ i ];\n\t\t\tpoints[ 2 * i + 1 ] = array[ i + 1 ];\n\t\t\tpoints[ 2 * i + 2 ] = array[ i + 2 ];\n\n\t\t\tpoints[ 2 * i + 3 ] = array[ i + 3 ];\n\t\t\tpoints[ 2 * i + 4 ] = array[ i + 4 ];\n\t\t\tpoints[ 2 * i + 5 ] = array[ i + 5 ];\n\n\t\t}\n\n\t\tLineSegmentsGeometry.prototype.setPositions.call( this, points );\n\n\t\treturn this;\n\n\t},\n\n\tsetColors: function ( array ) {\n\n\t\t// converts [ r1, g1, b1,  r2, g2, b2, ... ] to pairs format\n\n\t\tvar length = array.length - 3;\n\t\tvar colors = new Float32Array( 2 * length );\n\n\t\tfor ( var i = 0; i < length; i += 3 ) {\n\n\t\t\tcolors[ 2 * i ] = array[ i ];\n\t\t\tcolors[ 2 * i + 1 ] = array[ i + 1 ];\n\t\t\tcolors[ 2 * i + 2 ] = array[ i + 2 ];\n\n\t\t\tcolors[ 2 * i + 3 ] = array[ i + 3 ];\n\t\t\tcolors[ 2 * i + 4 ] = array[ i + 4 ];\n\t\t\tcolors[ 2 * i + 5 ] = array[ i + 5 ];\n\n\t\t}\n\n\t\tLineSegmentsGeometry.prototype.setColors.call( this, colors );\n\n\t\treturn this;\n\n\t},\n\n\tfromLine: function ( line ) {\n\n\t\tvar geometry = line.geometry;\n\n\t\tif ( geometry.isGeometry ) {\n\n\t\t\tthis.setPositions( geometry.vertices );\n\n\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\tthis.setPositions( geometry.attributes.position.array ); // assumes non-indexed\n\n\t\t}\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tcopy: function ( /* source */ ) {\n\n\t\treturn this;\n\n\t}\n\n} );\n\nexport { LineGeometry };\n","import {\n\tInstancedInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tLine3,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tVector3,\n\tVector4\n} from \"three\";\nimport { LineSegmentsGeometry } from \"./LineSegmentsGeometry\";\nimport { LineMaterial } from \"./LineMaterial\";\n\nvar LineSegments2 = function ( geometry, material ) {\n\n\tif ( geometry === undefined ) geometry = new LineSegmentsGeometry();\n\tif ( material === undefined ) material = new LineMaterial( { color: Math.random() * 0xffffff } );\n\n\tMesh.call( this, geometry, material );\n\n\tthis.type = 'LineSegments2';\n\n};\n\nLineSegments2.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n\tconstructor: LineSegments2,\n\n\tisLineSegments2: true,\n\n\tcomputeLineDistances: ( function () { // for backwards-compatability, but could be a method of LineSegmentsGeometry...\n\n\t\tvar start = new Vector3();\n\t\tvar end = new Vector3();\n\n\t\treturn function computeLineDistances() {\n\n\t\t\tvar geometry = this.geometry;\n\n\t\t\tvar instanceStart = geometry.attributes.instanceStart;\n\t\t\tvar instanceEnd = geometry.attributes.instanceEnd;\n\t\t\tvar lineDistances = new Float32Array( 2 * instanceStart.data.count );\n\n\t\t\tfor ( var i = 0, j = 0, l = instanceStart.data.count; i < l; i ++, j += 2 ) {\n\n\t\t\t\tstart.fromBufferAttribute( instanceStart, i );\n\t\t\t\tend.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\tlineDistances[ j ] = ( j === 0 ) ? 0 : lineDistances[ j - 1 ];\n\t\t\t\tlineDistances[ j + 1 ] = lineDistances[ j ] + start.distanceTo( end );\n\n\t\t\t}\n\n\t\t\tvar instanceDistanceBuffer = new InstancedInterleavedBuffer( lineDistances, 2, 1 ); // d0, d1\n\n\t\t\tgeometry.setAttribute( 'instanceDistanceStart', new InterleavedBufferAttribute( instanceDistanceBuffer, 1, 0 ) ); // d0\n\t\t\tgeometry.setAttribute( 'instanceDistanceEnd', new InterleavedBufferAttribute( instanceDistanceBuffer, 1, 1 ) ); // d1\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}() ),\n\n\traycast: ( function () {\n\n\t\tvar start = new Vector4();\n\t\tvar end = new Vector4();\n\n\t\tvar ssOrigin = new Vector4();\n\t\tvar ssOrigin3 = new Vector3();\n\t\tvar mvMatrix = new Matrix4();\n\t\tvar line = new Line3();\n\t\tvar closestPoint = new Vector3();\n\n\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\tif ( raycaster.camera === null ) {\n\n\t\t\t\tconsole.error( 'LineSegments2: \"Raycaster.camera\" needs to be set in order to raycast against LineSegments2.' );\n\n\t\t\t}\n\n\t\t\tvar threshold = ( raycaster.params.Line2 !== undefined ) ? raycaster.params.Line2.threshold || 0 : 0;\n\n\t\t\tvar ray = raycaster.ray;\n\t\t\tvar camera = raycaster.camera;\n\t\t\tvar projectionMatrix = camera.projectionMatrix;\n\n\t\t\tvar geometry = this.geometry;\n\t\t\tvar material = this.material;\n\t\t\tvar resolution = material.resolution;\n\t\t\tvar lineWidth = material.linewidth + threshold;\n\n\t\t\tvar instanceStart = geometry.attributes.instanceStart;\n\t\t\tvar instanceEnd = geometry.attributes.instanceEnd;\n\n\t\t\t// pick a point 1 unit out along the ray to avoid the ray origin\n\t\t\t// sitting at the camera origin which will cause \"w\" to be 0 when\n\t\t\t// applying the projection matrix.\n\t\t\tray.at( 1, ssOrigin );\n\n\t\t\t// ndc space [ - 1.0, 1.0 ]\n\t\t\tssOrigin.w = 1;\n\t\t\tssOrigin.applyMatrix4( camera.matrixWorldInverse );\n\t\t\tssOrigin.applyMatrix4( projectionMatrix );\n\t\t\tssOrigin.multiplyScalar( 1 / ssOrigin.w );\n\n\t\t\t// screen space\n\t\t\tssOrigin.x *= resolution.x / 2;\n\t\t\tssOrigin.y *= resolution.y / 2;\n\t\t\tssOrigin.z = 0;\n\n\t\t\tssOrigin3.copy( ssOrigin );\n\n\t\t\tvar matrixWorld = this.matrixWorld;\n\t\t\tmvMatrix.multiplyMatrices( camera.matrixWorldInverse, matrixWorld );\n\n\t\t\tfor ( var i = 0, l = instanceStart.count; i < l; i ++ ) {\n\n\t\t\t\tstart.fromBufferAttribute( instanceStart, i );\n\t\t\t\tend.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\tstart.w = 1;\n\t\t\t\tend.w = 1;\n\n\t\t\t\t// camera space\n\t\t\t\tstart.applyMatrix4( mvMatrix );\n\t\t\t\tend.applyMatrix4( mvMatrix );\n\n\t\t\t\t// clip space\n\t\t\t\tstart.applyMatrix4( projectionMatrix );\n\t\t\t\tend.applyMatrix4( projectionMatrix );\n\n\t\t\t\t// ndc space [ - 1.0, 1.0 ]\n\t\t\t\tstart.multiplyScalar( 1 / start.w );\n\t\t\t\tend.multiplyScalar( 1 / end.w );\n\n\t\t\t\t// skip the segment if it's outside the camera near and far planes\n\t\t\t\tvar isBehindCameraNear = start.z < - 1 && end.z < - 1;\n\t\t\t\tvar isPastCameraFar = start.z > 1 && end.z > 1;\n\t\t\t\tif ( isBehindCameraNear || isPastCameraFar ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// screen space\n\t\t\t\tstart.x *= resolution.x / 2;\n\t\t\t\tstart.y *= resolution.y / 2;\n\n\t\t\t\tend.x *= resolution.x / 2;\n\t\t\t\tend.y *= resolution.y / 2;\n\n\t\t\t\t// create 2d segment\n\t\t\t\tline.start.copy( start );\n\t\t\t\tline.start.z = 0;\n\n\t\t\t\tline.end.copy( end );\n\t\t\t\tline.end.z = 0;\n\n\t\t\t\t// get closest point on ray to segment\n\t\t\t\tvar param = line.closestPointToPointParameter( ssOrigin3, true );\n\t\t\t\tline.at( param, closestPoint );\n\n\t\t\t\t// check if the intersection point is within clip space\n\t\t\t\tvar zPos = MathUtils.lerp( start.z, end.z, param );\n\t\t\t\tvar isInClipSpace = zPos >= - 1 && zPos <= 1;\n\n\t\t\t\tvar isInside = ssOrigin3.distanceTo( closestPoint ) < lineWidth * 0.5;\n\n\t\t\t\tif ( isInClipSpace && isInside ) {\n\n\t\t\t\t\tline.start.fromBufferAttribute( instanceStart, i );\n\t\t\t\t\tline.end.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\t\tline.start.applyMatrix4( matrixWorld );\n\t\t\t\t\tline.end.applyMatrix4( matrixWorld );\n\n\t\t\t\t\tvar pointOnLine = new Vector3();\n\t\t\t\t\tvar point = new Vector3();\n\n\t\t\t\t\tray.distanceSqToSegment( line.start, line.end, point, pointOnLine );\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tpoint: point,\n\t\t\t\t\t\tpointOnLine: pointOnLine,\n\t\t\t\t\t\tdistance: ray.origin.distanceTo( point ),\n\n\t\t\t\t\t\tobject: this,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: i,\n\t\t\t\t\t\tuv: null,\n\t\t\t\t\t\tuv2: null,\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}() )\n\n} );\n\nexport { LineSegments2 };\n","\nimport { LineSegments2 } from \"./LineSegments2\";\nimport { LineGeometry } from \"./LineGeometry\";\nimport { LineMaterial } from \"./LineMaterial\";\n\nvar Line2 = function ( geometry, material ) {\n\n\tif ( geometry === undefined ) geometry = new LineGeometry();\n\tif ( material === undefined ) material = new LineMaterial( { color: Math.random() * 0xffffff } );\n\n\tLineSegments2.call( this, geometry, material );\n\n\tthis.type = 'Line2';\n\n};\n\nLine2.prototype = Object.assign( Object.create( LineSegments2.prototype ), {\n\n\tconstructor: Line2,\n\n\tisLine2: true\n\n} );\n\nexport { Line2 };\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {MathUtils, Object3D, Vector3} from \"three\";\n\nexport class Marker extends Object3D {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super();\n        Object.defineProperty(this, 'isMarker', {value: true});\n\n        this.data = {\n            id: markerId,\n            type: \"marker\",\n            position: this.position,\n            visible: this.visible\n        };\n\n        // redirect parent properties\n        Object.defineProperty(this, \"position\", {\n            get() { return this.data.position },\n            set(value) { this.data.position = value }\n        });\n        Object.defineProperty(this, \"visible\", {\n            get() { return this.data.visible },\n            set(value) { this.data.visible = value }\n        });\n    }\n\n    dispose() {}\n\n    /**\n     * Updates this marker from the provided data object, usually parsed form json from a markers.json\n     * @param markerData {object}\n     */\n    updateFromData(markerData) {}\n\n    // -- helper methods --\n\n    static _posRelativeToCamera = new Vector3();\n    static _cameraDirection = new Vector3();\n\n    /**\n     * @param position {Vector3}\n     * @param camera {THREE.Camera}\n     * @param fadeDistanceMax {number}\n     * @param fadeDistanceMin {number}\n     * @returns {number} - opacity between 0 and 1\n     */\n    static calculateDistanceOpacity(position, camera, fadeDistanceMin, fadeDistanceMax) {\n        let distance = Marker.calculateDistanceToCameraPlane(position, camera);\n        let minDelta = (distance - fadeDistanceMin) / fadeDistanceMin;\n        let maxDelta = (distance - fadeDistanceMax) / (fadeDistanceMax * 0.5);\n        return Math.min(\n            MathUtils.clamp(minDelta, 0, 1),\n            1 - MathUtils.clamp(maxDelta + 1, 0, 1)\n        );\n    }\n\n    /**\n     * @param position {Vector3}\n     * @param camera {THREE.Camera}\n     * @returns {number}\n     */\n    static calculateDistanceToCameraPlane (position, camera) {\n        Marker._posRelativeToCamera.subVectors(position, camera.position);\n        camera.getWorldDirection(Marker._cameraDirection);\n        return Marker._posRelativeToCamera.dot(Marker._cameraDirection);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"./Marker\";\nimport {CSS2DObject} from \"../util/CSS2DRenderer\";\nimport {animate, htmlToElement} from \"../util/Utils\";\nimport {Vector3} from \"three\";\n\nexport class ObjectMarker extends Marker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isObjectMarker', {value: true});\n        this.data.type = \"object\";\n\n        this.data.label = null;\n        this.data.detail = null;\n        this.data.link = null;\n        this.data.newTab = true;\n\n        this.lastClick = -1;\n    }\n\n    onClick(event) {\n        let pos = new Vector3();\n        if (event.intersection) {\n            pos.copy(event.intersection.pointOnLine || event.intersection.point);\n            pos.sub(this.position);\n        }\n\n        if (event.data.doubleTap) return false;\n\n        if (this.data.detail || this.data.label) {\n            let popup = new LabelPopup(this.data.detail || this.data.label);\n            popup.position.copy(pos);\n            this.add(popup);\n            popup.open();\n        }\n\n        if (this.data.link){\n            window.open(this.data.link, this.data.newTab ? '_blank' : '_self');\n        }\n\n        return true;\n    }\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      link: string,\n     *      newTab: boolean\n     *      }}\n     */\n    updateFromData(markerData) {\n\n        // update position\n        let pos = markerData.position || {};\n        this.position.setX(pos.x || 0);\n        this.position.setY(pos.y || 0);\n        this.position.setZ(pos.z || 0);\n\n        // update label\n        this.data.label = markerData.label || null;\n\n        //update detail\n        this.data.detail = markerData.detail || null;\n\n        // update link\n        this.data.link = markerData.link || null;\n        this.data.newTab = !!markerData.newTab;\n    }\n\n}\n\nexport class LabelPopup extends CSS2DObject {\n\n    /**\n     * @param label {string}\n     */\n    constructor(label) {\n        super(htmlToElement(`<div class=\"bm-marker-labelpopup\">${label}</div>`));\n    }\n\n    /**\n     * @param autoClose {boolean} - whether this object should be automatically closed and removed again on any other interaction\n     */\n    open(autoClose = true) {\n        let targetOpacity = this.element.style.opacity || 1;\n\n        this.element.style.opacity = 0;\n        let inAnimation = animate(progress => {\n            this.element.style.opacity = (progress * targetOpacity).toString();\n        }, 300);\n\n        if (autoClose) {\n            let removeHandler = evt => {\n                if (evt.composedPath().includes(this.element)) return;\n\n                inAnimation.cancel();\n                this.close();\n\n                window.removeEventListener(\"mousedown\", removeHandler);\n                window.removeEventListener(\"touchstart\", removeHandler);\n                window.removeEventListener(\"keydown\", removeHandler);\n                window.removeEventListener(\"mousewheel\", removeHandler);\n            };\n\n            window.addEventListener(\"mousedown\", removeHandler);\n            window.addEventListener(\"touchstart\", removeHandler);\n            window.addEventListener(\"keydown\", removeHandler);\n            window.addEventListener(\"mousewheel\", removeHandler);\n        }\n    }\n\n    /**\n     * @param remove {boolean} - whether this object should be removed from its parent when the close-animation finished\n     */\n    close(remove = true) {\n        let startOpacity = parseFloat(this.element.style.opacity);\n\n        animate(progress => {\n            this.element.style.opacity = (startOpacity - progress * startOpacity).toString();\n        }, 300, completed => {\n            if (remove && completed && this.parent) {\n                this.parent.remove(this);\n            }\n        });\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color, DoubleSide, Mesh, ShaderMaterial, Shape, ShapeBufferGeometry, Vector2} from \"three\";\nimport {LineMaterial} from \"../util/lines/LineMaterial\";\nimport {MARKER_FILL_VERTEX_SHADER} from \"./MarkerFillVertexShader\";\nimport {MARKER_FILL_FRAGMENT_SHADER} from \"./MarkerFillFragmentShader\";\nimport {LineGeometry} from \"../util/lines/LineGeometry\";\nimport {Line2} from \"../util/lines/Line2\";\nimport {deepEquals} from \"../util/Utils\";\nimport {ObjectMarker} from \"./ObjectMarker\";\n\nexport class ShapeMarker extends ObjectMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isShapeMarker', {value: true});\n        this.data.type = \"shape\";\n\n        let zero = new Vector2();\n        let shape = new Shape([zero, zero, zero]);\n        this.fill = new ShapeMarkerFill(shape);\n        this.border = new ShapeMarkerBorder(shape);\n        this.border.renderOrder = -1; // render border before fill\n\n        this.add(this.border, this.fill);\n\n        this._markerData = {};\n    }\n\n    /**\n     * @param y {number}\n     */\n    setShapeY(y) {\n        let relativeY = y - this.position.y;\n        this.fill.position.y = relativeY;\n        this.border.position.y = relativeY;\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    setShape(shape) {\n        this.fill.updateGeometry(shape);\n        this.border.updateGeometry(shape);\n    }\n\n    /**\n     * @typedef {{r: number, g: number, b: number, a: number}} ColorLike\n     */\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      shape: {x: number, z: number}[],\n     *      shapeY: number,\n     *      height: number,\n     *      link: string,\n     *      newTab: boolean,\n     *      depthTest: boolean,\n     *      lineWidth: number,\n     *      borderColor: ColorLike,\n     *      lineColor: ColorLike,\n     *      fillColor: ColorLike,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n        super.updateFromData(markerData);\n\n        // update shape only if needed, based on last update-data\n        if (\n            !this._markerData.shape || !deepEquals(markerData.shape, this._markerData.shape) ||\n            !this._markerData.position || !deepEquals(markerData.position, this._markerData.position)\n        ){\n            this.setShape(this.createShapeFromData(markerData.shape));\n        }\n\n        // update shapeY\n        this.setShapeY((markerData.shapeY || markerData.height || 0) + 0.01); //\"height\" for backwards compatibility, adding 0.01 to avoid z-fighting\n\n        // update depthTest\n        this.border.depthTest = !!markerData.depthTest;\n        this.fill.depthTest = !!markerData.depthTest;\n\n        // update border-width\n        this.border.linewidth = markerData.lineWidth !== undefined ? markerData.lineWidth : 2;\n\n        // update border-color\n        let bc = markerData.lineColor || markerData.borderColor || {}; //\"borderColor\" for backwards compatibility\n        this.border.color.setRGB((bc.r || 0) / 255, (bc.g || 0) / 255, (bc.b || 0) / 255);\n        this.border.opacity = bc.a || 0;\n\n        // update fill-color\n        let fc = markerData.fillColor || {};\n        this.fill.color.setRGB((fc.r || 0) / 255, (fc.g || 0) / 255, (fc.b || 0) / 255);\n        this.fill.opacity = fc.a || 0;\n\n        // update min/max distances\n        let minDist = markerData.minDistance || 0;\n        let maxDist = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n        this.border.fadeDistanceMin = minDist;\n        this.border.fadeDistanceMax = maxDist;\n        this.fill.fadeDistanceMin = minDist;\n        this.fill.fadeDistanceMax = maxDist;\n\n        // save used marker data for next update\n        this._markerData = markerData;\n    }\n\n    dispose() {\n        super.dispose();\n\n        this.fill.dispose();\n        this.border.dispose();\n    }\n\n    /**\n     * @private\n     * Creates a shape from a data object, usually parsed json from a markers.json\n     * @param shapeData {object}\n     * @returns {Shape}\n     */\n    createShapeFromData(shapeData) {\n        /** @type {THREE.Vector2[]} **/\n        let points = [];\n\n        if (Array.isArray(shapeData)){\n            shapeData.forEach(point => {\n                let x = (point.x || 0) - this.position.x;\n                let z = (point.z || 0) - this.position.z;\n\n                points.push(new Vector2(x, z));\n            });\n        }\n\n        return new Shape(points);\n    }\n\n}\n\nclass ShapeMarkerFill extends Mesh {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = ShapeMarkerFill.createGeometry(shape);\n        let material = new ShaderMaterial({\n            vertexShader: MARKER_FILL_VERTEX_SHADER,\n            fragmentShader: MARKER_FILL_FRAGMENT_SHADER,\n            side: DoubleSide,\n            depthTest: true,\n            transparent: true,\n            uniforms: {\n                markerColor: { value: new Color() },\n                markerOpacity: { value: 0 },\n                fadeDistanceMin: { value: 0 },\n                fadeDistanceMax: { value: Number.MAX_VALUE },\n            }\n        });\n\n        super(geometry, material);\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.uniforms.markerColor.value;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.uniforms.markerOpacity.value;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.uniforms.markerOpacity.value = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry.dispose();\n        this.geometry = ShapeMarkerFill.createGeometry(shape);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {ShapeBufferGeometry}\n     */\n    static createGeometry(shape) {\n        let geometry = new ShapeBufferGeometry(shape, 5);\n        geometry.rotateX(Math.PI / 2); //make y to z\n\n        return geometry;\n    }\n\n}\n\nclass ShapeMarkerBorder extends Line2 {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = new LineGeometry();\n        geometry.setPositions(ShapeMarkerBorder.createLinePoints(shape));\n\n        let material = new LineMaterial({\n            color: new Color(),\n            opacity: 0,\n            transparent: true,\n            linewidth: 1,\n            depthTest: true,\n            vertexColors: false,\n            dashed: false,\n        });\n        material.uniforms.fadeDistanceMin = { value: 0 };\n        material.uniforms.fadeDistanceMax = { value: Number.MAX_VALUE };\n\n        material.resolution.set(window.innerWidth, window.innerHeight);\n\n        super(geometry, material);\n\n        this.computeLineDistances();\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.color;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.opacity;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.opacity = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get linewidth() {\n        return this.material.linewidth;\n    }\n\n    /**\n     * @param width {number}\n     */\n    set linewidth(width) {\n        this.material.linewidth = width;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry = new LineGeometry();\n        this.geometry.setPositions(ShapeMarkerBorder.createLinePoints(shape));\n        this.computeLineDistances();\n    }\n\n    /**\n     * @param renderer {THREE.WebGLRenderer}\n     */\n    onBeforeRender(renderer) {\n        renderer.getSize(this.material.resolution);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {number[]}\n     */\n    static createLinePoints(shape) {\n        let points3d = [];\n        let points = shape.getPoints(5);\n        points.forEach(point => points3d.push(point.x, 0, point.y));\n        points3d.push(points[0].x, 0, points[0].y);\n\n        return points3d;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color, DoubleSide, ExtrudeBufferGeometry, Mesh, ShaderMaterial, Shape, Vector2} from \"three\";\nimport {LineMaterial} from \"../util/lines/LineMaterial\";\nimport {MARKER_FILL_VERTEX_SHADER} from \"./MarkerFillVertexShader\";\nimport {MARKER_FILL_FRAGMENT_SHADER} from \"./MarkerFillFragmentShader\";\nimport {Line2} from \"../util/lines/Line2\";\nimport {deepEquals} from \"../util/Utils\";\nimport {LineSegmentsGeometry} from \"../util/lines/LineSegmentsGeometry\";\nimport {ObjectMarker} from \"./ObjectMarker\";\n\nexport class ExtrudeMarker extends ObjectMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isExtrudeMarker', {value: true});\n        this.data.type = \"extrude\";\n\n        let zero = new Vector2();\n        let shape = new Shape([zero, zero, zero]);\n        this.fill = new ExtrudeMarkerFill(shape);\n        this.border = new ExtrudeMarkerBorder(shape);\n        this.border.renderOrder = -1; // render border before fill\n\n        this.add(this.border, this.fill);\n\n        this._markerData = {};\n    }\n\n    /**\n     * @param minY {number}\n     * @param maxY {number}\n     */\n    setShapeY(minY, maxY) {\n        let relativeY = maxY - this.position.y;\n        let height = maxY - minY;\n        this.fill.position.y = relativeY;\n        this.border.position.y = relativeY;\n        this.fill.scale.y = height;\n        this.border.scale.y = height;\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    setShape(shape) {\n        this.fill.updateGeometry(shape);\n        this.border.updateGeometry(shape);\n    }\n\n    /**\n     * @typedef {{r: number, g: number, b: number, a: number}} ColorLike\n     */\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      shape: {x: number, z: number}[],\n     *      shapeMinY: number,\n     *      shapeMaxY: number,\n     *      link: string,\n     *      newTab: boolean,\n     *      depthTest: boolean,\n     *      lineWidth: number,\n     *      lineColor: ColorLike,\n     *      fillColor: ColorLike,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n        super.updateFromData(markerData);\n\n        // update shape only if needed, based on last update-data\n        if (\n            !this._markerData.shape || !deepEquals(markerData.shape, this._markerData.shape) ||\n            !this._markerData.position || !deepEquals(markerData.position, this._markerData.position)\n        ){\n            this.setShape(this.createShapeFromData(markerData.shape));\n        }\n\n        // update shapeY\n        this.setShapeY((markerData.shapeMinY || 0) - 0.01, (markerData.shapeMaxY || 0) + 0.01); // offset by 0.01 to avoid z-fighting\n\n        // update depthTest\n        this.border.depthTest = !!markerData.depthTest;\n        this.fill.depthTest = !!markerData.depthTest;\n\n        // update border-width\n        this.border.linewidth = markerData.lineWidth !== undefined ? markerData.lineWidth : 2;\n\n        // update border-color\n        let bc = markerData.lineColor || {};\n        this.border.color.setRGB((bc.r || 0) / 255, (bc.g || 0) / 255, (bc.b || 0) / 255);\n        this.border.opacity = bc.a || 0;\n\n        // update fill-color\n        let fc = markerData.fillColor || {};\n        this.fill.color.setRGB((fc.r || 0) / 255, (fc.g || 0) / 255, (fc.b || 0) / 255);\n        this.fill.opacity = fc.a || 0;\n\n        // update min/max distances\n        let minDist = markerData.minDistance || 0;\n        let maxDist = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n        this.border.fadeDistanceMin = minDist;\n        this.border.fadeDistanceMax = maxDist;\n        this.fill.fadeDistanceMin = minDist;\n        this.fill.fadeDistanceMax = maxDist;\n\n        // save used marker data for next update\n        this._markerData = markerData;\n    }\n\n    dispose() {\n        super.dispose();\n\n        this.fill.dispose();\n        this.border.dispose();\n    }\n\n    /**\n     * @private\n     * Creates a shape from a data object, usually parsed json from a markers.json\n     * @param shapeData {object}\n     * @returns {Shape}\n     */\n    createShapeFromData(shapeData) {\n        /** @type {THREE.Vector2[]} **/\n        let points = [];\n\n        if (Array.isArray(shapeData)){\n            shapeData.forEach(point => {\n                let x = (point.x || 0) - this.position.x + 0.01; // offset by 0.01 to avoid z-fighting\n                let z = (point.z || 0) - this.position.z + 0.01;\n\n                points.push(new Vector2(x, z));\n            });\n        }\n\n        return new Shape(points);\n    }\n\n}\n\nclass ExtrudeMarkerFill extends Mesh {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = ExtrudeMarkerFill.createGeometry(shape);\n        let material = new ShaderMaterial({\n            vertexShader: MARKER_FILL_VERTEX_SHADER,\n            fragmentShader: MARKER_FILL_FRAGMENT_SHADER,\n            side: DoubleSide,\n            depthTest: true,\n            transparent: true,\n            uniforms: {\n                markerColor: { value: new Color() },\n                markerOpacity: { value: 0 },\n                fadeDistanceMin: { value: 0 },\n                fadeDistanceMax: { value: Number.MAX_VALUE },\n            }\n        });\n\n        super(geometry, material);\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.uniforms.markerColor.value;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.uniforms.markerOpacity.value;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.uniforms.markerOpacity.value = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry.dispose();\n        this.geometry = ExtrudeMarkerFill.createGeometry(shape);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {ExtrudeBufferGeometry}\n     */\n    static createGeometry(shape) {\n        let geometry = new ExtrudeBufferGeometry(shape, {\n            depth: 1,\n            steps: 5,\n            bevelEnabled: false\n        });\n        geometry.rotateX(Math.PI / 2); //make y to z\n\n        return geometry;\n    }\n\n}\n\nclass ExtrudeMarkerBorder extends Line2 {\n\n    /**\n     * @param shape {Shape}\n     */\n    constructor(shape) {\n        let geometry = new LineSegmentsGeometry();\n        geometry.setPositions(ExtrudeMarkerBorder.createLinePoints(shape));\n\n        let material = new LineMaterial({\n            color: new Color(),\n            opacity: 0,\n            transparent: true,\n            linewidth: 1,\n            depthTest: true,\n            vertexColors: false,\n            dashed: false,\n        });\n        material.uniforms.fadeDistanceMin = { value: 0 };\n        material.uniforms.fadeDistanceMax = { value: Number.MAX_VALUE };\n\n        material.resolution.set(window.innerWidth, window.innerHeight);\n\n        super(geometry, material);\n\n        this.computeLineDistances();\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.color;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.opacity;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.opacity = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get linewidth() {\n        return this.material.linewidth;\n    }\n\n    /**\n     * @param width {number}\n     */\n    set linewidth(width) {\n        this.material.linewidth = width;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param shape {Shape}\n     */\n    updateGeometry(shape) {\n        this.geometry = new LineSegmentsGeometry();\n        this.geometry.setPositions(ExtrudeMarkerBorder.createLinePoints(shape));\n        this.computeLineDistances();\n    }\n\n    /**\n     * @param renderer {THREE.WebGLRenderer}\n     */\n    onBeforeRender(renderer) {\n        renderer.getSize(this.material.resolution);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n    /**\n     * @param shape {Shape}\n     * @returns {number[]}\n     */\n    static createLinePoints(shape) {\n        let points3d = [];\n        let points = shape.getPoints(5);\n        points.push(points[0]);\n\n        let prevPoint = null;\n        points.forEach(point => {\n\n            // vertical line\n            points3d.push(point.x, 0, point.y);\n            points3d.push(point.x, -1, point.y);\n\n            if (prevPoint) {\n                // line to previous point top\n                points3d.push(prevPoint.x, 0, prevPoint.y);\n                points3d.push(point.x, 0, point.y);\n\n                // line to previous point bottom\n                points3d.push(prevPoint.x, -1, prevPoint.y);\n                points3d.push(point.x, -1, point.y);\n            }\n\n            prevPoint = point;\n        });\n\n        return points3d;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color} from \"three\";\nimport {LineMaterial} from \"../util/lines/LineMaterial\";\nimport {LineGeometry} from \"../util/lines/LineGeometry\";\nimport {Line2} from \"../util/lines/Line2\";\nimport {deepEquals} from \"../util/Utils\";\nimport {ObjectMarker} from \"./ObjectMarker\";\n\nexport class LineMarker extends ObjectMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isLineMarker', {value: true});\n        this.data.type = \"line\";\n\n        this.line = new LineMarkerLine([0, 0, 0]);\n\n        this.add(this.line);\n\n        this._markerData = {};\n    }\n\n    /**\n     * @param line {number[] | THREE.Vector3[] | THREE.Curve}\n     */\n    setLine(line) {\n        /** @type {number[]} */\n        let points;\n\n        if (line.type === 'Curve' || line.type === 'CurvePath') {\n            line = line.getPoints(5);\n        }\n\n        if (Array.isArray(line)) {\n            if (line.length === 0){\n                points = [];\n            } else if (line[0].isVector3) {\n                points = [];\n                line.forEach(point => {\n                    points.push(point.x, point.y, point.z);\n                });\n            } else {\n                points = line;\n            }\n        } else {\n            throw new Error(\"Invalid argument type!\");\n        }\n\n        this.line.updateGeometry(points);\n    }\n\n    /**\n     * @typedef {{r: number, g: number, b: number, a: number}} ColorLike\n     */\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      detail: string,\n     *      line: {x: number, y: number, z: number}[],\n     *      link: string,\n     *      newTab: boolean,\n     *      depthTest: boolean,\n     *      lineWidth: number,\n     *      lineColor: ColorLike,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n        super.updateFromData(markerData);\n\n        // update shape only if needed, based on last update-data\n        if (\n            !this._markerData.line || !deepEquals(markerData.line, this._markerData.line) ||\n            !this._markerData.position || !deepEquals(markerData.position, this._markerData.position)\n        ){\n            this.setLine(this.createPointsFromData(markerData.line));\n        }\n\n        // update depthTest\n        this.line.depthTest = !!markerData.depthTest;\n\n        // update border-width\n        this.line.linewidth = markerData.lineWidth !== undefined ? markerData.lineWidth : 2;\n\n        // update line-color\n        let lc = markerData.lineColor || {};\n        this.line.color.setRGB((lc.r || 0) / 255, (lc.g || 0) / 255, (lc.b || 0) / 255);\n        this.line.opacity = lc.a || 0;\n\n        // update min/max distances\n        let minDist = markerData.minDistance || 0;\n        let maxDist = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n        this.line.fadeDistanceMin = minDist;\n        this.line.fadeDistanceMax = maxDist;\n\n        // save used marker data for next update\n        this._markerData = markerData;\n    }\n\n    dispose() {\n        super.dispose();\n\n        this.line.dispose();\n    }\n\n    /**\n     * @private\n     * Creates a shape from a data object, usually parsed json from a markers.json\n     * @param shapeData {object}\n     * @returns {number[]}\n     */\n    createPointsFromData(shapeData) {\n        /** @type {number[]} **/\n        let points = [];\n\n        if (Array.isArray(shapeData)){\n            shapeData.forEach(point => {\n                let x = (point.x || 0) - this.position.x;\n                let y = (point.y || 0) - this.position.y;\n                let z = (point.z || 0) - this.position.z;\n\n                points.push(x, y, z);\n            });\n        }\n\n        return points;\n    }\n\n}\n\nclass LineMarkerLine extends Line2 {\n\n    /**\n     * @param points {number[]}\n     */\n    constructor(points) {\n        let geometry = new LineGeometry();\n        geometry.setPositions(points);\n\n        let material = new LineMaterial({\n            color: new Color(),\n            opacity: 0,\n            transparent: true,\n            linewidth: 1,\n            depthTest: true,\n            vertexColors: false,\n            dashed: false,\n        });\n        material.uniforms.fadeDistanceMin = { value: 0 };\n        material.uniforms.fadeDistanceMax = { value: Number.MAX_VALUE };\n\n        material.resolution.set(window.innerWidth, window.innerHeight);\n\n        super(geometry, material);\n\n        this.computeLineDistances();\n    }\n\n    /**\n     * @returns {Color}\n     */\n    get color(){\n        return this.material.color;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get opacity() {\n        return this.material.opacity;\n    }\n\n    /**\n     * @param opacity {number}\n     */\n    set opacity(opacity) {\n        this.material.opacity = opacity;\n        this.visible = opacity > 0;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get linewidth() {\n        return this.material.linewidth;\n    }\n\n    /**\n     * @param width {number}\n     */\n    set linewidth(width) {\n        this.material.linewidth = width;\n    }\n\n    /**\n     * @returns {boolean}\n     */\n    get depthTest() {\n        return this.material.depthTest;\n    }\n\n    /**\n     * @param test {boolean}\n     */\n    set depthTest(test) {\n        this.material.depthTest = test;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMin() {\n        return this.material.uniforms.fadeDistanceMin.value;\n    }\n\n    /**\n     * @param min {number}\n     */\n    set fadeDistanceMin(min) {\n        this.material.uniforms.fadeDistanceMin.value = min;\n    }\n\n    /**\n     * @returns {number}\n     */\n    get fadeDistanceMax() {\n        return this.material.uniforms.fadeDistanceMax.value;\n    }\n\n    /**\n     * @param max {number}\n     */\n    set fadeDistanceMax(max) {\n        this.material.uniforms.fadeDistanceMax.value = max;\n    }\n\n    onClick(event) {\n        if (event.intersection) {\n            if (event.intersection.distance > this.fadeDistanceMax) return false;\n            if (event.intersection.distance < this.fadeDistanceMin) return false;\n        }\n\n        return super.onClick(event);\n    }\n\n    /**\n     * @param points {number[]}\n     */\n    updateGeometry(points) {\n        this.geometry = new LineGeometry();\n        this.geometry.setPositions(points);\n        this.computeLineDistances();\n    }\n\n    /**\n     * @param renderer {THREE.WebGLRenderer}\n     */\n    onBeforeRender(renderer) {\n        renderer.getSize(this.material.resolution);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n        this.material.dispose();\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"./Marker\";\nimport {CSS2DObject} from \"../util/CSS2DRenderer\";\nimport {htmlToElement} from \"../util/Utils\";\n\nexport class HtmlMarker extends Marker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isHtmlMarker', {value: true});\n        this.data.type = \"html\";\n\n        this.data.label = null;\n\n        this.elementObject = new CSS2DObject(htmlToElement(`<div id=\"bm-marker-${this.data.id}\" class=\"bm-marker-${this.data.type}\"></div>`));\n        this.elementObject.onBeforeRender = (renderer, scene, camera) => this.onBeforeRender(renderer, scene, camera);\n\n        this.fadeDistanceMin = 0;\n        this.fadeDistanceMax = Number.MAX_VALUE;\n\n        this.addEventListener( 'removed', () => {\n            if (this.element?.parentNode) this.element.parentNode.removeChild(this.element);\n        });\n\n        this.add(this.elementObject);\n    }\n\n    onBeforeRender(renderer, scene, camera) {\n        if (this.fadeDistanceMax === Number.MAX_VALUE && this.fadeDistanceMin <= 0){\n            this.element.parentNode.style.opacity = undefined;\n        } else {\n            this.element.parentNode.style.opacity = Marker.calculateDistanceOpacity(this.position, camera, this.fadeDistanceMin, this.fadeDistanceMax).toString();\n        }\n    }\n\n    /**\n     * @returns {string}\n     */\n    get html() {\n        return this.element.innerHTML;\n    }\n\n    /**\n     * @param html {string}\n     */\n    set html(html) {\n        this.element.innerHTML = html;\n    }\n\n    /**\n     * @returns {THREE.Vector2}\n     */\n    get anchor() {\n        return this.elementObject.anchor;\n    }\n\n    /**\n     * @returns {Element}\n     */\n    get element() {\n        return this.elementObject.element.getElementsByTagName(\"div\")[0];\n    }\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      label: string,\n     *      anchor: {x: number, y: number},\n     *      html: string,\n     *      minDistance: number,\n     *      maxDistance: number\n     *      }}\n     */\n    updateFromData(markerData) {\n\n        // update position\n        let pos = markerData.position || {};\n        this.position.setX(pos.x || 0);\n        this.position.setY(pos.y || 0);\n        this.position.setZ(pos.z || 0);\n\n        // update label\n        this.data.label = markerData.label || null;\n\n        // update anchor\n        let anch = markerData.anchor || {};\n        this.anchor.setX(anch.x || 0);\n        this.anchor.setY(anch.y || 0);\n\n        // update html\n        if (this.element.innerHTML !== markerData.html){\n            this.element.innerHTML = markerData.html;\n        }\n\n        // update min/max distances\n        this.fadeDistanceMin = markerData.minDistance || 0;\n        this.fadeDistanceMax = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n\n    }\n\n    dispose() {\n        super.dispose();\n\n        if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {HtmlMarker} from \"./HtmlMarker\";\n\nexport class PoiMarker extends HtmlMarker {\n\n    /**\n     * @param markerId {string}\n     */\n    constructor(markerId) {\n        super(markerId);\n        Object.defineProperty(this, 'isPoiMarker', {value: true});\n        this.data.type = \"poi\";\n\n        this.html = `<img src=\"\" alt=\"POI Icon (${this.data.id})\" class=\"bm-marker-poi-icon\" draggable=\"false\" style=\"pointer-events: auto\"><div class=\"bm-marker-poi-label\"></div>`;\n\n        this.iconElement = this.element.getElementsByTagName(\"img\").item(0);\n        this.labelElement = this.element.getElementsByTagName(\"div\").item(0);\n\n        this._lastIcon = null;\n    }\n\n    onClick(event) {\n        if (event.data.doubleTap) return false;\n\n        if (this.highlight || !this.data.label) return true;\n        this.highlight = true;\n\n        let eventHandler = evt => {\n            if (evt.composedPath().includes(this.element)) return;\n\n            this.highlight = false;\n\n            window.removeEventListener(\"mousedown\", eventHandler);\n            window.removeEventListener(\"touchstart\", eventHandler);\n            window.removeEventListener(\"keydown\", eventHandler);\n            window.removeEventListener(\"mousewheel\", eventHandler);\n        };\n\n        setTimeout(function () {\n            window.addEventListener(\"mousedown\", eventHandler);\n            window.addEventListener(\"touchstart\", eventHandler);\n            window.addEventListener(\"keydown\", eventHandler);\n            window.addEventListener(\"mousewheel\", eventHandler);\n        }, 0);\n\n        return true;\n    }\n\n    set highlight(highlight) {\n        if (highlight) {\n            this.element.classList.add(\"bm-marker-highlight\");\n        } else {\n            this.element.classList.remove(\"bm-marker-highlight\");\n        }\n    }\n\n    get highlight() {\n        return this.element.classList.contains(\"bm-marker-highlight\");\n    }\n\n    /**\n     * @param markerData {{\n     *      position: {x: number, y: number, z: number},\n     *      anchor: {x: number, y: number},\n     *      iconAnchor: {x: number, y: number},\n     *      label: string,\n     *      icon: string,\n     *      minDistance: number,\n     *      maxDistance: number\n     * }}\n     */\n    updateFromData(markerData) {\n\n        // update position\n        let pos = markerData.position || {};\n        this.position.setX(pos.x || 0);\n        this.position.setY(pos.y || 0);\n        this.position.setZ(pos.z || 0);\n\n        // update anchor\n        let anch = markerData.anchor || markerData.iconAnchor || {}; //\"iconAnchor\" for backwards compatibility\n        this.iconElement.style.transform = `translate(${-anch.x}px, ${-anch.y}px)`;\n        //this.anchor.setX(anch.x || 0);\n        //this.anchor.setY(anch.y || 0);\n\n\n        // update label\n        if (this.data.label !== markerData.label){\n            this.data.label = markerData.label || \"\";\n            this.labelElement.innerHTML = this.data.label || \"\";\n        }\n\n        // update icon\n        if (this._lastIcon !== markerData.icon){\n            this.iconElement.src = markerData.icon || \"assets/poi.svg\";\n            this._lastIcon = markerData.icon;\n        }\n\n        // update min/max distances\n        this.fadeDistanceMin = markerData.minDistance || 0;\n        this.fadeDistanceMax = markerData.maxDistance !== undefined ? markerData.maxDistance : Number.MAX_VALUE;\n\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Scene} from \"three\";\nimport {alert} from \"../util/Utils\";\nimport {ShapeMarker} from \"./ShapeMarker\";\nimport {ExtrudeMarker} from \"./ExtrudeMarker\";\nimport {LineMarker} from \"./LineMarker\";\nimport {HtmlMarker} from \"./HtmlMarker\";\nimport {PoiMarker} from \"./PoiMarker\";\n\nexport class MarkerSet extends Scene {\n\n    /**\n     * @param id {string}\n     */\n    constructor(id) {\n        super();\n        Object.defineProperty(this, 'isMarkerSet', {value: true});\n\n        /** @type {Map<string, MarkerSet>} */\n        this.markerSets = new Map();\n        /** @type {Map<string, Marker>} */\n        this.markers = new Map();\n\n        this.data = {\n            id: id,\n            label: id,\n            toggleable: true,\n            defaultHide: false,\n            markerSets: [],\n            markers: [],\n            visible: this.visible,\n        };\n\n        Object.defineProperty(this, \"visible\", {\n            get() { return this.data.visible },\n            set(value) { this.data.visible = value }\n        });\n    }\n\n    updateFromData(data) {\n        // update set info\n        this.data.label = data.label || this.data.id;\n        this.data.toggleable = !!data.toggleable;\n        this.data.defaultHide = !!data.defaultHidden;\n\n        // update markerSets\n        this.updateMarkerSetsFromData(data.markerSets);\n\n        // update markers\n        this.updateMarkersFromData(data.markers);\n    }\n\n    updateMarkerSetsFromData(data = {}, ignore = []) {\n        let updatedMarkerSets = new Set(ignore);\n\n        // add & update MarkerSets\n        Object.keys(data).forEach(markerSetId => {\n            if (updatedMarkerSets.has(markerSetId)) return;\n            updatedMarkerSets.add(markerSetId);\n\n            let markerSetData = data[markerSetId];\n            try {\n                this.updateMarkerSetFromData(markerSetId, markerSetData);\n            } catch (err) {\n                alert(this.events, err, \"fine\");\n            }\n        });\n\n        // remove not updated MarkerSets\n        this.markerSets.forEach((markerSet, setId) => {\n            if (!updatedMarkerSets.has(setId)) {\n                this.remove(markerSet);\n            }\n        });\n    }\n\n    updateMarkerSetFromData(markerSetId, data) {\n        let markerSet = this.markerSets.get(markerSetId);\n\n        // create new if not existent\n        if (!markerSet) {\n            markerSet = new MarkerSet(markerSetId);\n            this.add(markerSet);\n\n            if (data.defaultHidden) {\n                markerSet.visible = false;\n            }\n        }\n\n        // update\n        markerSet.updateFromData(data);\n    }\n\n    updateMarkersFromData(data = {}, ignore = []) {\n        let updatedMarkers = new Set(ignore);\n\n        Object.keys(data).forEach(markerId => {\n            if (updatedMarkers.has(markerId)) return;\n\n            let markerData = data[markerId];\n            try {\n                this.updateMarkerFromData(markerId, markerData);\n                updatedMarkers.add(markerId);\n            } catch (err) {\n                alert(this.events, err, \"fine\");\n                console.debug(err);\n            }\n        });\n\n        // remove not updated Markers\n        this.markers.forEach((marker, markerId) => {\n            if (!updatedMarkers.has(markerId)) {\n                this.remove(marker);\n            }\n        });\n    }\n\n    updateMarkerFromData(markerId, data) {\n        if (!data.type) throw new Error(\"marker-data has no type!\");\n        let marker = this.markers.get(markerId);\n\n        // create new if not existent of wrong type\n        if (!marker || marker.data.type !== data.type) {\n            if (marker) this.remove(marker);\n\n            switch (data.type) {\n                case \"shape\" : marker = new ShapeMarker(markerId); break;\n                case \"extrude\" : marker = new ExtrudeMarker(markerId); break;\n                case \"line\" : marker = new LineMarker(markerId); break;\n                case \"html\" : marker = new HtmlMarker(markerId); break;\n                case \"poi\" : marker = new PoiMarker(markerId); break;\n                default : throw new Error(`Unknown marker-type: '${data.type}'`);\n            }\n\n            this.add(marker);\n        }\n\n        // update marker\n        marker.updateFromData(data);\n    }\n\n    /**\n     * Removes all markers and marker-sets\n     */\n    clear() {\n        [...this.data.markerSets].forEach(markerSet => this.remove(markerSet));\n        [...this.data.markers].forEach(marker => this.remove(marker));\n    }\n\n    add(...object) {\n        if (object.length === 1) { //super.add() will re-invoke this method for each array-entry if it's more than one\n            let o = object[0];\n            if (o.isMarkerSet && !this.markerSets.has(o.data.id)) {\n                this.markerSets.set(o.data.id, o);\n                this.data.markerSets.push(o.data);\n            }\n            if (o.isMarker && !this.markers.has(o.data.id)) {\n                this.markers.set(o.data.id, o);\n                this.data.markers.push(o.data);\n            }\n        }\n\n        return super.add(...object);\n    }\n\n    remove(...object) {\n        if (object.length === 1) { //super.remove() will re-invoke this method for each array-entry if it's more than one\n            let o = object[0];\n            if (o.isMarkerSet) {\n                let i = this.data.markerSets.indexOf(o.data);\n                if (i > -1) this.data.markerSets.splice(i, 1);\n                this.markerSets.delete(o.data.id);\n                o.dispose();\n            }\n            if (o.isMarker) {\n                let i = this.data.markers.indexOf(o.data);\n                if (i > -1) this.data.markers.splice(i, 1);\n                this.markers.delete(o.data.id);\n                o.dispose();\n            }\n        }\n\n        return super.remove(...object);\n    }\n\n    dispose() {\n        this.children.forEach(child => {\n            if (child.dispose) child.dispose();\n        });\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Color, PerspectiveCamera, Raycaster, Scene, Vector2, Vector3, WebGLRenderer} from \"three\";\nimport {Map} from \"./map/Map\";\nimport {SkyboxScene} from \"./skybox/SkyboxScene\";\nimport {ControlsManager} from \"./controls/ControlsManager\";\nimport Stats from \"./util/Stats\";\nimport {alert, dispatchEvent, elementOffset, generateCacheHash, htmlToElement, softClamp} from \"./util/Utils\";\nimport {TileManager} from \"./map/TileManager\";\nimport {HIRES_VERTEX_SHADER} from \"./map/hires/HiresVertexShader\";\nimport {HIRES_FRAGMENT_SHADER} from \"./map/hires/HiresFragmentShader\";\nimport {LOWRES_VERTEX_SHADER} from \"./map/lowres/LowresVertexShader\";\nimport {LOWRES_FRAGMENT_SHADER} from \"./map/lowres/LowresFragmentShader\";\nimport {CombinedCamera} from \"./util/CombinedCamera\";\nimport {CSS2DRenderer} from \"./util/CSS2DRenderer\";\nimport {MarkerSet} from \"./markers/MarkerSet\";\n\nexport class MapViewer {\n\n\t/**\n\t * @param element {Element}\n\t * @param events {EventTarget}\n\t */\n\tconstructor(element, events = element) {\n\t\tObject.defineProperty( this, 'isMapViewer', { value: true } );\n\n\t\tthis.rootElement = element;\n\t\tthis.events = events;\n\n\t\tthis.data = {\n\t\t\tmap: null,\n\t\t\tcamera: null,\n\t\t\tcontrolsManager: null,\n\t\t\tuniforms: {\n\t\t\t\tsunlightStrength: { value: 1 },\n\t\t\t\tambientLight: { value: 0 },\n\t\t\t\tskyColor: { value: new Color(0.5, 0.5, 1) },\n\t\t\t\thiresTileMap: {\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tmap: null,\n\t\t\t\t\t\tsize: TileManager.tileMapSize,\n\t\t\t\t\t\tscale: new Vector2(1, 1),\n\t\t\t\t\t\ttranslate: new Vector2(),\n\t\t\t\t\t\tpos: new Vector2(),\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsuperSampling: 1,\n\t\t\tloadedCenter: new Vector2(0, 0),\n\t\t\tloadedHiresViewDistance: 200,\n\t\t\tloadedLowresViewDistance: 2000,\n\t\t}\n\n\t\tthis.tileCacheHash = generateCacheHash();\n\n\t\tthis.stats = new Stats();\n\t\tthis.stats.hide();\n\n\t\t// renderer\n\t\tthis.renderer = new WebGLRenderer({\n\t\t\tantialias: true,\n\t\t\tsortObjects: true,\n\t\t\tpreserveDrawingBuffer: true,\n\t\t\tlogarithmicDepthBuffer: true,\n\t\t});\n\t\tthis.renderer.autoClear = false;\n\t\tthis.renderer.uniforms = this.data.uniforms;\n\n\t\t// CSS2D renderer\n\t\tthis.css2dRenderer = new CSS2DRenderer(this.events);\n\n\t\tthis.skyboxScene = new SkyboxScene(this.data.uniforms);\n\n\t\tthis.camera = new CombinedCamera(75, 1, 0.1, 10000, 0);\n\t\tthis.skyboxCamera = new PerspectiveCamera(75, 1, 0.1, 10000);\n\t\tthis.skyboxCamera.updateProjectionMatrix();\n\n\t\tthis.controlsManager = new ControlsManager(this, this.camera);\n\n\t\tthis.raycaster = new Raycaster();\n\t\tthis.raycaster.layers.enableAll();\n\t\tthis.raycaster.params.Line2 = {threshold: 20}\n\n\t\t/** @type {Map} */\n\t\tthis.map = null;\n\n\t\tthis.markers = new MarkerSet(\"bm-root\");\n\n\t\tthis.lastFrame = 0;\n\n\t\t// initialize\n\t\tthis.initializeRootElement();\n\n\t\t// handle window resizes\n\t\twindow.addEventListener(\"resize\", this.handleContainerResize);\n\n\t\t// start render-loop\n\t\trequestAnimationFrame(this.renderLoop);\n\t}\n\n\t/**\n\t * Initializes the root-element\n\t */\n\tinitializeRootElement() {\n\t\tthis.rootElement.innerHTML = \"\";\n\n\t\tlet outerDiv = htmlToElement(`<div style=\"position: relative; width: 100%; height: 100%; overflow: hidden;\"></div>`);\n\t\tthis.rootElement.appendChild(outerDiv);\n\n\t\t// 3d-canvas\n\t\touterDiv.appendChild(this.renderer.domElement);\n\n\t\t// html-markers\n\t\tthis.css2dRenderer.domElement.style.position = 'absolute';\n\t\tthis.css2dRenderer.domElement.style.top = '0';\n\t\tthis.css2dRenderer.domElement.style.left = '0';\n\t\tthis.css2dRenderer.domElement.style.pointerEvents = 'none';\n\t\touterDiv.appendChild(this.css2dRenderer.domElement);\n\n\t\t// performance monitor\n\t\touterDiv.appendChild(this.stats.dom);\n\n\t\tthis.handleContainerResize();\n\t}\n\n\t/**\n\t * Updates the render-resolution and aspect ratio based on the size of the root-element\n\t */\n\thandleContainerResize = () => {\n\t\tthis.renderer.setSize(this.rootElement.clientWidth, this.rootElement.clientHeight);\n\t\tthis.renderer.setPixelRatio(window.devicePixelRatio * this.superSampling);\n\n\t\tthis.css2dRenderer.setSize(this.rootElement.clientWidth, this.rootElement.clientHeight);\n\n\t\tthis.camera.aspect = this.rootElement.clientWidth / this.rootElement.clientHeight;\n\t\tthis.camera.updateProjectionMatrix();\n\t};\n\n\t/**\n\t * Triggers an interaction on the screen (map), e.g. a mouse-click.\n\t *\n\t * This will first attempt to invoke the onClick() method on the Object3D (e.g. Markers) that has been clicked.\n\t * And if none of those consumed the event, it will fire a <code>bluemapMapInteraction</code> event.\n\t *\n\t * @param screenPosition {Vector2} - Clicked position on the screen (usually event.x, event.y)\n\t * @param data {object} - Custom event data that will be added to the interaction-event\n\t */\n\thandleMapInteraction(screenPosition, data = {}) {\n\t\tlet rootOffset = elementOffset(this.rootElement);\n\t\tlet normalizedScreenPos = new Vector2(\n\t\t\t((screenPosition.x - rootOffset.top) / this.rootElement.clientWidth) * 2 - 1,\n\t\t\t-((screenPosition.y - rootOffset.left) / this.rootElement.clientHeight) * 2 + 1\n\t\t);\n\n\t\tif (this.map && this.map.isLoaded){\n\t\t\tthis.raycaster.setFromCamera(normalizedScreenPos, this.camera);\n\n\t\t\t// check Object3D interactions\n\t\t\tconst intersectScenes = [this.map.hiresTileManager.scene, this.markers];\n\t\t\tfor (let i = 0; i < this.map.lowresTileManager.length; i++) {\n\t\t\t\tintersectScenes.push(this.map.lowresTileManager[i].scene);\n\t\t\t}\n\n\t\t\tlet intersects = this.raycaster.intersectObjects(intersectScenes, true);\n\t\t\tlet hit = null;\n\t\t\tlet lowresHits = [];\n\t\t\tlet hiresHit = null;\n\t\t\tlet covered = false;\n\n\t\t\tfor (let i = 0; i < intersects.length; i++) {\n\t\t\t\tif (intersects[i].object){\n\t\t\t\t\tlet object = intersects[i].object;\n\n\t\t\t\t\t// check if deeply-visible\n\t\t\t\t\tlet parent = object;\n\t\t\t\t\tlet visible = parent.visible;\n\t\t\t\t\twhile (visible && parent.parent){\n\t\t\t\t\t\tparent = parent.parent;\n\t\t\t\t\t\tvisible = parent.visible;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (visible) {\n\t\t\t\t\t\tif (!hit) hit = intersects[i];\n\n\t\t\t\t\t\t// find root-scene\n\t\t\t\t\t\tlet parentRoot = object;\n\t\t\t\t\t\twhile(parentRoot.parent) parentRoot = parentRoot.parent;\n\n\t\t\t\t\t\tfor (let l = 0; l < this.map.lowresTileManager.length; l++) {\n\t\t\t\t\t\t\tif (parentRoot === this.map.lowresTileManager[l].sceneParent) {\n\t\t\t\t\t\t\t\tif (!lowresHits[l]) lowresHits[l] = intersects[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (parentRoot === this.map.hiresTileManager.sceneParent) {\n\t\t\t\t\t\t\tif (!hiresHit) hiresHit = intersects[i];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!covered || (object.material && !object.material.depthTest)) {\n\t\t\t\t\t\t\tif (object.onClick && object.onClick({\n\t\t\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\t\t\tintersection: intersects[i]\n\t\t\t\t\t\t\t})) return;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (parentRoot !== this.map.lowresTileManager[0].sceneParent) {\n\t\t\t\t\t\t\tcovered = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// fire event\n\t\t\tdispatchEvent(this.events, \"bluemapMapInteraction\", {\n\t\t\t\tdata: data,\n\t\t\t\thit: hit,\n\t\t\t\thiresHit: hiresHit,\n\t\t\t\tlowresHits: lowresHits,\n\t\t\t\tintersections: intersects,\n\t\t\t\tray: this.raycaster.ray\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * The render-loop to update and possibly render a new frame.\n\t * @param now {number} the current time in milliseconds\n\t */\n\trenderLoop = (now) => {\n\t\trequestAnimationFrame(this.renderLoop);\n\n\t\t// calculate delta time\n\t\tif (this.lastFrame <= 0) this.lastFrame = now;\n\t\tlet delta = now - this.lastFrame;\n\t\tthis.lastFrame = now;\n\n\t\t// update stats\n\t\tthis.stats.begin();\n\n\t\t// update controls\n\t\tif (this.map != null) {\n\t\t\tthis.controlsManager.update(delta, this.map);\n\t\t}\n\n\t\t// render\n\t\tthis.render(delta);\n\n\t\t// update stats\n\t\tthis.stats.update();\n\t};\n\n\t/**\n\t * @private\n\t * Renders a frame\n\t * @param delta {number}\n\t */\n\trender(delta) {\n\t\tdispatchEvent(this.events, \"bluemapRenderFrame\", {\n\t\t\tdelta: delta,\n\t\t});\n\n\t\t// render\n\t\tthis.renderer.clear();\n\n\t\t// prepare skybox camera\n\t\tthis.skyboxCamera.rotation.copy(this.camera.rotation);\n\n\t\t// render skybox\n\t\tthis.renderer.render(this.skyboxScene, this.skyboxCamera);\n\t\tthis.renderer.clearDepth();\n\n\t\tif (this.map && this.map.isLoaded) {\n\n\t\t\t// shift whole scene including camera towards 0,0 to tackle shader-precision issues\n\t\t\tconst s = 10000;\n\t\t\tconst sX = Math.round(this.camera.position.x / s) * s;\n\t\t\tconst sZ = Math.round(this.camera.position.z / s) * s;\n\t\t\tthis.camera.position.x -= sX;\n\t\t\tthis.camera.position.z -= sZ;\n\n\t\t\t// update uniforms\n\t\t\tthis.data.uniforms.hiresTileMap.value.pos.copy(this.map.hiresTileManager.centerTile);\n\t\t\tthis.data.uniforms.hiresTileMap.value.translate.set(\n\t\t\t\tthis.map.data.hires.translate.x - sX,\n\t\t\t\tthis.map.data.hires.translate.z - sZ\n\t\t\t);\n\n\t\t\t// prepare camera for lowres\n\t\t\tconst cameraFar = this.camera.far;\n\t\t\tif (this.controlsManager.distance < 1000) {\n\t\t\t\tthis.camera.far = 1000000; // disable far clipping for lowres\n\t\t\t}\n\t\t\tthis.camera.updateProjectionMatrix();\n\n\t\t\t// render lowres\n\t\t\tconst highestLod = this.map.lowresTileManager.length - 1;\n\t\t\tfor (let i = this.map.lowresTileManager.length - 1; i >= 0; i--) {\n\t\t\t\tif (i === highestLod || this.controlsManager.distance < 1000 * Math.pow(this.map.data.lowres.lodFactor, i + 1)) {\n\t\t\t\t\tlet scenePos = this.map.lowresTileManager[i].scene.position;\n\t\t\t\t\tscenePos.x = -sX;\n\t\t\t\t\tscenePos.z = -sZ;\n\t\t\t\t\tthis.renderer.render(this.map.lowresTileManager[i].sceneParent, this.camera);\n\t\t\t\t\tthis.renderer.clearDepth();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.camera.far = cameraFar; // reset far clipping\n\n\t\t\t// render hires\n\t\t\tif (this.controlsManager.distance < 1000) {\n\t\t\t\tthis.camera.updateProjectionMatrix();\n\t\t\t\tlet scenePos = this.map.hiresTileManager.scene.position;\n\t\t\t\tscenePos.x = -sX;\n\t\t\t\tscenePos.z = -sZ;\n\t\t\t\tthis.renderer.render(this.map.hiresTileManager.sceneParent, this.camera);\n\t\t\t}\n\n\t\t\t// shift back\n\t\t\tthis.camera.position.x += sX;\n\t\t\tthis.camera.position.z += sZ;\n\n\t\t}\n\n\t\t// render markers\n\t\tthis.renderer.render(this.markers, this.camera);\n\t\tthis.css2dRenderer.render(this.markers, this.camera);\n\t}\n\n\t/**\n\t * Changes / Sets the map that will be loaded and displayed\n\t * @param map {Map}\n\t * @returns Promise<void>\n\t */\n\tswitchMap(map = null) {\n\t\tif (this.map && this.map.isMap) this.map.unload();\n\n\t\tthis.map = map;\n\n\t\tif (this.map && this.map.isMap) {\n\t\t\treturn map.load(HIRES_VERTEX_SHADER, HIRES_FRAGMENT_SHADER, LOWRES_VERTEX_SHADER, LOWRES_FRAGMENT_SHADER, this.data.uniforms, this.tileCacheHash)\n\t\t\t\t.then(() => {\n\t\t\t\t\tfor (let texture of this.map.loadedTextures){\n\t\t\t\t\t\tthis.renderer.initTexture(texture);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.data.uniforms.skyColor.value = map.data.skyColor;\n\t\t\t\t\tthis.data.uniforms.ambientLight.value = map.data.ambientLight;\n\t\t\t\t\tthis.data.uniforms.hiresTileMap.value.map = map.hiresTileManager.tileMap.texture;\n\t\t\t\t\tthis.data.uniforms.hiresTileMap.value.scale.set(map.data.hires.tileSize.x, map.data.hires.tileSize.z);\n\t\t\t\t\tthis.data.uniforms.hiresTileMap.value.translate.set(map.data.hires.translate.x, map.data.hires.translate.z);\n\n\t\t\t\t\tsetTimeout(this.updateLoadedMapArea);\n\n\t\t\t\t\tdispatchEvent(this.events, \"bluemapMapChanged\", {\n\t\t\t\t\t\tmap: map\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\talert(this.events, error, \"error\");\n\t\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\t/**\n\t * Loads the given area on the map (and unloads everything outside that area)\n\t * @param centerX {number}\n\t * @param centerZ {number}\n\t * @param hiresViewDistance {number?}\n\t * @param lowresViewDistance {number?}\n\t */\n\tloadMapArea(centerX, centerZ, hiresViewDistance = -1, lowresViewDistance = -1) {\n\t\tthis.data.loadedCenter.set(centerX, centerZ);\n\t\tif (hiresViewDistance >= 0) this.data.loadedHiresViewDistance = hiresViewDistance;\n\t\tif (lowresViewDistance >= 0) this.data.loadedLowresViewDistance = lowresViewDistance;\n\n\t\tthis.updateLoadedMapArea();\n\t}\n\n\tupdateLoadedMapArea = () => {\n\t\tif (!this.map) return;\n\t\tif (this.controlsManager.distance < 1000) {\n\t\t\tthis.map.loadMapArea(this.data.loadedCenter.x, this.data.loadedCenter.y, this.data.loadedHiresViewDistance, this.data.loadedLowresViewDistance);\n\t\t} else {\n\t\t\tthis.map.loadMapArea(this.data.loadedCenter.x, this.data.loadedCenter.y, 0, this.data.loadedLowresViewDistance);\n\t\t}\n\t}\n\n\tclearTileCache(newTileCacheHash) {\n\t\tif (!newTileCacheHash) newTileCacheHash = generateCacheHash();\n\n\t\tthis.tileCacheHash = newTileCacheHash;\n\t\tif (this.map) {\n\t\t\tfor (let i = 0; i < this.map.lowresTileManager.length; i++) {\n\t\t\t\tthis.map.lowresTileManager[i].tileLoader.tileCacheHash = this.tileCacheHash;\n\t\t\t}\n\t\t\tthis.map.hiresTileManager.tileLoader.tileCacheHash = this.tileCacheHash;\n\t\t}\n\t}\n\n\t/**\n\t * @returns {number}\n\t */\n\tget superSampling() {\n\t\treturn this.data.superSampling;\n\t}\n\n\t/**\n\t * @param value {number}\n\t */\n\tset superSampling(value) {\n\t\tthis.data.superSampling = value;\n\t\tthis.handleContainerResize();\n\t}\n\n\t/**\n\t * @returns {CombinedCamera}\n\t */\n\tget camera() {\n\t\treturn this._camera;\n\t}\n\n\t/**\n\t * @param value {CombinedCamera}\n\t */\n\tset camera(value) {\n\t\tthis._camera = value;\n\t\tthis.data.camera = value.data;\n\t}\n\n\t/**\n\t * @returns {ControlsManager}\n\t */\n\tget controlsManager() {\n\t\treturn this._controlsManager;\n\t}\n\n\t/**\n\t * @param value {ControlsManager}\n\t */\n\tset controlsManager(value) {\n\t\tthis._controlsManager = value;\n\t\tthis.data.controlsManager = value.data;\n\t}\n\n\t/**\n\t * @returns {Map}\n\t */\n\tget map() {\n\t\treturn this._map;\n\t}\n\n\t/**\n\t * @param value {Map}\n\t */\n\tset map(value) {\n\t\tthis._map = value;\n\t\tif (value) this.data.map = value.data;\n\t}\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"./Marker\";\nimport {CSS2DObject} from \"../util/CSS2DRenderer\";\nimport {animate, EasingFunctions, htmlToElement} from \"../util/Utils\";\n\nexport class PlayerMarker extends Marker {\n\n    /**\n     * @param markerId {string}\n     * @param playerUuid {string}\n     */\n    constructor(markerId, playerUuid) {\n        super(markerId);\n        Object.defineProperty(this, 'isPlayerMarker', {value: true});\n        this.data.type = \"player\";\n\n        this.data.playerUuid = playerUuid;\n        this.data.name = playerUuid;\n\n        this.elementObject = new CSS2DObject(htmlToElement(`\n<div id=\"bm-marker-${this.data.id}\" class=\"bm-marker-${this.data.type}\">\n    <img src=\"assets/playerheads/${this.data.playerUuid}.png\" alt=\"playerhead\" draggable=\"false\">\n    <div class=\"bm-player-name\"></div>\n</div>\n        `));\n        this.elementObject.onBeforeRender = (renderer, scene, camera) => this.onBeforeRender(renderer, scene, camera);\n\n        this.playerHeadElement = this.element.getElementsByTagName(\"img\")[0];\n        this.playerNameElement = this.element.getElementsByTagName(\"div\")[0];\n\n        this.addEventListener( 'removed', () => {\n            if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n        });\n\n        this.playerHeadElement.addEventListener('error', () => {\n            this.playerHeadElement.src = \"assets/steve.png\";\n        }, {once: true});\n\n        this.add(this.elementObject);\n    }\n\n    /**\n     * @returns {Element}\n     */\n    get element() {\n        return this.elementObject.element.getElementsByTagName(\"div\")[0];\n    }\n\n    onBeforeRender(renderer, scene, camera) {\n        let distance = Marker.calculateDistanceToCameraPlane(this.position, camera);\n\n        let value = \"near\";\n        if (distance > 1000) {\n            value = \"med\";\n        }\n        if (distance > 5000) {\n            value = \"far\";\n        }\n\n        this.element.setAttribute(\"distance-data\", value);\n    }\n\n    /**\n     * @typedef PlayerLike {{\n     *      uuid: string,\n     *      name: string,\n     *      foreign: boolean,\n     *      position: {x: number, y: number, z: number},\n     *      rotation: {yaw: number, pitch: number, roll: number}\n     * }}\n     */\n\n    /**\n     * @param markerData {PlayerLike}\n     */\n    updateFromData(markerData) {\n\n        // animate position update\n        let pos = markerData.position || {};\n        if (!this.position.x && !this.position.y && !this.position.z) {\n            this.position.set(\n                pos.x || 0,\n                pos.y || 0,\n                pos.z || 0\n            );\n        } else {\n            let startPos = {\n                x: this.position.x,\n                y: this.position.y,\n                z: this.position.z,\n            }\n            let deltaPos = {\n                x: (pos.x || 0) - startPos.x,\n                y: ((pos.y || 0) + 1.8) - startPos.y,\n                z: (pos.z || 0) - startPos.z,\n            }\n            if (deltaPos.x || deltaPos.y || deltaPos.z) {\n                animate(progress => {\n                    let ease = EasingFunctions.easeInOutCubic(progress);\n                    this.position.set(\n                        startPos.x + deltaPos.x * ease || 0,\n                        startPos.y + deltaPos.y * ease || 0,\n                        startPos.z + deltaPos.z * ease || 0\n                    );\n                }, 500);\n            }\n        }\n\n        // update name\n        let name = markerData.name || this.data.playerUuid;\n        this.data.name = name;\n        if (this.playerNameElement.innerHTML !== name)\n            this.playerNameElement.innerHTML = name;\n\n        // update world\n        this.data.foreign = markerData.foreign;\n    }\n\n    dispose() {\n        super.dispose();\n\n        let element = this.elementObject.element;\n        if (element.parentNode) element.parentNode.removeChild(element);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MarkerSet} from \"./MarkerSet\";\nimport {alert} from \"../util/Utils\";\nimport {PlayerMarker} from \"./PlayerMarker\";\n\nexport class PlayerMarkerSet extends MarkerSet {\n\n    constructor(id) {\n        super(id);\n        this.data.label = \"Player\";\n        this.data.toggleable = true;\n        this.data.defaultHide = false;\n    }\n\n    updateFromPlayerData(data) {\n        if (!Array.isArray(data.players)) {\n            this.clear();\n            return false;\n        }\n\n        /** @type Set<Marker> */\n        let updatedPlayerMarkers = new Set();\n\n        // update\n        data.players.forEach(playerData => {\n            try {\n                let playerMarker = this.updatePlayerMarkerFromData(playerData);\n                updatedPlayerMarkers.add(playerMarker);\n            } catch (err) {\n                alert(this.events, err, \"fine\");\n            }\n        });\n\n        // remove\n        this.markers.forEach(playerMarker => {\n            if (!updatedPlayerMarkers.has(playerMarker)) {\n                this.remove(playerMarker);\n            }\n        });\n\n        return true;\n    }\n\n    updatePlayerMarkerFromData(markerData) {\n        let playerUuid = markerData.uuid;\n        if (!playerUuid) throw new Error(\"player-data has no uuid!\");\n        let markerId = this.getPlayerMarkerId(playerUuid);\n\n        /** @type PlayerMarker */\n        let marker = this.markers.get(markerId);\n\n        // create new if not existent of wrong type\n        if (!marker || !marker.isPlayerMarker) {\n            if (marker) this.remove(marker);\n            marker = new PlayerMarker(markerId, playerUuid);\n            this.add(marker);\n        }\n\n        // update\n        marker.updateFromData(markerData);\n\n        // hide if from different world\n        marker.visible = !markerData.foreign;\n\n        return marker;\n    }\n\n    getPlayerMarker(playerUuid) {\n        return this.markers.get(this.getPlayerMarkerId(playerUuid));\n    }\n\n    getPlayerMarkerId(playerUuid) {\n        return \"bm-player-\" + playerUuid;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {FileLoader, Scene} from \"three\";\nimport {MarkerSet} from \"./MarkerSet\";\nimport {alert, generateCacheHash} from \"../util/Utils\";\nimport {PlayerMarkerSet} from \"./PlayerMarkerSet\";\n\nexport const MarkerFileType = {\n    NORMAL: 1,\n    PLAYER: 2,\n}\n\nexport const PLAYER_MARKER_SET_ID = \"bm-players\";\n\n/**\n * A manager for loading and updating markers from a file\n */\nexport class MarkerManager {\n\n    /**\n     * @constructor\n     * @param root {MarkerSet} - The scene to which all markers will be added\n     * @param fileUrl {string} - The marker file from which this manager updates its markers\n     * @param fileType {number} - The type of the marker-file, see MarkerManager.NORMAL and MarkerManager.PLAYER\n     * @param events {EventTarget}\n     */\n    constructor(root, fileUrl, fileType, events = null) {\n        Object.defineProperty(this, 'isMarkerManager', {value: true});\n\n        this.root = root;\n        this.fileUrl = fileUrl;\n        this.fileType = fileType;\n        this.events = events;\n        this.disposed = false;\n\n        /** @type {NodeJS.Timeout} */\n        this._updateInterval = null;\n    }\n\n    /**\n     * Sets the automatic-update frequency, setting this to 0 or negative disables automatic updates (default).\n     * This is better than using setInterval() on update() because this will wait for the update to finish before requesting the next update.\n     * @param ms - interval in milliseconds\n     */\n    setAutoUpdateInterval(ms) {\n        if (this._updateInterval) clearTimeout(this._updateInterval);\n        if (ms > 0) {\n            let autoUpdate = () => {\n                if (this.disposed) return;\n                this.update()\n                    .then(success => {\n                        if (success) {\n                            this._updateInterval = setTimeout(autoUpdate, ms);\n                        } else {\n                            this._updateInterval = setTimeout(autoUpdate, Math.max(ms, 1000 * 15));\n                        }\n                    })\n                    .catch(e => {\n                        alert(this.events, e, \"warning\");\n                        this._updateInterval = setTimeout(autoUpdate, Math.max(ms, 1000 * 15));\n                    });\n            };\n\n            this._updateInterval = setTimeout(autoUpdate, ms);\n        }\n    }\n\n    /**\n     * Loads the marker-file and updates all managed markers.\n     * @returns {Promise<object>} - A promise completing when the markers finished updating\n     */\n    update() {\n        return this.loadMarkerFile()\n            .then(markerFileData => this.updateFromData(markerFileData));\n    }\n\n    /**\n     * @private\n     * @param markerData\n     */\n    updateFromData(markerData) {\n        switch (this.fileType) {\n            case MarkerFileType.NORMAL: return this.updateFromDataNormal(markerData);\n            case MarkerFileType.PLAYER: return this.updateFromDataPlayer(markerData);\n        }\n    }\n\n    /**\n     * @private\n     * @param markerData\n     * @returns {boolean}\n     */\n    updateFromDataNormal(markerData) {\n        this.root.updateMarkerSetsFromData(markerData, [PLAYER_MARKER_SET_ID, \"bm-popup-set\"]);\n        return true;\n    }\n\n    /**\n     * @private\n     * @param markerFileData\n     * @returns {boolean}\n     */\n    updateFromDataPlayer(markerFileData) {\n        let playerMarkerSet = this.getPlayerMarkerSet();\n        return playerMarkerSet.updateFromPlayerData(markerFileData);\n    }\n\n    /**\n     * @private\n     * @returns {PlayerMarkerSet}\n     */\n    getPlayerMarkerSet() {\n        /** @type {PlayerMarkerSet} */\n        let playerMarkerSet = /** @type {PlayerMarkerSet} */ this.root.markerSets.get(PLAYER_MARKER_SET_ID);\n\n        if (!playerMarkerSet) {\n            playerMarkerSet = new PlayerMarkerSet(PLAYER_MARKER_SET_ID);\n            this.root.add(playerMarkerSet);\n        }\n\n        return playerMarkerSet;\n    }\n\n    /**\n     * @param playerUuid {string}\n     * @returns {PlayerMarker | undefined}\n     */\n    getPlayerMarker(playerUuid) {\n        return this.getPlayerMarkerSet().getPlayerMarker(playerUuid)\n    }\n\n    /**\n     * Stops automatic-updates and disposes all markersets and markers managed by this manager\n     */\n    dispose() {\n        this.disposed = true;\n        this.setAutoUpdateInterval(0);\n        this.clear();\n    }\n\n    /**\n     * Removes all markers managed by this marker-manager\n     */\n    clear() {\n        this.root.clear();\n    }\n\n    /**\n     * @private\n     * Loads the marker file\n     * @returns {Promise<Object>} - A promise completing with the parsed json object from the loaded file\n     */\n    loadMarkerFile() {\n        return new Promise((resolve, reject) => {\n            let loader = new FileLoader();\n            loader.setResponseType(\"json\");\n            loader.load(this.fileUrl + \"?\" + generateCacheHash(),\n                markerFileData => {\n                    if (!markerFileData) reject(`Failed to parse '${this.fileUrl}'!`);\n                    else resolve(markerFileData);\n                },\n                () => {},\n                () => reject(`Failed to load '${this.fileUrl}'!`)\n            )\n        });\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {VEC2_ZERO} from \"../../../util/Utils\";\n\nexport class MouseMoveControls {\n\n    static tempVec2_1 = new Vector2();\n\n    /**\n     * @param target {Element}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastPosition = new Vector2();\n        this.deltaPosition = new Vector2();\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let directionDelta = MouseMoveControls.tempVec2_1.copy(this.deltaPosition);\n        directionDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += directionDelta.x * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierX;\n        this.manager.position.z += directionDelta.y * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    reset() {\n        this.deltaPosition.set(0, 0);\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        if ((evt.buttons !== undefined ? evt.buttons === 1 : evt.button === 0) && !evt.altKey) {\n            this.moving = true;\n            this.deltaPosition.set(0, 0);\n            this.lastPosition.set(evt.x, evt.y);\n        }\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        let position = MouseMoveControls.tempVec2_1.set(evt.x, evt.y);\n\n        if(this.moving){\n            this.deltaPosition.sub(position).add(this.lastPosition);\n        }\n\n        this.lastPosition.copy(position);\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        if (evt.button === 0) this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseZoomControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.stiffness = stiffness;\n        this.speed = speed;\n\n        this.deltaZoom = 0;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"wheel\", this.onMouseWheel, {passive: true});\n    }\n\n    stop() {\n        this.target.removeEventListener(\"wheel\", this.onMouseWheel);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaZoom === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.distance *= Math.pow(1.5, this.deltaZoom * smoothing * this.speed);\n\n        this.deltaZoom *= 1 - smoothing;\n        if (Math.abs(this.deltaZoom) < 0.0001) {\n            this.deltaZoom = 0;\n        }\n    }\n\n    reset() {\n        this.deltaZoom = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {WheelEvent}\n     */\n    onMouseWheel = evt => {\n        let delta = evt.deltaY;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_PIXEL) delta *= 0.01;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_LINE) delta *= 0.33;\n\n        this.deltaZoom += delta;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseRotateControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastX = 0;\n        this.deltaRotation = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing * this.speed * this.pixelToSpeedMultiplierX;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    reset() {\n        this.deltaRotation = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        if ((evt.buttons !== undefined ? evt.buttons === 2 : evt.button === 2) ||\n            ((evt.altKey || evt.ctrlKey) && (evt.buttons !== undefined ? evt.buttons === 1 : evt.button === 0))) {\n            this.moving = true;\n            this.deltaRotation = 0;\n            this.lastX = evt.x;\n        }\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if(this.moving){\n            this.deltaRotation += evt.x - this.lastX;\n        }\n\n        this.lastX = evt.x;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth); //* (this.target.clientWidth / this.target.clientHeight);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseAngleControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastY = 0;\n        this.deltaAngle = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    reset() {\n        this.deltaAngle = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        if ((evt.buttons !== undefined ? evt.buttons === 2 : evt.button === 2) ||\n            ((evt.altKey || evt.ctrlKey) && (evt.buttons !== undefined ? evt.buttons === 1 : evt.button === 0))) {\n            this.moving = true;\n            this.deltaAngle = 0;\n            this.lastY = evt.y;\n        }\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if(this.moving){\n            this.deltaAngle -= evt.y - this.lastY;\n        }\n\n        this.lastY = evt.y;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\n\nexport class MapHeightControls {\n\n    /**\n     * @param cameraHeightStiffness {number}\n     * @param targetHeightStiffness {number}\n     */\n    constructor(cameraHeightStiffness, targetHeightStiffness) {\n        this.manager = null;\n\n        this.cameraHeightStiffness = cameraHeightStiffness;\n        this.targetHeightStiffness = targetHeightStiffness;\n        this.maxAngle = Math.PI / 2;\n\n        this.targetHeight = 0;\n        this.cameraHeight = 0;\n\n        this.minCameraHeight = 0;\n        this.distanceTagretHeight = 0;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n    }\n\n    stop() {}\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n\n        // adjust target height\n        this.updateHeights(delta, map);\n        this.manager.position.y = Math.max(this.manager.position.y, this.getSuggestedHeight());\n    }\n\n    updateHeights(delta, map) {\n        //target height\n        let targetSmoothing = this.targetHeightStiffness / (16.666 / delta);\n        targetSmoothing = MathUtils.clamp(targetSmoothing, 0, 1);\n\n        let targetTerrainHeight = map.terrainHeightAt(this.manager.position.x, this.manager.position.z) + 3 || 0;\n\n        let targetDelta = targetTerrainHeight - this.targetHeight;\n        this.targetHeight += targetDelta * targetSmoothing;\n        if (Math.abs(targetDelta) < 0.001) this.targetHeight = targetTerrainHeight;\n\n        // camera height\n        this.minCameraHeight = 0;\n        if (this.maxAngle >= 0.1) {\n            let cameraSmoothing = this.cameraHeightStiffness / (16.666 / delta);\n            cameraSmoothing = MathUtils.clamp(cameraSmoothing, 0, 1);\n\n            let cameraTerrainHeight = map.terrainHeightAt(this.manager.camera.position.x, this.manager.camera.position.z) || 0;\n\n            let cameraDelta = cameraTerrainHeight - this.cameraHeight;\n            this.cameraHeight += cameraDelta * cameraSmoothing;\n            if (Math.abs(cameraDelta) < 0.001) this.cameraHeight = cameraTerrainHeight;\n\n            let maxAngleHeight = Math.cos(this.maxAngle) * this.manager.distance;\n            this.minCameraHeight = this.cameraHeight - maxAngleHeight + 1;\n        }\n\n        // adjust targetHeight by distance\n        this.distanceTagretHeight = Math.max(MathUtils.lerp(this.targetHeight, 0, this.manager.distance / 500), 0);\n    }\n\n    getSuggestedHeight() {\n        return Math.max(this.distanceTagretHeight, this.minCameraHeight);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nexport class KeyCombination {\n\n    static CTRL = 0;\n    static SHIFT = 1;\n    static ALT = 2;\n\n    /**\n     * @param code {string}\n     * @param modifiers {...number}\n     */\n    constructor(code, ...modifiers) {\n\n        this.code = code;\n        this.ctrl = modifiers.includes(KeyCombination.CTRL) || this.code === \"CtrlLeft\" || this.code === \"CtrlRight\";\n        this.shift = modifiers.includes(KeyCombination.SHIFT) || this.code === \"ShiftLeft\" || this.code === \"ShiftRight\";\n        this.alt = modifiers.includes(KeyCombination.ALT) || this.code === \"AltLeft\" || this.code === \"AltRight\";\n\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     * @returns {boolean}\n     */\n    testDown(evt) {\n        return this.code === evt.code &&\n            this.ctrl === evt.ctrlKey &&\n            this.shift === evt.shiftKey &&\n            this.alt === evt.altKey;\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     * @returns {boolean}\n     */\n    testUp(evt) {\n        return this.code === evt.code;\n    }\n\n    static oneDown(evt, ...combinations) {\n        for (let combination of combinations){\n            if (combination.testDown(evt)) return true;\n        }\n        return false;\n    }\n\n    static oneUp(evt, ...combinations) {\n        for (let combination of combinations){\n            if (combination.testUp(evt)) return true;\n        }\n        return false;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {VEC2_ZERO} from \"../../../util/Utils\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyMoveControls {\n\n    static KEYS = {\n        LEFT: [\n            new KeyCombination(\"ArrowLeft\"),\n            new KeyCombination(\"KeyA\")\n        ],\n        UP: [\n            new KeyCombination(\"ArrowUp\"),\n            new KeyCombination(\"KeyW\")\n        ],\n        RIGHT: [\n            new KeyCombination(\"ArrowRight\"),\n            new KeyCombination(\"KeyD\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ArrowDown\"),\n            new KeyCombination(\"KeyS\")\n        ],\n    }\n\n    static temp_v2 = new Vector2();\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaPosition = new Vector2();\n\n        this.up = false;\n        this.down = false;\n        this.left = false;\n        this.right = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaPosition.y -= 1;\n        if (this.down) this.deltaPosition.y += 1;\n        if (this.left) this.deltaPosition.x -= 1;\n        if (this.right) this.deltaPosition.x += 1;\n\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let rotatedDelta = KeyMoveControls.temp_v2.copy(this.deltaPosition);\n        rotatedDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += rotatedDelta.x * smoothing * this.manager.distance * this.speed * delta * 0.06;\n        this.manager.position.z += rotatedDelta.y * smoothing * this.manager.distance * this.speed * delta * 0.06;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyAngleControls {\n\n    static KEYS = {\n        UP: [\n            new KeyCombination(\"ArrowUp\", KeyCombination.ALT),\n            new KeyCombination(\"KeyW\", KeyCombination.ALT),\n            new KeyCombination(\"PageUp\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ArrowDown\", KeyCombination.ALT),\n            new KeyCombination(\"KeyS\", KeyCombination.ALT),\n            new KeyCombination(\"PageDown\")\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaAngle = 0;\n\n        this.up = false;\n        this.down = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaAngle -= 1;\n        if (this.down) this.deltaAngle += 1;\n\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing * this.speed * delta * 0.06;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyAngleControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyAngleControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyAngleControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyAngleControls.KEYS.DOWN)){\n            this.down = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyRotateControls {\n\n    static KEYS = {\n        LEFT: [\n            new KeyCombination(\"ArrowLeft\", KeyCombination.ALT),\n            new KeyCombination(\"KeyA\", KeyCombination.ALT),\n            new KeyCombination(\"Delete\"),\n        ],\n        RIGHT: [\n            new KeyCombination(\"ArrowRight\", KeyCombination.ALT),\n            new KeyCombination(\"KeyD\", KeyCombination.ALT),\n            new KeyCombination(\"End\"),\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaRotation = 0;\n\n        this.left = false;\n        this.right = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.left) this.deltaRotation += 1;\n        if (this.right) this.deltaRotation -= 1;\n\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing * this.speed * delta * 0.06;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyRotateControls.KEYS.LEFT)){\n            this.left = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyRotateControls.KEYS.RIGHT)){\n            this.right = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyRotateControls.KEYS.LEFT)){\n            this.left = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyRotateControls.KEYS.RIGHT)){\n            this.right = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyZoomControls {\n\n    static KEYS = {\n        IN: [\n            new KeyCombination(\"NumpadAdd\"),\n            new KeyCombination(\"Insert\"),\n        ],\n        OUT: [\n            new KeyCombination(\"NumpadSubtract\"),\n            new KeyCombination(\"Home\"),\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaZoom = 0;\n\n        this.in = false;\n        this.out = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.in) this.deltaZoom -= 1;\n        if (this.out) this.deltaZoom += 1;\n\n        if (this.deltaZoom === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.distance *= Math.pow(1.5, this.deltaZoom * smoothing * this.speed * delta * 0.06);\n\n        this.deltaZoom *= 1 - smoothing;\n        if (Math.abs(this.deltaZoom) < 0.0001) {\n            this.deltaZoom = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneDown(evt, ...KeyZoomControls.KEYS.IN)){\n            this.in = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneDown(evt, ...KeyZoomControls.KEYS.OUT)){\n            this.out = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyZoomControls.KEYS.IN)){\n            this.in = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyZoomControls.KEYS.OUT)){\n            this.out = false;\n        }\n    }\n\n}","import {MathUtils, Vector2} from \"three\";\n/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {VEC2_ZERO} from \"../../../util/Utils\";\n\nexport class TouchMoveControls {\n\n    static tempVec2_1 = new Vector2();\n\n    /**\n     * @param target {Element}\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, hammer, speed, stiffness) {\n        this.target = target;\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastPosition = new Vector2();\n        this.deltaPosition = new Vector2();\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"movestart\", this.onTouchDown);\n        this.hammer.on(\"movemove\", this.onTouchMove);\n        this.hammer.on(\"moveend\", this.onTouchUp);\n        this.hammer.on(\"movecancel\", this.onTouchUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.hammer.off(\"movestart\", this.onTouchDown);\n        this.hammer.off(\"movemove\", this.onTouchMove);\n        this.hammer.off(\"moveend\", this.onTouchUp);\n        this.hammer.off(\"movecancel\", this.onTouchUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let directionDelta = TouchMoveControls.tempVec2_1.copy(this.deltaPosition);\n        directionDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += directionDelta.x * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierX;\n        this.manager.position.z += directionDelta.y * smoothing * this.manager.distance * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    reset() {\n        this.deltaPosition.set(0, 0);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = true;\n        this.deltaPosition.set(0, 0);\n        this.lastPosition.set(evt.center.x, evt.center.y);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        let position = TouchMoveControls.tempVec2_1.set(evt.center.x, evt.center.y);\n\n        if(this.moving){\n            this.deltaPosition.sub(position).add(this.lastPosition);\n        }\n\n        this.lastPosition.copy(position);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class TouchRotateControls {\n\n    /**\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(hammer, speed, stiffness) {\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastRotation = 0;\n        this.deltaRotation = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"rotatestart\", this.onTouchDown);\n        this.hammer.on(\"rotatemove\", this.onTouchMove);\n        this.hammer.on(\"rotateend\", this.onTouchUp);\n        this.hammer.on(\"rotatecancel\", this.onTouchUp);\n    }\n\n    stop() {\n        this.hammer.off(\"rotatestart\", this.onTouchDown);\n        this.hammer.off(\"rotatemove\", this.onTouchMove);\n        this.hammer.off(\"rotateend\", this.onTouchUp);\n        this.hammer.off(\"rotatecancel\", this.onTouchUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing * this.speed;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    reset() {\n        this.deltaRotation = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        this.moving = true;\n        this.deltaRotation = 0;\n        this.lastRotation = evt.rotation;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if(this.moving){\n            let delta = evt.rotation - this.lastRotation;\n            if (delta > 180) delta -= 360;\n            if (delta < -180) delta += 360;\n\n            this.deltaRotation -= delta;\n        }\n\n        this.lastRotation = evt.rotation;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        this.moving = false;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class TouchAngleControls {\n\n    /**\n     * @param target {Element}\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, hammer, speed, stiffness) {\n        this.target = target;\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastY = 0;\n        this.deltaAngle = 0;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"tiltstart\", this.onTouchDown);\n        this.hammer.on(\"tiltmove\", this.onTouchMove);\n        this.hammer.on(\"tiltend\", this.onTouchUp);\n        this.hammer.on(\"tiltcancel\", this.onTouchUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.hammer.off(\"tiltstart\", this.onTouchDown);\n        this.hammer.off(\"tiltmove\", this.onTouchMove);\n        this.hammer.off(\"tiltend\", this.onTouchUp);\n        this.hammer.off(\"tiltcancel\", this.onTouchUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing * this.speed * this.pixelToSpeedMultiplierY;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    reset() {\n        this.deltaAngle = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        this.moving = true;\n        this.deltaAngle = 0;\n        this.lastY = evt.center.y;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if(this.moving){\n            this.deltaAngle -= evt.center.y - this.lastY;\n        }\n\n        this.lastY = evt.center.y;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nexport class TouchZoomControls {\n\n    /**\n     * @param hammer {Manager}\n     */\n    constructor(hammer) {\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.deltaZoom = 1;\n        this.lastZoom = 1;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"zoomstart\", this.onTouchDown);\n        this.hammer.on(\"zoommove\", this.onTouchMove);\n        this.hammer.on(\"zoomend\", this.onTouchUp);\n        this.hammer.on(\"zoomcancel\", this.onTouchUp);\n    }\n\n    stop() {\n        this.hammer.off(\"zoomstart\", this.onTouchDown);\n        this.hammer.off(\"zoommove\", this.onTouchMove);\n        this.hammer.off(\"zoomend\", this.onTouchUp);\n        this.hammer.off(\"zoomcancel\", this.onTouchUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaZoom === 1) return;\n\n        this.manager.distance /= this.deltaZoom;\n        this.deltaZoom = 1;\n    }\n\n    reset() {\n        this.deltaZoom = 1;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        this.moving = true;\n        this.lastZoom = 1;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if(this.moving){\n            this.deltaZoom *= evt.scale / this.lastZoom;\n        }\n\n        this.lastZoom = evt.scale;\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        this.moving = false;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MouseMoveControls} from \"./mouse/MouseMoveControls\";\nimport {MouseZoomControls} from \"./mouse/MouseZoomControls\";\nimport {MouseRotateControls} from \"./mouse/MouseRotateControls\";\nimport {MouseAngleControls} from \"./mouse/MouseAngleControls\";\nimport {MathUtils, Vector2, Vector3} from \"three\";\nimport {Manager, Pan, Pinch, Rotate, Tap, DIRECTION_ALL, DIRECTION_VERTICAL} from \"hammerjs\";\nimport {softClamp} from \"../../util/Utils\";\nimport {MapHeightControls} from \"./MapHeightControls\";\nimport {KeyMoveControls} from \"./keyboard/KeyMoveControls\";\nimport {KeyAngleControls} from \"./keyboard/KeyAngleControls\";\nimport {KeyRotateControls} from \"./keyboard/KeyRotateControls\";\nimport {KeyZoomControls} from \"./keyboard/KeyZoomControls\";\nimport {TouchMoveControls} from \"./touch/TouchMoveControls\";\nimport {TouchRotateControls} from \"./touch/TouchRotateControls\";\nimport {TouchAngleControls} from \"./touch/TouchAngleControls\";\nimport {TouchZoomControls} from \"./touch/TouchZoomControls\";\nimport {PlayerMarker} from \"../../markers/PlayerMarker\";\n\nconst HALF_PI = Math.PI * 0.5;\n\nexport class MapControls {\n\n    static _beforeMoveTemp = new Vector3();\n\n    /**\n     * @param rootElement {Element}\n     */\n    constructor(rootElement) {\n        this.rootElement = rootElement;\n\n        this.data = {\n            followingPlayer: null\n        };\n\n        /** @type {ControlsManager} */\n        this.manager = null;\n\n        this.hammer = new Manager(this.rootElement);\n        this.initializeHammer();\n\n        //controls\n        this.mouseMove = new MouseMoveControls(this.rootElement, 1.5,0.3);\n        this.mouseRotate = new MouseRotateControls(this.rootElement, 6, 0.3);\n        this.mouseAngle = new MouseAngleControls(this.rootElement, 3, 0.3);\n        this.mouseZoom = new MouseZoomControls(this.rootElement, 1, 0.2);\n\n        this.keyMove = new KeyMoveControls(this.rootElement, 0.025, 0.2);\n        this.keyRotate = new KeyRotateControls(this.rootElement, 0.06, 0.15);\n        this.keyAngle = new KeyAngleControls(this.rootElement, 0.04, 0.15);\n        this.keyZoom = new KeyZoomControls(this.rootElement, 0.2, 0.15);\n\n        this.touchMove = new TouchMoveControls(this.rootElement, this.hammer, 1.5,0.3);\n        this.touchRotate = new TouchRotateControls(this.hammer, 0.0174533, 0.3);\n        this.touchAngle = new TouchAngleControls(this.rootElement, this.hammer, 3, 0.3);\n        this.touchZoom = new TouchZoomControls(this.hammer);\n\n        this.mapHeight = new MapHeightControls(0.2, 0.1);\n\n        this.lastTap = -1;\n        this.lastTapCenter = null;\n\n        this.minDistance = 5;\n        this.maxDistance = 100000;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.rootElement.addEventListener(\"contextmenu\", this.onContextMenu);\n        this.hammer.on(\"tap\", this.onTap);\n\n        this.mouseMove.start(manager);\n        this.mouseRotate.start(manager);\n        this.mouseAngle.start(manager);\n        this.mouseZoom.start(manager);\n\n        this.keyMove.start(manager);\n        this.keyRotate.start(manager);\n        this.keyAngle.start(manager);\n        this.keyZoom.start(manager);\n\n        this.touchMove.start(manager);\n        this.touchRotate.start(manager);\n        this.touchAngle.start(manager);\n        this.touchZoom.start(manager);\n\n        this.mapHeight.start(manager);\n    }\n\n    stop() {\n        this.stopFollowingPlayerMarker();\n\n        this.rootElement.removeEventListener(\"contextmenu\", this.onContextMenu);\n        this.hammer.off(\"tap\", this.onTap);\n\n        this.mouseMove.stop();\n        this.mouseRotate.stop();\n        this.mouseAngle.stop();\n        this.mouseZoom.stop();\n\n        this.keyMove.stop();\n        this.keyRotate.stop();\n        this.keyAngle.stop();\n        this.keyZoom.stop();\n\n        this.touchMove.stop();\n        this.touchRotate.stop();\n        this.touchAngle.stop();\n        this.touchZoom.stop();\n\n        this.mapHeight.stop();\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        this.manager.position.y = 0; // reset target y position\n\n        // move\n        MapControls._beforeMoveTemp.copy(this.manager.position);\n        this.mouseMove.update(delta, map);\n        this.keyMove.update(delta, map);\n        this.touchMove.update(delta, map);\n\n        // if moved, stop following the marker and give back control\n        if (this.data.followingPlayer && !MapControls._beforeMoveTemp.equals(this.manager.position)) {\n            this.stopFollowingPlayerMarker();\n        }\n\n        // follow player marker\n        if (this.data.followingPlayer) {\n            this.manager.position.copy(this.data.followingPlayer.position);\n        }\n\n        // zoom\n        this.mouseZoom.update(delta, map);\n        this.keyZoom.update(delta, map);\n        this.touchZoom.update(delta, map);\n\n        this.manager.distance = softClamp(this.manager.distance, this.minDistance, this.maxDistance, 0.8);\n\n        // max angle for current distance\n        let maxAngleForZoom = this.getMaxPerspectiveAngleForDistance(this.manager.distance);\n\n        // rotation\n        this.mouseRotate.update(delta, map);\n        this.keyRotate.update(delta, map);\n        this.touchRotate.update(delta, map);\n\n        const rotating = this.mouseRotate.moving || this.touchRotate.moving ||\n            this.keyRotate.left || this.keyRotate.right\n\n        // snap rotation to north on orthographic view\n        if (this.manager.ortho !== 0 && Math.abs(this.manager.rotation) < (rotating ? 0.05 : 0.3)) {\n            this.manager.rotation = softClamp(this.manager.rotation, 0, 0, 0.1);\n        }\n\n        // tilt\n        if (this.manager.ortho === 0) {\n            this.mouseAngle.update(delta, map);\n            this.keyAngle.update(delta, map);\n            this.touchAngle.update(delta, map);\n            this.manager.angle = softClamp(this.manager.angle, 0, maxAngleForZoom, 0.8);\n        }\n\n        // target height\n        if (this.manager.ortho === 0 || this.manager.angle === 0) {\n            this.mapHeight.maxAngle = maxAngleForZoom;\n            this.mapHeight.update(delta, map);\n        }\n    }\n\n    reset() {\n        this.mouseMove.reset();\n        this.mouseRotate.reset();\n        this.mouseAngle.reset();\n        this.mouseZoom.reset();\n\n        this.touchMove.reset();\n        this.touchRotate.reset();\n        this.touchAngle.reset();\n        this.touchZoom.reset();\n    }\n\n    getMaxPerspectiveAngleForDistance(distance) {\n        return MathUtils.clamp((1 - Math.pow(Math.max(distance - 5, 0.001) / 500, 0.5)) * HALF_PI,0, HALF_PI)\n    }\n\n    initializeHammer() {\n        let touchTap = new Tap({ event: 'tap', pointers: 1, taps: 1, threshold: 5 });\n        let touchMove = new Pan({ event: 'move', pointers: 1, direction: DIRECTION_ALL, threshold: 0 });\n        let touchTilt =  new Pan({ event: 'tilt', pointers: 2, direction: DIRECTION_VERTICAL, threshold: 0 });\n        let touchRotate = new Rotate({ event: 'rotate', pointers: 2, threshold: 0 });\n        let touchZoom = new Pinch({ event: 'zoom', pointers: 2, threshold: 0 });\n\n        touchMove.recognizeWith(touchRotate);\n        touchMove.recognizeWith(touchTilt);\n        touchMove.recognizeWith(touchZoom);\n        touchTilt.recognizeWith(touchRotate);\n        touchTilt.recognizeWith(touchZoom);\n        touchRotate.recognizeWith(touchZoom);\n\n        this.hammer.add(touchTap);\n        this.hammer.add(touchTilt);\n        this.hammer.add(touchMove);\n        this.hammer.add(touchRotate);\n        this.hammer.add(touchZoom);\n    }\n\n    /**\n     * @param marker {object}\n     */\n    followPlayerMarker(marker) {\n        if (marker.isPlayerMarker) marker = marker.data;\n        this.data.followingPlayer = marker;\n    }\n\n    stopFollowingPlayerMarker() {\n        this.data.followingPlayer = null;\n    }\n\n    onContextMenu = evt => {\n        evt.preventDefault();\n    }\n\n    onTap = evt => {\n        let doubleTap = false;\n        let center = new Vector2(evt.center.x, evt.center.y);\n\n        let now = Date.now();\n        if (this.lastTap > 0 && this.lastTapCenter && now - this.lastTap < 500 && this.lastTapCenter.distanceTo(center) < 5){\n            doubleTap = true;\n            this.lastTap = -1;\n        } else {\n            this.lastTap = now;\n            this.lastTapCenter = center;\n        }\n\n        this.manager.handleMapInteraction(new Vector2(evt.center.x, evt.center.y), {doubleTap: doubleTap});\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {VEC2_ZERO} from \"../../../util/Utils\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyMoveControls {\n\n    static KEYS = {\n        LEFT: [\n            new KeyCombination(\"ArrowLeft\"),\n            new KeyCombination(\"KeyA\")\n        ],\n        UP: [\n            new KeyCombination(\"ArrowUp\"),\n            new KeyCombination(\"KeyW\")\n        ],\n        RIGHT: [\n            new KeyCombination(\"ArrowRight\"),\n            new KeyCombination(\"KeyD\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ArrowDown\"),\n            new KeyCombination(\"KeyS\")\n        ],\n    }\n\n    static temp_v2 = new Vector2();\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaPosition = new Vector2();\n\n        this.up = false;\n        this.down = false;\n        this.left = false;\n        this.right = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaPosition.y -= 1;\n        if (this.down) this.deltaPosition.y += 1;\n        if (this.left) this.deltaPosition.x -= 1;\n        if (this.right) this.deltaPosition.x += 1;\n\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        let rotatedDelta = KeyMoveControls.temp_v2.copy(this.deltaPosition);\n        rotatedDelta.rotateAround(VEC2_ZERO, this.manager.rotation);\n\n        this.manager.position.x += rotatedDelta.x * smoothing * this.speed * delta * 0.06;\n        this.manager.position.z += rotatedDelta.y * smoothing * this.speed * delta * 0.06;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = true;\n            evt.preventDefault();\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.DOWN)){\n            this.down = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.LEFT)){\n            this.left = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyMoveControls.KEYS.RIGHT)){\n            this.right = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseRotateControls {\n\n    /**\n     * @param target {Element}\n     * @param speedLeft {number}\n     * @param speedRight {number}\n     * @param speedCapture {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speedLeft, speedRight, speedCapture, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastX = 0;\n        this.deltaRotation = 0;\n\n        this.speedLeft = speedLeft;\n        this.speedRight = speedRight;\n        this.speedCapture = speedCapture;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplier = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaRotation === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaRotation * smoothing;\n\n        this.deltaRotation *= 1 - smoothing;\n        if (Math.abs(this.deltaRotation) < 0.0001) {\n            this.deltaRotation = 0;\n        }\n    }\n\n    reset() {\n        this.deltaRotation = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        this.moving = true;\n        this.deltaRotation = 0;\n        this.lastX = evt.x;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if (document.pointerLockElement) {\n            this.deltaRotation -= evt.movementX * this.speedCapture * this.pixelToSpeedMultiplier;\n        }\n\n        else if(this.moving){\n            if (evt.buttons === 1) {\n                this.deltaRotation -= (evt.x - this.lastX) * this.speedLeft * this.pixelToSpeedMultiplier;\n            } else {\n                this.deltaRotation -= (evt.x - this.lastX) * this.speedRight * this.pixelToSpeedMultiplier;\n            }\n        }\n\n        this.lastX = evt.x;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplier = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\n\nexport class MouseAngleControls {\n\n    /**\n     * @param target {EventTarget}\n     * @param speedLeft {number}\n     * @param speedRight {number}\n     * @param speedCapture {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speedLeft, speedRight, speedCapture, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastY = 0;\n        this.deltaAngle = 0;\n\n        this.speedLeft = speedLeft;\n        this.speedRight = speedRight;\n        this.speedCapture = speedCapture;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplier = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        window.addEventListener(\"mousemove\", this.onMouseMove);\n        window.addEventListener(\"mouseup\", this.onMouseUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        window.removeEventListener(\"mousemove\", this.onMouseMove);\n        window.removeEventListener(\"mouseup\", this.onMouseUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaAngle === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.angle += this.deltaAngle * smoothing;\n\n        this.deltaAngle *= 1 - smoothing;\n        if (Math.abs(this.deltaAngle) < 0.0001) {\n            this.deltaAngle = 0;\n        }\n    }\n\n    reset() {\n        this.deltaAngle = 0;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseDown = evt => {\n        this.moving = true;\n        this.deltaAngle = 0;\n        this.lastY = evt.y;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseMove = evt => {\n        if (document.pointerLockElement) {\n            this.deltaAngle += evt.movementY * this.speedCapture * this.pixelToSpeedMultiplier;\n        }\n\n        else if(this.moving){\n            if (evt.buttons === 1) {\n                this.deltaAngle += (evt.y - this.lastY) * this.speedLeft * this.pixelToSpeedMultiplier;\n            } else {\n                this.deltaAngle += (evt.y - this.lastY) * this.speedRight * this.pixelToSpeedMultiplier;\n            }\n        }\n\n        this.lastY = evt.y;\n    }\n\n    /**\n     * @private\n     * @param evt {MouseEvent}\n     */\n    onMouseUp = evt => {\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplier = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils} from \"three\";\nimport {KeyCombination} from \"../../KeyCombination\";\n\nexport class KeyHeightControls {\n\n    static KEYS = {\n        UP: [\n            new KeyCombination(\"Space\"),\n            new KeyCombination(\"PageUp\")\n        ],\n        DOWN: [\n            new KeyCombination(\"ShiftLeft\"),\n            new KeyCombination(\"ShiftRight\"),\n            new KeyCombination(\"PageDown\")\n        ],\n    }\n\n    /**\n     * @param target {EventTarget}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, speed, stiffness) {\n        this.target = target;\n        this.manager = null;\n\n        this.deltaY = 0;\n\n        this.up = false;\n        this.down = false;\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        window.addEventListener(\"keydown\", this.onKeyDown);\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    stop() {\n        window.removeEventListener(\"keydown\", this.onKeyDown);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.up) this.deltaY += 1;\n        if (this.down) this.deltaY -= 1;\n\n        if (this.deltaY === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.position.y += this.deltaY * smoothing * this.speed * delta * 0.06;\n\n        this.deltaY *= 1 - smoothing;\n        if (Math.abs(this.deltaY) < 0.0001) {\n            this.deltaY = 0;\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyDown = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.UP)){\n            this.up = true;\n            evt.preventDefault();\n        }\n        else if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.DOWN)){\n            this.down = true;\n            evt.preventDefault();\n        }\n    }\n\n    /**\n     * @param evt {KeyboardEvent}\n     */\n    onKeyUp = evt => {\n        if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.UP)){\n            this.up = false;\n        }\n        if (KeyCombination.oneUp(evt, ...KeyHeightControls.KEYS.DOWN)){\n            this.down = false;\n        }\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\n\nexport class TouchPanControls {\n\n    static tempVec2_1 = new Vector2();\n\n    /**\n     * @param target {Element}\n     * @param hammer {Manager}\n     * @param speed {number}\n     * @param stiffness {number}\n     */\n    constructor(target, hammer, speed, stiffness) {\n        this.target = target;\n        this.hammer = hammer;\n        this.manager = null;\n\n        this.moving = false;\n        this.lastPosition = new Vector2();\n        this.deltaPosition = new Vector2();\n\n        this.speed = speed;\n        this.stiffness = stiffness;\n\n        this.pixelToSpeedMultiplierX = 0;\n        this.pixelToSpeedMultiplierY = 0;\n        this.updatePixelToSpeedMultiplier();\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.hammer.on(\"movestart\", this.onTouchDown);\n        this.hammer.on(\"movemove\", this.onTouchMove);\n        this.hammer.on(\"moveend\", this.onTouchUp);\n        this.hammer.on(\"movecancel\", this.onTouchUp);\n\n        window.addEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    stop() {\n        this.hammer.off(\"movestart\", this.onTouchDown);\n        this.hammer.off(\"movemove\", this.onTouchMove);\n        this.hammer.off(\"moveend\", this.onTouchUp);\n        this.hammer.off(\"movecancel\", this.onTouchUp);\n\n        window.removeEventListener(\"resize\", this.updatePixelToSpeedMultiplier);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        if (this.deltaPosition.x === 0 && this.deltaPosition.y === 0) return;\n\n        let smoothing = this.stiffness / (16.666 / delta);\n        smoothing = MathUtils.clamp(smoothing, 0, 1);\n\n        this.manager.rotation += this.deltaPosition.x * this.speed * this.pixelToSpeedMultiplierX * this.stiffness;\n        this.manager.angle -= this.deltaPosition.y * this.speed * this.pixelToSpeedMultiplierY * this.stiffness;\n\n        this.deltaPosition.multiplyScalar(1 - smoothing);\n        if (this.deltaPosition.lengthSq() < 0.0001) {\n            this.deltaPosition.set(0, 0);\n        }\n    }\n\n    reset() {\n        this.deltaPosition.set(0, 0);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchDown = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = true;\n        this.deltaPosition.set(0, 0);\n        this.lastPosition.set(evt.center.x, evt.center.y);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchMove = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        let position = TouchPanControls.tempVec2_1.set(evt.center.x, evt.center.y);\n\n        if(this.moving){\n            this.deltaPosition.sub(position).add(this.lastPosition);\n        }\n\n        this.lastPosition.copy(position);\n    }\n\n    /**\n     * @private\n     * @param evt {object}\n     */\n    onTouchUp = evt => {\n        if (evt.pointerType === \"mouse\") return;\n\n        this.moving = false;\n    }\n\n    updatePixelToSpeedMultiplier = () => {\n        this.pixelToSpeedMultiplierX = (1 / this.target.clientWidth) * (this.target.clientWidth / this.target.clientHeight);\n        this.pixelToSpeedMultiplierY = 1 / this.target.clientHeight;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport {MathUtils, Vector2} from \"three\";\nimport {Manager, Pan, DIRECTION_ALL} from \"hammerjs\";\nimport {animate, EasingFunctions} from \"../../util/Utils\";\nimport {KeyMoveControls} from \"./keyboard/KeyMoveControls\";\nimport {MouseRotateControls} from \"./mouse/MouseRotateControls\";\nimport {MouseAngleControls} from \"./mouse/MouseAngleControls\";\nimport {KeyHeightControls} from \"./keyboard/KeyHeightControls\";\nimport {TouchPanControls} from \"./touch/TouchPanControls\";\n\nexport class FreeFlightControls {\n\n    /**\n     * @param target {Element}\n     */\n    constructor(target) {\n        this.target = target;\n        this.manager = null;\n\n        this.data = {\n\n        };\n\n        this.hammer = new Manager(this.target);\n        this.initializeHammer();\n\n        this.keyMove = new KeyMoveControls(this.target, 0.5, 0.1);\n        this.keyHeight = new KeyHeightControls(this.target, 0.5, 0.2);\n        this.mouseRotate = new MouseRotateControls(this.target, 1.5, -2, -1.5, 0.5);\n        this.mouseAngle = new MouseAngleControls(this.target, 1.5, -2, -1.5, 0.5);\n        this.touchPan = new TouchPanControls(this.target, this.hammer, 5, 0.15);\n\n        this.started = false;\n\n        this.clickStart = new Vector2();\n        this.moveSpeed = 0.5;\n\n        this.animationTargetHeight = 0;\n    }\n\n    /**\n     * @param manager {ControlsManager}\n     */\n    start(manager) {\n        this.manager = manager;\n\n        this.keyMove.start(manager);\n        this.keyHeight.start(manager);\n        this.mouseRotate.start(manager);\n        this.mouseAngle.start(manager);\n        this.touchPan.start(manager);\n\n        this.target.addEventListener(\"contextmenu\", this.onContextMenu);\n        this.target.addEventListener(\"mousedown\", this.onMouseDown);\n        this.target.addEventListener(\"mouseup\", this.onMouseUp);\n        window.addEventListener(\"wheel\", this.onWheel, {passive: true});\n    }\n\n    stop() {\n        this.keyMove.stop();\n        this.keyHeight.stop();\n        this.mouseRotate.stop();\n        this.mouseAngle.stop();\n        this.touchPan.stop();\n\n        this.target.removeEventListener(\"contextmenu\", this.onContextMenu);\n        this.target.removeEventListener(\"mousedown\", this.onMouseDown);\n        this.target.removeEventListener(\"mouseup\", this.onMouseUp);\n        window.removeEventListener(\"wheel\", this.onWheel);\n    }\n\n    /**\n     * @param delta {number}\n     * @param map {Map}\n     */\n    update(delta, map) {\n        this.keyMove.update(delta, map);\n        this.keyHeight.update(delta, map);\n        this.mouseRotate.update(delta, map);\n        this.mouseAngle.update(delta, map);\n        this.touchPan.update(delta, map);\n\n        this.manager.angle = MathUtils.clamp(this.manager.angle, 0, Math.PI);\n        this.manager.distance = 0;\n        this.manager.ortho = 0;\n    }\n\n    initializeHammer() {\n        let touchMove = new Pan({ event: 'move', pointers: 1, direction: DIRECTION_ALL, threshold: 0 });\n        this.hammer.add(touchMove);\n    }\n\n    onContextMenu = evt => {\n        evt.preventDefault();\n    }\n\n    onMouseDown = evt => {\n        this.clickStart.set(evt.x, evt.y);\n    }\n\n    onMouseUp = evt => {\n        if (Math.abs(this.clickStart.x - evt.x) > 5) return;\n        if (Math.abs(this.clickStart.y - evt.y) > 5) return;\n\n        document.body.requestFullscreen()\n            .finally(() => {\n                this.target.requestPointerLock();\n            });\n    }\n\n    onWheel = evt => {\n        let delta = evt.deltaY;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_PIXEL) delta *= 0.01;\n        if (evt.deltaMode === WheelEvent.DOM_DELTA_LINE) delta *= 0.33;\n\n        this.moveSpeed *= Math.pow(1.5, -delta * 0.25);\n        this.moveSpeed = MathUtils.clamp(this.moveSpeed, 0.05, 5);\n\n        this.keyMove.speed = this.moveSpeed;\n        this.keyHeight.speed = this.moveSpeed;\n    }\n\n}","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Object3D} from \"three\";\n\nexport * from \"./MapViewer\";\n\nexport * from \"./map/Map\";\nexport * from \"./map/Tile\";\nexport * from \"./map/TileLoader\";\nexport * from \"./map/TileManager\";\nexport * from \"./map/TileMap\";\n\nexport * from \"./markers/ExtrudeMarker\";\nexport * from \"./markers/HtmlMarker\";\nexport * from \"./markers/LineMarker\";\nexport * from \"./markers/Marker\";\nexport * from \"./markers/MarkerManager\";\nexport * from \"./markers/MarkerSet\";\nexport * from \"./markers/PlayerMarkerSet\";\nexport * from \"./markers/ObjectMarker\";\nexport * from \"./markers/PlayerMarker\";\nexport * from \"./markers/PoiMarker\";\nexport * from \"./markers/ShapeMarker\";\n\nexport * from \"./controls/map/MapControls\";\nexport * from \"./controls/freeflight/FreeFlightControls\";\n\nexport * from \"./util/CombinedCamera\";\nexport * from \"./util/Utils\";\n\n/**\n * @param event {object}\n * @return {boolean} - whether the event has been consumed (true) or not (false)\n */\nObject3D.prototype.onClick = function(event) {\n\n    if (this.parent){\n        if (!Array.isArray(event.eventStack)) event.eventStack = [];\n        event.eventStack.push(this);\n\n        return this.parent.onClick(event);\n    }\n\n    return false;\n};\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport {Marker} from \"bluemap/src/markers/Marker\";\nimport {CSS2DObject} from \"bluemap/src/util/CSS2DRenderer\";\nimport {animate, htmlToElement} from \"bluemap/src/util/Utils\";\nimport {BoxGeometry, MeshBasicMaterial, Mesh, Vector2} from \"three\";\nimport i18n from \"../i18n\";\n\nexport class PopupMarker extends Marker {\n\n    constructor(id, appState, events) {\n        super(id);\n\n        this.data.type = \"popup\";\n        this.data.label = \"Last Map Interaction\";\n\n        this.appState = appState;\n        this.events = events;\n        this.visible = false;\n\n        this.elementObject = new CSS2DObject(htmlToElement(`<div id=\"bm-marker-${this.data.id}\" class=\"bm-marker-${this.data.type}\">Test</div>`));\n        this.elementObject.position.set(0.5, 1, 0.5);\n        this.addEventListener( 'removed', () => {\n            if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n        });\n\n        let cubeGeo = new BoxGeometry(1.01, 1.01, 1.01).translate(0.5, 0.5, 0.5);\n        let cubeMaterial = new MeshBasicMaterial( {color: 0xffffff, opacity: 0.5, transparent: true} );\n        this.cube = new Mesh(cubeGeo, cubeMaterial);\n        this.cube.onClick = evt => this.onClick(evt);\n\n        this.add(this.elementObject);\n        this.add(this.cube);\n\n        this.animation = null;\n\n        this.events.addEventListener('bluemapMapInteraction', this.onMapInteraction);\n\n        window.addEventListener(\"mousedown\", this.removeHandler);\n        window.addEventListener(\"touchstart\", this.removeHandler);\n        window.addEventListener(\"keydown\", this.removeHandler);\n        window.addEventListener(\"mousewheel\", this.removeHandler);\n    }\n\n    onClick(event) {\n        return true;\n    }\n\n    onMapInteraction = evt => {\n        let isHires = true;\n        let int = evt.detail.hiresHit;\n\n        if (evt.detail.lowresHits) {\n            for (let i = 0; i < evt.detail.lowresHits.length; i++) {\n                if (!int) {\n                    isHires = false;\n                    int = evt.detail.lowresHits[i];\n                } else break;\n            }\n        }\n\n        if (!int) return;\n\n        this.position\n            .copy(int.pointOnLine || int.point)\n            .add(evt.detail.ray.direction.clone().multiplyScalar(0.05))\n            .floor();\n\n        //this.elementObject.position\n            //.copy(evt.detail.intersection.pointOnLine || evt.detail.intersection.point)\n            //.sub(this.position);\n\n        if (isHires) {\n            this.element.innerHTML = `\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.block\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${this.position.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">y: </span><span class=\"value\">${this.position.y}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${this.position.z}</span></div>\n                    </div>\n                </div>\n            `;\n        } else {\n            this.element.innerHTML = `\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.position\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${this.position.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${this.position.z}</span></div>\n                    </div>\n                </div>\n            `;\n        }\n\n        if (this.appState.debug) {\n            let chunkCoords = this.position.clone().divideScalar(16).floor();\n            let regionCoords = new Vector2(this.position.x, this.position.z).divideScalar(512).floor();\n            let regionFile = `r.${regionCoords.x}.${regionCoords.y}.mca`;\n\n            this.element.innerHTML += `\n                <hr>\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.chunk\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${chunkCoords.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">y: </span><span class=\"value\">${chunkCoords.y}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${chunkCoords.z}</span></div>\n                    </div>\n                </div>\n                <hr>\n                <div class=\"group\">\n                    <div class=\"label\">${i18n.t(\"blockTooltip.region.region\")}:</div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">x: </span><span class=\"value\">${regionCoords.x}</span></div>\n                        <div class=\"entry\"><span class=\"label\">z: </span><span class=\"value\">${regionCoords.y}</span></div>\n                    </div>\n                    <div class=\"content\">\n                        <div class=\"entry\"><span class=\"label\">${i18n.t(\"blockTooltip.region.file\")}: </span><span class=\"value\">${regionFile}</span></div>\n                    </div>\n                </div>\n            `;\n        }\n\n        if (this.appState.debug) {\n            let faceIndex = int.faceIndex;\n            let attributes = int.object.geometry.attributes;\n            if (attributes.sunlight && attributes.blocklight) {\n                let sunlight = attributes.sunlight.array[faceIndex * 3];\n                let blocklight = attributes.blocklight.array[faceIndex * 3];\n\n                this.element.innerHTML += `\n                    <hr>\n                    <div class=\"group\">\n                        <div class=\"label\">${i18n.t(\"blockTooltip.light.light\")}:</div>\n                        <div class=\"content\">\n                            <div class=\"entry\"><span class=\"label\">${i18n.t(\"blockTooltip.light.sun\")}: </span><span class=\"value\">${sunlight}</span></div>\n                            <div class=\"entry\"><span class=\"label\">${i18n.t(\"blockTooltip.light.block\")}: </span><span class=\"value\">${blocklight}</span></div>\n                        </div>\n                    </div>\n                `;\n            }\n        }\n\n        if (this.appState.debug) {\n            let info = \"\";\n\n            if (isHires) {\n                let hrPath = evt.detail.hiresHit?.object?.userData?.tileUrl;\n                info += `<div>${hrPath}</div>`;\n            }\n\n            if (evt.detail.lowresHits) {\n                for (let i = 0; i < evt.detail.lowresHits.length; i++) {\n                    let lrPath = evt.detail.lowresHits[i]?.object?.userData?.tileUrl;\n                    if (lrPath) info += `<div>${lrPath}</div>`;\n                }\n            }\n\n            this.element.innerHTML += `\n                <hr>\n                <div class=\"files\">\n                    ${info}\n                </div>\n            `;\n        }\n\n        if (this.appState.debug){\n            console.debug(\"Clicked Position Data:\", evt.detail);\n        }\n\n        this.open();\n    };\n\n    open() {\n        if (this.animation) this.animation.cancel();\n\n        this.visible = true;\n        this.cube.visible = true;\n\n        let targetOpacity = 1;\n\n        this.element.style.opacity = \"0\";\n        this.animation = animate(progress => {\n            this.element.style.opacity = (progress * targetOpacity).toString();\n        }, 300);\n    }\n\n    removeHandler = evt => {\n        if (evt.composedPath().includes(this.element)) return;\n        this.close();\n    }\n\n    close() {\n        if (this.animation) this.animation.cancel();\n\n        this.cube.visible = false;\n\n        let startOpacity = parseFloat(this.element.style.opacity);\n        this.animation = animate(progress => {\n            this.element.style.opacity = (startOpacity - progress * startOpacity).toString();\n        }, 300, finished => {\n            if (finished) this.visible = false;\n        });\n    }\n\n    /**\n     * @returns {Element}\n     */\n    get element() {\n        return this.elementObject.element.getElementsByTagName(\"div\")[0];\n    }\n\n    dispose() {\n        super.dispose();\n\n        if (this.element.parentNode) this.element.parentNode.removeChild(this.element);\n    }\n\n}","/**\n * Converts a given value to JSON and writes it to the given key in\n * localStorage.\n */\nexport const setLocalStorage = (key, value) => {\n    localStorage.setItem(key, JSON.stringify(value));\n};\n\n/**\n * Fetches the value from a given key from localStorage. If the stored value is\n * in JSON format, the parsed value will be returned.\n */\nexport const getLocalStorage = key => {\n    const value = localStorage.getItem(key);\n\n    // return undefined for not defined values\n    // because \"null\" might be ambiguous if there is actually \"null\" stored for that key\n    if (value == null) return undefined;\n\n    try {\n        return JSON.parse(value);\n    } catch(e) {\n        return value;\n    }\n};\n\nexport const round = (value, precision) => {\n    let f = Math.pow(10, precision);\n    return Math.round(value * f) / f;\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport \"bluemap/src/BlueMap\";\nimport {MapViewer} from \"bluemap/src/MapViewer\";\nimport {MapControls} from \"bluemap/src/controls/map/MapControls\";\nimport {FreeFlightControls} from \"bluemap/src/controls/freeflight/FreeFlightControls\";\nimport {FileLoader, MathUtils, Vector3} from \"three\";\nimport {Map as BlueMapMap} from \"bluemap/src/map/Map\";\nimport {alert, animate, EasingFunctions, generateCacheHash} from \"bluemap/src/util/Utils\";\nimport {MainMenu} from \"@/js/MainMenu\";\nimport {PopupMarker} from \"@/js/PopupMarker\";\nimport {MarkerSet} from \"bluemap/src/markers/MarkerSet\";\nimport {getLocalStorage, round, setLocalStorage} from \"@/js/Utils\";\nimport i18n from \"../i18n\";\nimport {MarkerManager, MarkerFileType} from \"bluemap/src/markers/MarkerManager\";\n\nexport class BlueMapApp {\n\n    /**\n     * @param rootElement {Element}\n     */\n    constructor(rootElement) {\n        this.events = rootElement;\n\n        this.mapViewer = new MapViewer(rootElement, this.events);\n\n        this.mapControls = new MapControls(this.mapViewer.renderer.domElement);\n        this.freeFlightControls = new FreeFlightControls(this.mapViewer.renderer.domElement);\n\n        /** @type {MarkerManager} */\n        this.playerMarkerManager = null;\n        /** @type {MarkerManager} */\n        this.markerFileManager = null;\n\n        /** @type {{\n         *      version: string,\n         *      useCookies: boolean,\n         *      enableFreeFlight: boolean,\n         *      resolutionDefault: number,\n         *      minZoomDistance: number,\n         *      maxZoomDistance: number,\n         *      hiresSliderMax: number,\n         *      hiresSliderDefault: number,\n         *      hiresSliderMin: number,\n         *      lowresSliderMax: number,\n         *      lowresSliderDefault: number,\n         *      lowresSliderMin: number,\n         *      startLocation: string,\n         *      maps: string[]\n         *  }}\n         **/\n        this.settings = null;\n        this.savedUserSettings = new Map();\n\n        /** @type BlueMapMap[] */\n        this.maps = [];\n        /** @type Map<BlueMapMap> */\n        this.mapsMap = new Map();\n\n        this.lastCameraMove = 0;\n\n        this.dataUrl = \"maps/\";\n\n        this.mainMenu = new MainMenu();\n\n        this.appState = {\n            controls: {\n                state: \"perspective\",\n                mouseSensitivity: 1,\n                invertMouse: false,\n                enableFreeFlight: false,\n                pauseTileLoading: false\n            },\n            menu: this.mainMenu,\n            maps: [],\n            theme: null,\n            screenshot: {\n                clipboard: true\n            },\n            debug: false\n        };\n\n        // init\n        this.updateControlsSettings();\n        this.initGeneralEvents();\n\n        // popup on click\n        this.popupMarkerSet = new MarkerSet(\"bm-popup-set\");\n        this.popupMarker = new PopupMarker(\"bm-popup\", this.appState, this.events);\n        this.popupMarkerSet.add(this.popupMarker);\n        this.mapViewer.markers.add(this.popupMarkerSet);\n\n        this.updateLoop = null;\n\n        this.hashUpdateTimeout = null;\n        this.viewAnimation = null;\n    }\n\n\n    /**\n     * @returns {Promise<void|never>}\n     */\n    async load() {\n        let oldMaps = this.maps;\n        this.maps = [];\n        this.appState.maps.splice(0, this.appState.maps.length);\n        this.mapsMap.clear();\n\n        // load settings\n        await this.getSettings();\n        this.mapControls.minDistance = this.settings.minZoomDistance;\n        this.mapControls.maxDistance = this.settings.maxZoomDistance;\n        this.appState.controls.enableFreeFlight = this.settings.enableFreeFlight;\n\n        // unload loaded maps\n        await this.mapViewer.switchMap(null);\n        oldMaps.forEach(map => map.dispose());\n\n        // load maps\n        this.maps = await this.loadMaps();\n        for (let map of this.maps) {\n            this.mapsMap.set(map.data.id, map);\n            this.appState.maps.push(map.data);\n        }\n\n        // switch to map\n        if (!await this.loadPageAddress()) {\n            if (this.maps.length > 0) await this.switchMap(this.maps[0].data.id);\n            this.resetCamera();\n        }\n\n        // map position address\n        window.addEventListener(\"hashchange\", this.loadPageAddress);\n        this.events.addEventListener(\"bluemapCameraMoved\", this.cameraMoved);\n        this.events.addEventListener(\"bluemapMapInteraction\", this.mapInteraction);\n\n        // start app update loop\n        if(this.updateLoop) clearTimeout(this.updateLoop);\n        this.updateLoop = setTimeout(this.update, 1000);\n\n        // load user settings\n        await this.loadUserSettings();\n\n        // save user settings\n        this.saveUserSettings();\n    }\n\n    update = async () => {\n        await this.followPlayerMarkerWorld();\n        this.updateLoop = setTimeout(this.update, 1000);\n    }\n\n    async followPlayerMarkerWorld() {\n        /** @type {PlayerLike} */\n        let player = this.mapViewer.controlsManager.controls?.data.followingPlayer;\n\n        if (this.mapViewer.map && player) {\n            if (player.foreign){\n\n                let matchingMap = await this.findPlayerMap(player.playerUuid)\n                if (matchingMap) {\n                    this.mainMenu.closeAll();\n                    await this.switchMap(matchingMap.data.id, false);\n                    let playerMarker = this.playerMarkerManager.getPlayerMarker(player.playerUuid);\n                    if (playerMarker && this.mapViewer.controlsManager.controls.followPlayerMarker)\n                        this.mapViewer.controlsManager.controls.followPlayerMarker(playerMarker);\n                } else {\n                    if (this.mapViewer.controlsManager.controls.stopFollowingPlayerMarker)\n                        this.mapViewer.controlsManager.controls.stopFollowingPlayerMarker();\n                }\n            }\n        }\n    }\n\n    async findPlayerMap(playerUuid) {\n        /** @type BlueMapMap */\n        let matchingMap = null;\n\n        // search for the map that contains the player\n        if (this.maps.length < 20) {\n            for (let map of this.maps) {\n                let playerData = await this.loadPlayerData(map);\n                if (!Array.isArray(playerData.players)) continue;\n                for (let p of playerData.players) {\n                    if (p.uuid === playerUuid && !p.foreign) {\n                        matchingMap = map;\n                        break;\n                    }\n                }\n\n                if (matchingMap) break;\n            }\n        }\n\n        return matchingMap;\n    }\n\n    /**\n     * @param mapId {String}\n     * @param resetCamera {boolean}\n     * @returns {Promise<void>}\n     */\n    async switchMap(mapId, resetCamera = true) {\n        let map = this.mapsMap.get(mapId);\n        if (!map) return Promise.reject(`There is no map with the id \"${mapId}\" loaded!`);\n\n        await this.mapViewer.switchMap(map)\n\n        if (resetCamera) this.resetCamera();\n        this.updatePageAddress();\n\n        await Promise.all([\n            this.initPlayerMarkerManager(),\n            this.initMarkerFileManager()\n        ]);\n    }\n\n    resetCamera() {\n        let map = this.mapViewer.map;\n        let controls = this.mapViewer.controlsManager;\n\n        if (map) {\n            controls.position.set(map.data.startPos.x, 0, map.data.startPos.z);\n            controls.distance = 1500;\n            controls.angle = 0;\n            controls.rotation = 0;\n            controls.tilt = 0;\n            controls.ortho = 0;\n        }\n\n        controls.controls = this.mapControls;\n        this.appState.controls.state = \"perspective\";\n        this.updatePageAddress();\n    }\n\n    /**\n     * @returns Promise<BlueMapMap[]>\n     */\n    async loadMaps() {\n        let settings = this.settings;\n        let maps = [];\n\n        // create maps\n        if (settings.maps !== undefined){\n            for (let mapId of settings.maps) {\n                let map = new BlueMapMap(mapId, this.dataUrl + mapId + \"/\", this.loadBlocker, this.mapViewer.events);\n                maps.push(map);\n\n                await map.loadSettings()\n                    .catch(error => {\n                        alert(this.events, `Failed to load settings for map '${map.data.id}':` + error, \"warning\");\n                    });\n            }\n        }\n\n        // sort maps\n        maps.sort((map1, map2) => {\n            let sort = map1.data.sorting - map2.data.sorting;\n            if (isNaN(sort)) return 0;\n            return sort;\n        });\n\n        return maps;\n    }\n\n    async getSettings() {\n        if (!this.settings){\n            this.settings = await this.loadSettings();\n        }\n\n        return this.settings;\n    }\n\n    /**\n     * @returns {Promise<Object>}\n     */\n    loadSettings() {\n        return new Promise((resolve, reject) => {\n            let loader = new FileLoader();\n            loader.setResponseType(\"json\");\n            loader.load(\"settings.json?\" + generateCacheHash(),\n                resolve,\n                () => {},\n                () => reject(\"Failed to load the settings.json!\")\n            );\n        });\n    }\n\n    /**\n     * @param map {BlueMapMap}\n     * @returns {Promise<Object>}\n     */\n    loadPlayerData(map) {\n        return new Promise((resolve, reject) => {\n            let loader = new FileLoader();\n            loader.setResponseType(\"json\");\n            loader.load(map.data.dataUrl + \"live/players?\" + generateCacheHash(),\n                fileData => {\n                    if (!fileData) reject(`Failed to parse '${this.fileUrl}'!`);\n                    else resolve(fileData);\n                },\n                () => {},\n                () => reject(`Failed to load '${this.fileUrl}'!`)\n            )\n        });\n    }\n\n    initPlayerMarkerManager() {\n        if (this.playerMarkerManager){\n            this.playerMarkerManager.clear();\n            this.playerMarkerManager.dispose()\n        }\n\n        const map = this.mapViewer.map;\n        if (!map) return;\n\n        this.playerMarkerManager = new MarkerManager(this.mapViewer.markers, map.data.dataUrl + \"live/players\", MarkerFileType.PLAYER, this.events);\n        this.playerMarkerManager.setAutoUpdateInterval(0);\n        return this.playerMarkerManager.update()\n            .then(() => {\n                this.playerMarkerManager.setAutoUpdateInterval(1000);\n            })\n            .catch(e => {\n                alert(this.events, e, \"warning\");\n                this.playerMarkerManager.clear();\n                this.playerMarkerManager.dispose();\n            });\n    }\n\n    initMarkerFileManager() {\n        if (this.markerFileManager) {\n            this.markerFileManager.clear();\n            this.markerFileManager.dispose();\n        }\n\n        const map = this.mapViewer.map;\n        if (!map) return;\n\n        this.markerFileManager = new MarkerManager(this.mapViewer.markers, map.data.dataUrl + \"live/markers\", MarkerFileType.NORMAL, this.events);\n        return this.markerFileManager.update()\n            .then(() => {\n                this.markerFileManager.setAutoUpdateInterval(1000 * 10);\n            })\n            .catch(e => {\n                alert(this.events, e, \"warning\");\n                this.markerFileManager.clear();\n                this.markerFileManager.dispose();\n            });\n    }\n\n    updateControlsSettings() {\n        let mouseInvert = this.appState.controls.invertMouse ? -1 : 1;\n\n        this.freeFlightControls.mouseRotate.speedCapture = -1.5 * this.appState.controls.mouseSensitivity;\n        this.freeFlightControls.mouseAngle.speedCapture = -1.5 * this.appState.controls.mouseSensitivity * mouseInvert;\n        this.freeFlightControls.mouseRotate.speedRight = -2 * this.appState.controls.mouseSensitivity;\n        this.freeFlightControls.mouseAngle.speedRight = -2 * this.appState.controls.mouseSensitivity * mouseInvert;\n    }\n\n    initGeneralEvents() {\n        //close menu on fullscreen\n        document.addEventListener(\"fullscreenchange\", evt => {\n            if (document.fullscreen) {\n                this.mainMenu.closeAll();\n            }\n        });\n    }\n\n    setPerspectiveView(transition = 0, minDistance = 5) {\n        if (!this.mapViewer.map) return;\n        if (this.viewAnimation) this.viewAnimation.cancel();\n\n        let cm = this.mapViewer.controlsManager;\n        cm.controls = null;\n\n        let startDistance = cm.distance;\n        let targetDistance = Math.max(5, minDistance, startDistance);\n\n        let startY = cm.position.y;\n        let targetY = MathUtils.lerp(this.mapViewer.map.terrainHeightAt(cm.position.x, cm.position.z) + 3, 0, targetDistance / 500);\n\n        let startAngle = cm.angle;\n        let targetAngle = Math.min(Math.PI / 2, startAngle, this.mapControls.getMaxPerspectiveAngleForDistance(targetDistance));\n\n        let startOrtho = cm.ortho;\n        let startTilt = cm.tilt;\n\n        this.viewAnimation = animate(p => {\n            let ep = EasingFunctions.easeInOutQuad(p);\n            cm.position.y = MathUtils.lerp(startY, targetY, ep);\n            cm.distance = MathUtils.lerp(startDistance, targetDistance, ep);\n            cm.angle = MathUtils.lerp(startAngle, targetAngle, ep);\n            cm.ortho = MathUtils.lerp(startOrtho, 0, p);\n            cm.tilt = MathUtils.lerp(startTilt, 0, ep);\n        }, transition, finished => {\n            this.mapControls.reset();\n            if (finished){\n                cm.controls = this.mapControls;\n                this.updatePageAddress();\n            }\n        });\n\n        this.appState.controls.state = \"perspective\";\n    }\n\n    setFlatView(transition = 0, minDistance = 5) {\n        if (!this.mapViewer.map) return;\n        if (this.viewAnimation) this.viewAnimation.cancel();\n\n        let cm = this.mapViewer.controlsManager;\n        cm.controls = null;\n\n        let startDistance = cm.distance;\n        let targetDistance = Math.max(5, minDistance, startDistance);\n\n        let startRotation = cm.rotation;\n        let startAngle = cm.angle;\n        let startOrtho = cm.ortho;\n        let startTilt = cm.tilt;\n\n        this.viewAnimation = animate(p => {\n            let ep = EasingFunctions.easeInOutQuad(p);\n            cm.distance = MathUtils.lerp(startDistance, targetDistance, ep);\n            cm.rotation = MathUtils.lerp(startRotation, 0, ep);\n            cm.angle = MathUtils.lerp(startAngle, 0, ep);\n            cm.ortho = MathUtils.lerp(startOrtho, 1, p);\n            cm.tilt = MathUtils.lerp(startTilt, 0, ep);\n        }, transition, finished => {\n            this.mapControls.reset();\n            if (finished){\n                cm.controls = this.mapControls;\n                this.updatePageAddress();\n            }\n        });\n\n        this.appState.controls.state = \"flat\";\n    }\n\n    setFreeFlight(transition = 0, targetY = undefined) {\n        if (!this.mapViewer.map) return;\n        if (!this.settings.enableFreeFlight) return this.setPerspectiveView(transition);\n        if (this.viewAnimation) this.viewAnimation.cancel();\n\n        let cm = this.mapViewer.controlsManager;\n        cm.controls = null;\n\n        let startDistance = cm.distance;\n\n        let startY = cm.position.y;\n        if (!targetY) targetY = this.mapViewer.map.terrainHeightAt(cm.position.x, cm.position.z) + 3 || startY;\n\n        let startAngle = cm.angle;\n        let targetAngle = Math.PI / 2;\n\n        let startOrtho = cm.ortho;\n        let startTilt = cm.tilt;\n\n        this.viewAnimation = animate(p => {\n            let ep = EasingFunctions.easeInOutQuad(p);\n            cm.position.y = MathUtils.lerp(startY, targetY, ep);\n            cm.distance = MathUtils.lerp(startDistance, 0, ep);\n            cm.angle = MathUtils.lerp(startAngle, targetAngle, ep);\n            cm.ortho = MathUtils.lerp(startOrtho, 0, Math.min(p * 2, 1));\n            cm.tilt = MathUtils.lerp(startTilt, 0, ep);\n        }, transition, finished => {\n            if (finished){\n                cm.controls = this.freeFlightControls;\n                this.updatePageAddress();\n            }\n        });\n\n        this.appState.controls.state = \"free\";\n    }\n\n    setDebug(debug) {\n        this.appState.debug = debug;\n\n        if (debug){\n            this.mapViewer.stats.showPanel(0);\n        } else {\n            this.mapViewer.stats.showPanel(-1);\n        }\n    }\n\n    setTheme(theme) {\n        this.appState.theme = theme;\n\n        if (theme === \"light\") {\n            this.mapViewer.rootElement.classList.remove(\"theme-dark\");\n            this.mapViewer.rootElement.classList.remove(\"theme-contrast\");\n            this.mapViewer.rootElement.classList.add(\"theme-light\");\n        }\n        else if (theme === \"dark\") {\n            this.mapViewer.rootElement.classList.remove(\"theme-light\");\n            this.mapViewer.rootElement.classList.remove(\"theme-contrast\");\n            this.mapViewer.rootElement.classList.add(\"theme-dark\");\n        }\n        else if (theme === \"contrast\") {\n            this.mapViewer.rootElement.classList.remove(\"theme-light\");\n            this.mapViewer.rootElement.classList.remove(\"theme-dark\");\n            this.mapViewer.rootElement.classList.add(\"theme-contrast\");\n        }\n        else {\n            this.mapViewer.rootElement.classList.remove(\"theme-light\");\n            this.mapViewer.rootElement.classList.remove(\"theme-dark\");\n            this.mapViewer.rootElement.classList.remove(\"theme-contrast\");\n        }\n    }\n\n    setScreenshotClipboard(clipboard) {\n        this.appState.screenshot.clipboard = clipboard;\n    }\n\n    async updateMap() {\n        try {\n            this.mapViewer.clearTileCache();\n            if (this.mapViewer.map) {\n                await this.switchMap(this.mapViewer.map.data.id);\n            }\n            this.saveUserSettings();\n        } catch (e) {\n            alert(this.events, e, \"error\");\n        }\n    }\n\n    resetSettings() {\n        this.saveUserSetting(\"resetSettings\", true);\n        location.reload();\n    }\n\n    async loadUserSettings(){\n        if (!isNaN(this.settings.resolutionDefault)) this.mapViewer.data.superSampling = this.settings.resolutionDefault;\n        if (!isNaN(this.settings.hiresSliderDefault)) this.mapViewer.data.loadedHiresViewDistance = this.settings.hiresSliderDefault;\n        if (!isNaN(this.settings.lowresSliderDefault)) this.mapViewer.data.loadedLowresViewDistance = this.settings.lowresSliderDefault;\n\n        if (!this.settings.useCookies) return;\n\n        if (this.loadUserSetting(\"resetSettings\", false)) {\n            alert(this.events, \"Settings reset!\", \"info\");\n            this.saveUserSettings();\n            return;\n        }\n\n        this.mapViewer.clearTileCache(this.loadUserSetting(\"tileCacheHash\", this.mapViewer.tileCacheHash));\n\n        this.mapViewer.superSampling = this.loadUserSetting(\"superSampling\", this.mapViewer.data.superSampling);\n        this.mapViewer.data.loadedHiresViewDistance = this.loadUserSetting(\"hiresViewDistance\", this.mapViewer.data.loadedHiresViewDistance);\n        this.mapViewer.data.loadedLowresViewDistance = this.loadUserSetting(\"lowresViewDistance\", this.mapViewer.data.loadedLowresViewDistance);\n        this.mapViewer.updateLoadedMapArea();\n        this.appState.controls.mouseSensitivity = this.loadUserSetting(\"mouseSensitivity\", this.appState.controls.mouseSensitivity);\n        this.appState.controls.invertMouse = this.loadUserSetting(\"invertMouse\", this.appState.controls.invertMouse);\n        this.appState.controls.pauseTileLoading = this.loadUserSetting(\"pauseTileLoading\", this.appState.controls.pauseTileLoading);\n        this.updateControlsSettings();\n        this.setTheme(this.loadUserSetting(\"theme\", this.appState.theme));\n        this.setScreenshotClipboard(this.loadUserSetting(\"screenshotClipboard\", this.appState.screenshot.clipboard));\n        await i18n.setLanguage(this.loadUserSetting(\"lang\", i18n.locale));\n        this.setDebug(this.loadUserSetting(\"debug\", this.appState.debug));\n\n        alert(this.events, \"Settings loaded!\", \"info\");\n    }\n\n    saveUserSettings() {\n        if (!this.settings.useCookies) return;\n\n        this.saveUserSetting(\"resetSettings\", false);\n        this.saveUserSetting(\"tileCacheHash\", this.mapViewer.tileCacheHash);\n\n        this.saveUserSetting(\"superSampling\", this.mapViewer.data.superSampling);\n        this.saveUserSetting(\"hiresViewDistance\", this.mapViewer.data.loadedHiresViewDistance);\n        this.saveUserSetting(\"lowresViewDistance\", this.mapViewer.data.loadedLowresViewDistance);\n        this.saveUserSetting(\"mouseSensitivity\", this.appState.controls.mouseSensitivity);\n        this.saveUserSetting(\"invertMouse\", this.appState.controls.invertMouse);\n        this.saveUserSetting(\"pauseTileLoading\", this.appState.controls.pauseTileLoading);\n        this.saveUserSetting(\"theme\", this.appState.theme);\n        this.saveUserSetting(\"screenshotClipboard\", this.appState.screenshot.clipboard);\n        this.saveUserSetting(\"lang\", i18n.locale);\n        this.saveUserSetting(\"debug\", this.appState.debug);\n\n        alert(this.events, \"Settings saved!\", \"info\");\n    }\n\n    loadUserSetting(key, defaultValue){\n        let value = getLocalStorage(\"bluemap-\" + key);\n\n        if (value === undefined) return defaultValue;\n        return value;\n    }\n\n    saveUserSetting(key, value){\n        if (this.savedUserSettings.get(key) !== value){\n            this.savedUserSettings.set(key, value);\n            setLocalStorage(\"bluemap-\" + key, value);\n        }\n    }\n\n    cameraMoved = () => {\n        if (this.hashUpdateTimeout) clearTimeout(this.hashUpdateTimeout);\n        this.hashUpdateTimeout = setTimeout(this.updatePageAddress, 1500);\n        this.lastCameraMove = Date.now();\n    }\n\n    loadBlocker = async () => {\n        if (!this.appState.controls.pauseTileLoading) return;\n\n        let timeToWait;\n        do {\n            let timeSinceLastMove = Date.now() - this.lastCameraMove;\n            timeToWait = 250 - timeSinceLastMove;\n            if (timeToWait > 0) await this.sleep(timeToWait);\n        } while (timeToWait > 0);\n    }\n\n    sleep(ms) {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    updatePageAddress = () => {\n        let hash = \"#\";\n\n        if (this.mapViewer.map) {\n            hash += this.mapViewer.map.data.id;\n\n            let controls = this.mapViewer.controlsManager;\n            hash += \":\" + round(controls.position.x, 0);\n            hash += \":\" + round(controls.position.y, 0);\n            hash += \":\" + round(controls.position.z, 0);\n            hash += \":\" + round(controls.distance, 0);\n            hash += \":\" + round(controls.rotation, 2);\n            hash += \":\" + round(controls.angle, 2);\n            hash += \":\" + round(controls.tilt, 2);\n            hash += \":\" + round(controls.ortho, 0);\n            hash += \":\" + this.appState.controls.state;\n        }\n\n        history.replaceState(undefined, undefined, hash);\n\n        document.title = i18n.t(\"pageTitle\", {\n            map: this.mapViewer.map ? this.mapViewer.map.data.name : \"?\",\n            version: this.settings.version\n        });\n    }\n\n    loadPageAddress = async () => {\n        let hash = window.location.hash?.substring(1) || this.settings.startLocation || \"\";\n        let values = hash.split(\":\");\n\n        if (values.length !== 10) return false;\n\n        let controls = this.mapViewer.controlsManager;\n        controls.controls = null;\n\n        if (!this.mapViewer.map || this.mapViewer.map.data.id !== values[0]) {\n            try {\n                await this.switchMap(values[0]);\n            } catch (e) {\n                return false;\n            }\n        }\n\n        controls.position.x = parseFloat(values[1]);\n        controls.position.y = parseFloat(values[2]);\n        controls.position.z = parseFloat(values[3]);\n        controls.distance = parseFloat(values[4]);\n        controls.rotation = parseFloat(values[5]);\n        controls.angle = parseFloat(values[6]);\n        controls.tilt = parseFloat(values[7]);\n        controls.ortho = parseFloat(values[8]);\n\n        switch (values[9]) {\n            case \"flat\" : this.setFlatView(0); break;\n            case \"free\" : this.setFreeFlight(0, controls.position.y); break;\n            default : this.setPerspectiveView(0); break;\n        }\n\n        return true;\n    }\n\n    mapInteraction = event => {\n        if (event.detail.data.doubleTap) {\n            let cm = this.mapViewer.controlsManager;\n            let pos = event.detail.hit?.point || event.detail.object?.getWorldPosition(new Vector3());\n            if (!pos) return;\n\n            let startDistance = cm.distance;\n            let targetDistance = Math.max(startDistance * 0.25, 5);\n\n            let startX = cm.position.x;\n            let targetX = pos.x;\n\n            let startZ = cm.position.z;\n            let targetZ = pos.z;\n\n            this.viewAnimation = animate(p => {\n                let ep = EasingFunctions.easeInOutQuad(p);\n                cm.distance = MathUtils.lerp(startDistance, targetDistance, ep);\n                cm.position.x = MathUtils.lerp(startX, targetX, ep);\n                cm.position.z = MathUtils.lerp(startZ, targetZ, ep);\n            }, 500);\n        }\n    }\n\n    takeScreenshot = () => {\n        let link = document.createElement(\"a\");\n        link.download = \"bluemap-screenshot.png\";\n        link.href = this.mapViewer.renderer.domElement.toDataURL('image/png');\n        link.click();\n\n        if (this.appState.screenshot.clipboard) {\n            this.mapViewer.renderer.domElement.toBlob(blob => {\n                // eslint-disable-next-line no-undef\n                navigator.clipboard.write([new ClipboardItem({ ['image/png']: blob })]).catch(e => {\n                    alert(this.events, \"Failed to copy screenshot to clipboard: \" + e, \"error\");\n                });\n            });\n        }\n    }\n\n}\n","/*\n * This file is part of BlueMap, licensed under the MIT License (MIT).\n *\n * Copyright (c) Blue (Lukas Rieger) <https://bluecolored.de>\n * Copyright (c) contributors\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport Vue from 'vue'\nimport App from './App.vue'\nimport {BlueMapApp} from \"@/js/BlueMapApp\";\nimport i18n from './i18n';\n\n// utils\nString.prototype.includesCI = function (val) {\n  return this.toLowerCase().includes(val.toLowerCase());\n}\n\n// bluemap app\ntry {\n  const bluemap = new BlueMapApp(document.getElementById(\"map-container\"));\n  window.bluemap = bluemap;\n\n// init vue\n  Vue.config.productionTip = false;\n  Object.defineProperty(Vue.prototype, '$bluemap', {\n    get() {\n      return bluemap;\n    }\n  });\n\n  const vue = new Vue({\n    i18n,\n    render: h => h(App)\n  }).$mount('#app');\n\n// load languages\n  i18n.loadLanguageSettings().catch(error => console.error(error));\n\n// load bluemap next tick (to let the assets load first)\n  vue.$nextTick(() => {\n    bluemap.load().catch(error => console.error(error));\n  });\n} catch (e) {\n  console.error(\"Failed to load BlueMap webapp!\", e);\n  document.body.innerHTML = `\n    <div id=\"bm-app-err\">\n      <div>\n        <img src=\"assets/logo.png\" alt=\"bluemap logo\">\n        <div class=\"bm-app-err-main\">Failed to load BlueMap webapp!</div>\n        <div class=\"bm-app-err-hint\">Make sure you have <a href=\"https://get.webgl.org/\">WebGL</a> enabled on your browser.</div>\n      </div>\n    </div>\n  `;\n}\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ControlBar.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PositionInput.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SimpleButton.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MarkerSet.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Slider.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainMenu.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SwitchHandle.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Group.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}